%% ==============================================================================
%% ==============================================================================
%% ==============================================================================
%%
\part{Numerical relativity simulations of neutron star mergers}
%% \label{sec:part1}
%%
%% ==============================================================================
%% ==============================================================================
%% ==============================================================================

%% In this part to discuss
%% GR Hydro 
%% Numerical methods for GR Hydro
%% Radiation
%% M0 scheme for neutrinos
%% WhiskyTHC & Lorene
%% GW1708017 targeted models
%% Remannt/Disk dynamics of model 


%% ===========================================================================
%%
%% Intorduction
%%
%% ===========================================================================

\chapter{Introduction}

\todo{Write me}

%% ===========================================================================
%%
%% Theoretical Background
%%
%% ===========================================================================

\chapter{Theoretical Background} %% [ Based on the thesis of David Radice ]

%%

\section{Basic Notations and definitions}

%% ================= | Diff.forms, external prodcuts; Hoge star | ==============
\iftoggle{Full}{
    
    \subsection{More on the tangent and cotangent spaces}
    Tangent space to $\mathcal{M}$ is denoted with $T_p(\mathcal{M})$.
    The cotangent space $T_p ^* \mathcal{M}$
    
    %% ---------------------------
    
    \subsection{Differential forms}
    \gray{copied}
    
    They are usefull for multivariable calculus independent of coordinates. Used for integrands over curves, manifolds. For example, differential form can be used to define a volume element as $f(x,y,z)dx \wedge dy \wedge dz$, where $\wedge$ is the \textit{wedge product} defined below.
    
    Albegra of differential forms is organized to reflect the orientation of the domain of integration. For instance: the \textit{exterior product} (see below) $d$ that converts $k$-from into $k+1$-form. 
    This operation is similar to the divergence and the curl of a vector field.
    
    Differential $1$-forms are naturally dual to \textit{vector fields} on a manifold. Pairing is done via \textit{inner product}.
    
    If there are two \textit{manifolds}, then the albegra of diff.forms and their exterior derivatives is preserved by the \textbf{pullblack} under the smooth function. 
    This allows geometrically invariant information to be moved from one space to another via the pullback.
    
    Let $\mathcal{M}$ be an orientated $m$-dimentional manifold and $\mathcal{M}'$ is the same manifold with the opposite orientation and $\omega$ is an $m$-form, then 
    
    \begin{equation}
        \int_{\mathcal{M}}\omega = -\int_{\mathcal{M}'}\omega.
    \end{equation}
    
    The \textit{exterior algebra} is used to make the notion of an oriented density precise.
    
    The basic $1$-forms are \textbf{differentials} of the coordiantes $dx^1,...,dx^n$. 
    Each of them is a \textbf{covector} that measures a small displacement in the corresponding coordinate direction. A general $1$-form thus is the combination of these differentials 
    \begin{equation}
        f_1dx^1\cdot\cdot\cdot f_ndx^n
    \end{equation}
    where $f_k=f_k(x^1,...,x^n)$ are functions of all the coordiantes. 
    
    \textit{Wedge product} is similar to \textit{cross product}, and is used to build higher differential forms out of lower ones, as the cross product in vector calculus.
    
    The \textit{Exterior derivative}, operator $d$ is a generalization of a differential of a function. 
    Let $\omega=fdx^I$ be a simple $k$-form. Then its exterior derivative $d\omega$ is a $(k+1)$-form set by taking differential of the coefficient functions
    \begin{equation}
        d\omega = \sum_{i=1}^n \frac{\partial f}{\partial x^i}dx^i \wedge dx^I
    \end{equation}
    Thus a \textit{deferential form}, lets say, differential $2$-form is called an exterior derivative $da$ of $a=\sum_{j=1}^{n}f_j dx^j$. 
    It is given by
    \begin{equation}
        da = \sum_{j=1}^n df_j \wedge dx^j = \sum_{i,j=1}^n \frac{\partial f_j}{\partial x^i}dx^i\wedge dx^j.
    \end{equation}
    Overall, the $da=0$ is required for a function $f$ such that $a=df$.
    
    On as smooth manifold $\mathcal{M}$ the differential from of degree $k$ is a \textit{smooth section} of the $k$th \textit{exterior power} of the \textit{cotangent bundle} of $\mathcal{M}$. 
    Then, the set of all the $k-$forms on $\mathcal{M}$ is a \textit{vector space} $\Omega^k(\mathcal{M})$. 
    The formal definition then stands. At any point $p\in \mathcal{M}$ a $k-$form $\beta$ defines an element 
    \begin{equation}
        \beta_p\in\Lambda^kT^* _p \mathcal{M}
    \end{equation}
    where $T_p\mathcal{M}$is the \textit{tangent space} tp $\mathcal{M}$ at $p$. The $T^* _p \mathcal{M}$ is its \textit{dual space} (cotangent space). Thus, $\beta$ is also a linear functional such that $\beta_p:\Lambda^k T_p \mathcal{M}\rightarrow I\!R$
    
    %% -----------------------------------------------------
    
    \subsection{More on the algebra of differential forms}
    
    If $\phi$ and $\psi$ are the 2-forms given for example as 
    \begin{equation}
    \phi = x dx - y dy \hspace{5mm} \text{and} \hspace{5mm}\psi = z dx + x dz
    \end{equation}
    Then the \textbf{exterior product} is given by 
    \begin{align}
    \phi\wedge\psi &= (x dx - y dy)\wedge(zdx + xdz) = \\
    &=xzdxdx+x^2dxdz-yzdydx-yxdydz= \\
    &=yzdxdy + x^2 dx dz - xydydz
    \end{align}
    as $dxdx=0$ and $dydx=-dxdy$. 
    The product of two $1$-forms is a $2$-form.
    In general, the \textbf{wedge product} of a $p$-form and $q$-form is a $(p+q)$-form.
    
    In other words, consider a surface $\mathcal{M}$ and two $1$-forms on it $\phi$ and $\psi$ Then the \textbf{wedge product} is 
    \begin{equation}
    (\phi\wedge\psi)(v,w)=\phi(v)\psi(w) - \phi(w)\psi(v)
    \end{equation}
    for any $v$ and $w$ tangent vectors to $\mathcal{M}$.
    
    \paragraph{Properties of the wedge product.} The exterior algebra main idea is that the operations are designed to create \textbf{the permutational antisymmetry}. 
    Let the $dx_i$ be the basis $1$-from and $\omega_j$ are the orbitrary $p$-form (of order $p_j$), and $a$, $b$ be arbitrary scalars. 
    Then the \textit{wedge product} is defined to have properties:
    \begin{align}
        (a\omega_1+b\omega_2)\wedge\omega_3 &= a\omega_1\wedge\omega_3+b\omega_2\wedge\omega_3 \hspace{5mm} (p_1 = p_2), \\
        (\omega_1\wedge\omega_2)\wedge\omega_3 &= \omega_1\wedge(\omega_2\wedge\omega_3), \hspace{5mm} a(\omega_1\wedge\omega_2) =  (a\omega_1)\wedge\omega_2\\
        dx_i\wedge dx_j &= -dx_j\wedge dx_i
    \end{align}
    Thus, any arbitrary differential form can be reduced to \textbf{a} coefficient multiplying $dx_i$ or a wedge product of the generic form 
    \begin{equation}
        dx_i\wedge dx_j \wedge...\wedge dx_p
    \end{equation}
    with the properties allowing to put all coefficients together as 
    \begin{equation}
        a dx_1 \wedge b dx_2 = - a(b dx_2 \wedge dx_1) = -ab(dx_2 \wedge dx_1) = ab(dx_1 \wedge dx_2)
    \end{equation}
    
    \paragraph{Wedge product acting on tangent vectors}.
    The $\wedge$ of two tangent vectors $\boldsymbol{u}\wedge\boldsymbol{v}$, where ($\boldsymbol{u}, \boldsymbol{v}\in T_p(\mathcal{M})$) is an antisymmetric tensor product that in addition to bilinearity requires antisymmetry. 
    \begin{align}
        \boldsymbol{v} =& v^1e_1 + v^2 e_2 + v^3 e_3 \\
        \boldsymbol{u} =& u^1e_1 + u^2 e_2 + u^3 e_3 \\
        \boldsymbol{v}\wedge\boldsymbol{u} =& (v^1u^1 - v^2u^1)(e_1\wedge e_2) + \\
        & + (v^1u^3 - v^3u^1)(e_1\wedge e_1) + \\
        & + (v^2u^3 - v^3u^2)(e_2\wedge e_1)
    \end{align}
    mimicking the behavior of the cross product. 
    However, this can easly be extended to higher dimensions. 
    
    Important, that the resulting object of $\boldsymbol{v}\wedge\boldsymbol{u}$ does not belong to $T_p M$. It is called an \textbf{alternating bivector} and is an element of the vector space $\Lambda^2 T_p (\mathcal{M})$ ,that is called -- \textbf{second exterior power} of $T_p \mathcal{M}$.
    
    Generally one obtains $\Lambda^k T_p (\mathcal{M})$ that is a linear subspace of $T_p ^k (\mathcal{M})$.
    
    Note that the exterior product on the \textit{cotangent spaces}, $T_p ^* \mathcal{M}$ is compatible with \textit{wedge product} on $T_p\mathcal{M}$ and is usually denoted with the same symbol and yields
    $(\boldsymbol{\alpha}\wedge\boldsymbol{\beta})\in\Lambda^2 T_p ^* \mathcal{M}$.
    
    %% ------------------------------------------------------
    
    \subsection{Differential forms on a Reimannian maniforld}
    
    There metric defines a fiber-wise isomorphism of the tangent and cotangent spaces. This allows to convert vector fields to covector field and vice versa. It also allows the definition of the \textit{Hodge star operator}.
    
    Hodge star operator $\star$ is a linear map, defined on the exterior algebra of a finite-dimensional oriented vector space endowed with a non-degenerate symmetric bilinear form. Applying the operator to the element of the algebra produces the \textit{Hodge dual} of the element.
    
    Example. Consider a $3D$ Euclidean space. Let there be an orientated plane, that is presented by the exterior product $\wedge$ of two basis vectors. Then its \textit{Hodge dual} is the normal vector given by the cross product. 
    
    The \textit{Hodge operator} $\star$ is a one-to-one mapping of $k-$ to $(n-k)$-vectors.
    
    The $\star$ can be applied to the \textit{cotangent bundle} of a pseudo-reimanian manifold -- to all differential $k$-forms. This allows the definition of a differential as a \textit{Hodge adjoint} of the exteior derivative. 
    
    \paragraph{Formal definition}. Let $V$ be a $n$-dimensional vector-space with non-degenerate symmetric bilinear form $\langle\cdot,\cdot\rangle$ -- the \textit{inner product}. 
    This induces an inner product on $k-$vectors $\alpha,\beta\in\Lambda^k V$ for $0\leq k \leq n$ by defining it on decomposable $k$-vectors $\alpha = \alpha_1\wedge\cdots\wedge\alpha_k$ and $\beta=\beta_1\wedge\cdots\wedge\beta_k$.
    
    The \textit{Hodge star} operator is a linear operator on the exterior algebra of $V$, mapping $k$-vectors to $(n-k)$-vectors for $0\leq k \leq n$. It has following property that defines it completely
    \begin{equation}
        \alpha\wedge(\star\beta) = \langle\alpha,\beta\rangle\omega 
    \end{equation}
    for every pair of $k-$vectors $\alpha\beta\in\Lambda^kV$.
    Here the $\omega\in\Lambda^nV$ is the unit $n-$vector defined in terms of an oriented orthonormal basis $\{e_1,...,e_n\}$ of $V$ as
    \begin{equation}
        \omega := e_1 \wedge \cdots \wedge e_n.
    \end{equation}
    
    Dually, in the space $\Lambda^n V^*$ of $n-forms$, the dual $\omega$ is the column form $\textbf{det}$, the function whose value on $v_1\wedge\cdots\wedge v_n$ is the determinant of the $n\times n$ matrix assembled from the column vectors of $v_i$ in $e_i$ coordinates. Thus the dual definition is 
    \begin{equation}
        \text{det}(\alpha\wedge\star\beta) = \langle\alpha,\beta\rangle.
    \end{equation}
    or equivalently 
    \begin{align}
        \alpha =& \alpha_1\wedge\cdots\wedge\alpha_k \\
        \beta =& \beta_1\wedge\cdots\wedge\beta_k \\
        \star\beta =& \beta_1 ^{\star} \wedge\cdots\wedge \beta_{n-k} ^ {\star} \\
        \text{det}(\alpha_1\wedge\cdots\wedge\alpha_k\wedge\beta_1 ^{\star}\wedge\cdots\wedge\beta_{n-k}^{\star}) =& \text{det}(\langle\alpha_i,\beta_j\rangle)
    \end{align}
    
    \paragraph{Examples}.
    Consider 2D space with normalized Euclidian metric and orientation given by ordering $(x,y)$. The \textit{Hodge star} on $k-$forms is given by 
    
    \begin{align}
        \star 1 &= dx \wedge dy \\
        \star dx &= dy \\
        \star dy &= -dx \\
        \star(dx \wedge dy) &= 1.
    \end{align}
    
    Consider a more complex example. A plane that can be regarded as a vector space with a standard sesquilinear form as the metric. 
    There the \textit{Hodge operator} has a property that it is invariant under the holomorphic changes of coordinates. 
    Consider $z = x + iy$ holomorphic function of $w=u + iv$. Then in the new coordinates 
    
    \begin{align}
        \alpha &= pdx +qdy \\
        \star \alpha &= -q dx + p dy
    \end{align}
    
    Next, consider a 3D space. 
    Here the $\star$ can be regarded as a correspondence between vectors and bivectors. 
    Thus in Eucledian $\boldsymbol{R}^3$ space with basis $dx,dy,dz$, of one-forms, one finds
    \begin{align}
        \star dx =& dy\wedge dz \\
        \star dy =& dz\wedge dx \\
        \star dz =& dx \wedge dy \\
    \end{align}
    The relations to the exterior and cross product are:
    \begin{equation}
        \star(\boldsymbol{u}\wedge\boldsymbol{v})=\boldsymbol{u}\times\boldsymbol{v}, \hspace{5mm}\star(\boldsymbol{u}\times\boldsymbol{v}) = \boldsymbol{u}\wedge\boldsymbol{v}
    \end{equation}
    
    Thus in 3D the $\star$ provides and isomorphism between vectors and bivectors, so each axial vector $\boldsymbol{a}$ is associated with the bivector $\boldsymbol{A}$ as $\boldsymbol{A} = \star\boldsymbol{a}$ and $\boldsymbol{a} = \star\boldsymbol{A}$. It can also mean a correspondence between the axis and infinitesimal rotation around the axis with the speed equal to the length of the axis vector.
    
    Consider a tensor $dx \otimes dy$ that corresponds to the matrix with one $dx$ row and $dy$ column. The wedge $dx\wedge dy = dx\otimes dy - dy\otimes dx$ is a 3 by 3 \textit{skew-symmetric matrix} with all $0$ exept $(0,1)$ and $(1,0)$ components that are $1$. 
    So the $\wedge$ operator turns $\boldsymbol{v} = adx + bdy + cdz$ into $\star\boldsymbol{v}\approx$ $3\times 3$ matrix with $0$ on diaoganals.
    
    Next, consider $4D$ space.
    Here $\star$ acts as an endomorphism of the second exterior power, mapping $2$-forms into $2$-forms. 
    Consider the Minkowski space time with signature $(+,-,-,-)$ and coordinates $(t,x,y,z)$, there we have
    \begin{align}
        \star dt &= dx \wedge dy \wedge dz \\
        \star dx &= dt \wedge dy \wedge dz \\
        \star dy &= -dt \wedge dx \wedge dz \\ 
        \star dz &= dt \wedge dx \wedge dy 
    \end{align}
    
    \paragraph{Wedge product on manifold}
    For an $n-$dimensional oriented pseudo-Reimannian manifold $\mathcal{M}$ we apply the construction such that to each cotangent vector space $T^* _p \mathcal{M}$ and its exterior powers $\Lambda^k T_p ^* \mathcal{M}$ and hence to all differential $k-$forms $\xi\in\Omega^k(\mathcal{M})=\Gamma(\Lambda^k T^* \mathcal{M})$, the global sections of the bundle are $\Lambda^k T^*\mathcal{M}\rightarrow \mathcal{M}$. 
    The Reimannian metric induces inner product on $\Lambda^k T_p ^* \mathcal{M}$ at each point $p\in\mathcal{M}$. We define the \textit{Hodge dual} of a $k-$form $\xi$ defining $\star\xi$ as a unique $(n-k)$-form satisfying
    \begin{equation}
        \eta\wedge\star\xi = \langle\eta,\xi\rangle\omega
    \end{equation}
    for every $k-$form $\eta$ where $\langle\eta,\xi\rangle$ is a real value function on $\mathcal{M}$ and the volume form $\omega$ is induced by the Reimannian metric.
    
    \paragraph{In the coordinate form}
    Consider an orthonormal basis $\{ \frac{\partial}{\partial x_1}, \cdots,\frac{\partial}{\partial x_n} \}$ the a tangent space $V=T_p\mathcal{M}$. And its dual basis $\{ dx_1, ..., dx_n \}$ in $V^* = T_p ^*\mathcal{M}$, with the metric matrix $g_{ij} = \big(\langle\frac{\partial}{\partial x_i},\frac{\partial}{\partial x_j}\rangle\big)$ and its inverse matrix $g^{ij} = \big(\langle dx_i, dx_j \rangle\big)$. The Hodge dual of a decomposable $k$-form is then 
    \begin{equation}
        \star(dx^{i_1}\wedge\cdots\wedge dx^{i_k}) = \frac{\sqrt{|\text{det}[g_{ab}]|}}{(n-k)!}g^{i_1 j_1}\cdots g^{i_k j_k} \epsilon_{j_1 ... j_n} dx^{j_{k+1}}\wedge\cdots\wedge dx^{j_n}
    \end{equation}
    
    %%
    
    \subsection{Conclusion}
    
    In this section we aimed to define certain mathematical concepts crucial for understanding next sections of this chapter.
    
    Particular attentions deserve the concept of tangent vectors $\partial x_i$ and cotangent vectors $\alpha_i$ that on a manifold form tangent $T_p \mathcal{M}$ and contangent $T_p^*\mathcal{M}$ spaces. The manifold that assembles all the tangent vectors is denoted with $T\mathcal{M} = \{ (x,y) | x\in \mathcal{M}, y \in T_x \mathcal{M} \}$, with the projection $\pi:T\mathcal{M}\rightarrow \mathcal{M}$, while the cotangent bundle is a smooth manifold that assembles all the cotangent spaces.
    
    The operation of importance are the \textit{inner product} $\langle \cdot,\cdot \rangle : V \times V \rightarrow \mathcal{F}$, that is linear, positive and conjugate-define, and it allows the paring between vectors and differential forms; 
    and the \textit{outer, Wedge, product} which, acting on vectors, mimics the behavior of the cross product, and acting on differential forms converts $k$-from into $k+1$-form, allowing for instance to define a volume element, $f(x,y,z)dx \wedge dy \wedge dz$. 
    
    Another important concept related to the differential forms on a Reimannian manifold is the Hodge star operator, that allows to convert vector fields into the co-vector fields and vise versa.
    
    For example, for an orientatned plane in Eqclidean space,
    the Hodge dual of the $\wedge$ product of two basis vectors is the normal vector (given by the cross product).

    Thus \textit{Hodge operator} $\star$ is a one-to-one mapping of $k-$ to $(n-k)$-vectors.
    
}{
    pass
}


\section{General-relativistic hydrodynamics}

%% Chose the content output


This chapter is meant to sketch several important parts of the mathematical background. We focus on the aspects relevant for the tools and methods employed in out discussion. 
We do not aim to provide a comprehensive overview. 
The chapter is divided into \todo{list the parts and their content}

\iftoggle{Full}{
    
    %% ---
    
    \subsection{The Cauchy Problem in General Relativity}
    
    %% ---
    
    In this section we briefly recall the initial-value formulation of the Einstein equations of general relativity through the following steps. 
    We start by introducing notations and the basics of GR. 
    We summarize the Einstein field equations. 
    Then we continue with how EFE can be split in a set of evolutionary equations and constraints. 
    For that we focus on the Arnowitt, Deser and Misner, or ADM, formalism. 
    In the end we comment on the stability of the ADM equations, on the need for strongly-hyperbolic formulations of the EFE, and on the choice of gauge conditions commonly used to evolve spacetimes with singularities. 
    This overview is based in \cite{Arnowitt:1962hi,Landau:1982dva,Wald:1984,Misner:1973,Baumgarte:2002jm}, which we refer to for more detained discussion.
    
    %% --- 
    \subsubsection{Euler-Lagrange equations}
    %% ---
    
    \red{Requires understanding of: vectors, differential forms and tensors, smooth manifolds, Lorenzian maniforld and metric, affine connection (Levi-Civita connection), covariant derivatives, action pinciple, lagrange field theory, variation of the action, Einstein-Hilbert action, Ricci scalar and Ricci tensor, Riemann tensor;
    spacelike, timelike and null hypersurface, hyperbolic space-time, space-time foliation,
    Lie-derivative along the vector field, Lagrangian density, Legendre transformation, Hamiltonian,
    extrinsic curvature, Codazzi equations, Gauss equations }
    
    We consider a spacetime defined by the real \textit{smooth manifold} $\mathcal{M}$ and \textit{Lorentzian metric} $\boldsymbol{g}$ on $\mathcal{M}$ of signature $(-,+,+,+)$. 
    The $\nabla$ denotes the \textit{affine connection} associated with $\boldsymbol{g}$, the Levi-Civita connection.
    We use the convention that all Greek indices lie in $\{0, 1, 2, 3\}$ and Lower case Latin indices $\{1, 2, 3\}$.
    The $\nabla\boldsymbol{T}$ denotes the \textit{covariant derivative} of a tensor $\boldsymbol{T}$ and $\nabla_{\boldsymbol{u}}\boldsymbol{T}$ -- covariant derivative along a given vector field $\boldsymbol{u}$.
    
    The scalar product of two vectors then 
    
    \begin{equation}
        \boldsymbol{a}\cdot\boldsymbol{b}:=g_{\mu\nu}a^{\mu}b^{\nu}
    \end{equation}
    
    The action of a linear form on a vector however is represented as 
    
    \begin{equation}
        \langle\boldsymbol{\omega},\boldsymbol{\upsilon}\rangle=\omega_{\mu}\upsilon^{\mu}
    \end{equation}
    
    Let the $\boldsymbol{\alpha}$ be the \textit{totally antisymmetric symbol} that expresses through coordinates $x^{\mu}$ as
    
    \begin{equation}
        \boldsymbol{\alpha} = dx^0 \wedge dx^1 \wedge dx^2 \wedge dx^3,
    \end{equation}
    
    where $\wedge$ denotes \textit{exterior product}. 
    Then, proper \textit{volume pseudo-form} of the spacetime is
    
    \begin{equation}
        \boldsymbol{\varepsilon} = \sqrt{-g}\boldsymbol{\alpha},
    \end{equation}
    
    where $g$ denotes the determinant of the spacetime metric.
    
    In GR, the spacetime is represented by \textit{Lorentzian manifold} $\mathcal{M}$ and $g$, the \textit{Lorentzian metric}.
    
    The \textit{action principle} of the \textit{Lagrangian field theory} on the spacetime $(\mathcal{M}; \boldsymbol{g})$ is
    
    \begin{equation}
        S(\boldsymbol{q}, \nabla\boldsymbol{q}) = \int_{\mathcal{M}}\boldsymbol{\alpha}\mathcal{L}(\boldsymbol{q}, \nabla\boldsymbol{q}),
    \end{equation}
    
    where $\boldsymbol{q}$ are a set of generalized coordinates for the fields described by the theory, $\nabla$ is the Levi-Civita connection, $\mathcal{L}$ is a scalar density of a scalar quantity $\lambda$ as $\lambda(\boldsymbol{q},\nabla\boldsymbol{q})$. 
    
    Varying the action with respect to the $\boldsymbol{q}$
    
    \begin{equation}
        \delta S(\boldsymbol{q}, \nabla\boldsymbol{q}) = \delta\int\boldsymbol{\alpha}\mathcal{L}(\boldsymbol{q}, \nabla\boldsymbol{q}) = \int\boldsymbol{\alpha}\Big(\frac{\partial\mathcal{L}}{\partial\boldsymbol{q}}\delta\boldsymbol{q}+\frac{\partial\mathcal{L}}{\partial(\nabla\boldsymbol{q})}\delta\nabla\boldsymbol{q}\Big)
    \end{equation}
    
    As $\delta$ and $\nabla$ commute, and partially integrating $\nabla$, we obtain
    
    \begin{equation}
        \partial S(\boldsymbol{q}, \nabla\boldsymbol{q}) = \int\boldsymbol{\alpha}\Big(\frac{\mathcal{L}}{\partial\boldsymbol{q}}-\nabla\frac{\partial \mathcal{L}}{\partial(\nabla\boldsymbol{q})}\Big)\delta\boldsymbol{q} + \int_{\mathcal{M}}\boldsymbol{\alpha}\nabla\Big(\frac{\partial\mathcal{L}}{\partial(\nabla\boldsymbol{q})}\delta\boldsymbol{q}\Big)
    \end{equation}
    
    The last term is a boundary term and in order to vanish we impose boundary condition. 
    Assume that the fields are defined over only a \textit{compact domain}. \\
    As the choice of $\partial\boldsymbol{q}$ is arbitrary, the 
    
    \begin{equation}
        \partial S(\boldsymbol{q}, \nabla\boldsymbol{q}) = 0
    \end{equation}
    
    and the \textit{Euler-Lagrange equations} are
    
    \begin{equation}
        \frac{\partial \mathcal{L}}{\partial\boldsymbol{q}} - \nabla\Big(\frac{\partial\mathcal{L}}{\partial(\nabla\boldsymbol{q})}\Big) = 0
        \label{eq:theory:eulerlagrange}
    \end{equation}
    
    %% ---
    \subsubsection{The Hilbert Action}
    %% ---
    
    The \textit{Einstein-Hilbert action} allows to obtain an \textit{Einstein field equations} through the \textit{principle of least action}. Here we briefly underline the procedure.
    
    Introduce action that describes the gravitational field, and a matter field $\mathcal{L}_m$:
    
    \begin{align}
        S_g &= \int\frac{1}{2\kappa}R\epsilon, \\
        S_m &= \int\mathcal{L}_{m}\epsilon,
    \end{align}
    
    where $R$ is the Ricci scalar and $\kappa$ is the  Einstein's constant.
    
    The full action then:
    
    \begin{equation}
        S = \int\Big(\frac{1}{2\kappa}R+\mathcal{L}_m\Big)\epsilon
    \end{equation}
    
    The action principle dicatates, that $\delta S = 0$  with respect to the inverse metric $g^{\mu\nu}$. 
    
    \begin{equation}
        \int\Bigg[\frac{1}{2\kappa}\Big(\frac{\delta R}{\delta g^{\mu\nu}}+\frac{R}{\sqrt{-g}}\frac{\delta\sqrt{-g}}{\delta g^{\mu\nu}}\Big) + \frac{1}{\sqrt{-g}}\frac{\delta(\sqrt{-g}\mathcal{L}_m)}{\delta g^{\mu\nu}}\Bigg]\delta g^{\mu\nu}\epsilon
    \end{equation}
    
    Owing to the arbitrariness of $\delta g^{\mu\nu}$, the integrand must be zero. 
    
    \begin{equation}
        \frac{\delta R}{\delta g^{\mu\nu}} + \frac{R}{\sqrt{-g}}\frac{\delta\sqrt{-g}}{\delta g^{\mu\nu}} = -2\kappa\frac{1}{\sqrt{-g}}\frac{\delta(\sqrt{-g}\mathcal{L}_m)}{\delta g^{\mu\nu}} = -\frac{2\kappa}{\sqrt{-g}}\frac{\delta S_m}{\delta g_{\mu\nu}} := \kappa T_{\mu\nu},
    \label{eq:theory:action1}
    \end{equation}
    
    where we introduced the stress-energy tensor $T_{\mu\nu}$ and the matter action $S_m$ for future use. \\
    
    \gray{this matter action is used in deriving the $T_{\mu} ^{\nu}$ i the invariant fluid formalism}
    
    The continuation of this derivation requires taking variation of the Riccia scalar $R$ and the determinant of the metric $\sqrt{-g}$. 
    As this is a length procedure, we provide here the result. 
    
    \begin{equation}
        \frac{\delta R}{\delta g^{\mu\nu}} = R_{\mu\nu},
    \label{eq:theory:deltaR}
    \end{equation}
    
    where the $R_{\mu\nu}$ is the Ricci curvature tensor.
    
    \begin{equation}
        \frac{1}{\sqrt{-g}}\frac{\delta\sqrt{-g}}{\delta g^{\mu\nu}} = -\frac{1}{2}g_{\mu\nu}.
    \label{eq:theory:deltagmuny}
    \end{equation}
    
    Substituting Eq. \ref{eq:theory:deltaR} and Eq. \ref{eq:theory:deltagmuny} into equation of motion Eq.  \ref{eq:theory:action1} we obtain the Einstein's field equation 
    
    \begin{equation}
        R_{\mu\nu} -\frac{1}{2}g_{\mu\nu}R=8\pi T_{\mu\nu},
    \label{eq:theory:EFE}
    \end{equation}
    
    where in the geometrized unit system, \textit{i.e} $c=G=1$, the $\kappa=8\pi$.
    
    %% ---
    \subsubsection{3+1 Decomposition of Einstein field equations}
    %% ---
    
    The Einstein field equations (\ref{eq:theory:EFE}) represent a set of $10$ non-linear partial differential equations.
    These equations can be defined on a while metric $\mathcal{M}$ or a domain $\Omega\subset\mathcal{M}$, where in the latter, the boundary conditions on $\partial\Omega$ are required. 
    
    It is convenient to chose a \textit{null hyersurface} $\Sigma\subset\mathcal{M}$ on which to define the initial data, from which the evolution of space-time begins. 
    This, however, requires the spacetime to be \textit{strongly hyperbolic}, meaning that the foliation $\mathcal{M}=\Sigma\times\mathbb{R}$ is allowed. 
    This foliation can be understood as splitting the spacetime into a set of \textit{spacelike} hypersurfaces $\Sigma_t$. 
    
    
    \paragraph{Spacelike Foliations}
    
    
    Let the $t$ be the global smooth functions such that, 
    
    \begin{equation}
        \Sigma_{\tau} = \{x^{\alpha}\in\mathcal{M}: t(x^{\alpha})=\tau\},
    \end{equation}
    
    and let $\vec{t}$ be a vector such that $\langle\nabla t, \vec{t}\rangle = 1$. 
    This $t$ can be seen as a "function that advances time" and $\vec{t}$ as a "flow of time" vector field.
    Continuing the analogy, the rate at which a given tensor quantity $\boldsymbol{q}$ changes between hypersurfaces $\Sigma_t$ is given by the \textit{Lie derivative} of the $\boldsymbol{q}$ along the vector $\vec{t}$.
    
    Consider two hypersurfaces $\Sigma_t$ and $\Sigma_{t+dt}$. 
    A transition from one to another can be decomposed into the part tangent to the hypersurface $\Sigma_{t+dt}$ and expressed in a form of a vector $\vec{\beta}$ and a pert normal to the hypersurface $\Sigma_t$ and expressed as a $\alpha \vec{n}$, where $\vec{n}$ is a unit vector, normal to the $\Sigma_t$ in the diretion to $\Sigma_{t+dt}$. 
    Then, the vector $\vec{t}$ can be written as 
    
    \begin{equation}
        \vec{t} = \alpha\vec{n}+\vec{\beta}.
    \end{equation}
    
    $\vec{\beta}$ is called \textit{shift vector} and $\alpha$ is called \textit{lapse-function}. 
    
    The spacetime metric $\boldsymbol{g}$ can be decomposed into a spatial, \textit{Riemannian metric} $\boldsymbol{\gamma}$ as $\boldsymbol{\gamma} = \boldsymbol{g} + \underline{n} \otimes \underline{n}$, where $\underline{n}$ is the 1-form associated to the vector $\vec{n}$. \red{and?}
    The \textit{Levi-Civita connection} can be computed by projecting the $\nabla$ on the space, tangent to the hypersurface $\Sigma_t$.
    
    There are exist coordinates that are adapted to the foliation, namely $\{t, x^i\}$ with $\vec{\partial}_i\cdot \vec{n} = 0$. 
    In these coordiantes the $\nabla t = dt$ and $\vec{t} = \vec{\partial}_t$. 
    
    The connection between $\boldsymbol{g}$ and $\boldsymbol{\gamma}$ is $g_{\mu\nu}=\vec{\partial}_{\mu}\cdot\vec{\partial}_{\nu} $ and can be expressed in terms of $\alpha$ and $\vec{\beta}$ as
    
    \begin{align}
        \text{spatial components: } g_{ik}&=\vec{\partial}_{i}\cdot\vec{\partial}_{j} =\gamma_{ik}, \\
        \text{time component: } g_{tt} &= \vec{\partial}_{t}\cdot\vec{\partial}_{t} = \vec{t}\cdot\vec{t} = - (\alpha^2-\vec{\beta}\cdot\vec{\beta}), \\
        \text{mixed components: } g_{ti} &= \vec{\partial}_{t}\cdot\vec{\partial}_{i} = \vec{t}\cdot\vec{\partial}_i = (\alpha\vec{n}+\vec{\beta})\cdot\vec{\partial}_i=\beta_i,
    \end{align}
    
    where we made use of $\vec{\beta}$ being the spatial vector, \textit{i.e} $\vec{\beta}\cdot\vec{\beta}=\gamma_{ik}\beta^i\beta^k$.
    
    The line-element can be thus written as
    \begin{equation}
        ds^2 = -(\alpha^2-\beta_i\beta^i)dt^2 +2\beta_i dx^i dt + \gamma_{ik} dx^i dx^k.
    \end{equation}
    
    
    \paragraph{Ex-curse: Hamiltonian Field Theory}
    
    
    First we recall the generalized coordinates $\boldsymbol{q}$ and their \textit{covariant derivatives} $\nabla\boldsymbol{q}$. 
    
    In light of the spacetime decomposition discussed above, we divide the $\boldsymbol{\alpha}$ into the time $dt$ and spatial parts represented by the \textit{antisymmetric symbol} ${^{(3)}\boldsymbol{\alpha}}$ as 
    
    \begin{equation}
        \boldsymbol{\alpha} = dx^0 \wedge dx^1 \wedge dx^2 \wedge dx^3 = dt \wedge {^{(3)}\boldsymbol{\alpha}}.
    \end{equation}
    
    Next, we introduce the "time derivative" as a \textit{Lie derivative along the vector field} $\vec{t}$ as 
    
    \begin{equation}
        \dot{\boldsymbol{q}} := \mathcal{L}_{\vec{t}}\boldsymbol{q}.
    \end{equation}
    
    As the $\Lambda(\boldsymbol{q}, \nabla\boldsymbol{q})$ is the \textit{Lagrangian density}, a conjugate momentum can be defined as 
    
    \begin{equation}
        \boldsymbol{p} := \frac{\partial\Lambda}{\partial\dot{\boldsymbol{q}}},
    \end{equation}
    
    Assuming that $\boldsymbol{p}$ and $\nabla\boldsymbol{q}$ can be expressed as a function of $\boldsymbol{q}$ and $\boldsymbol{p}$, inspired by the \textit{Legendre transformation}, we define the \textit{Hamiltonian} and its density as
    
    \begin{align}
        \mathcal{H} &= \boldsymbol{p}\cdot\dot{\boldsymbol{q}} - \mathcal{L}(\boldsymbol{q}, \nabla\boldsymbol{q}) \\
        H &= \int_{\Sigma}\mathcal{H}{^{(3)}\boldsymbol{\alpha}}
    \end{align}
    
    Additionally we define the quantity 
    
    \begin{equation}
        J = \int_{0}^{t}H(\boldsymbol{q},\boldsymbol{p})dt = \int_{0}^{t}dt\int_{\Sigma}\mathcal{H}(\boldsymbol{q},\boldsymbol{p}){^{(3)}\boldsymbol{\alpha}} = \int_{0}^{t}dt\int_{\Sigma}{^{(3)}\boldsymbol{\alpha}}\Big(\boldsymbol{p}\cdot\dot{\boldsymbol{q}} - \mathcal{L}(\boldsymbol{q},\nabla\boldsymbol{q})\Big).
    \end{equation}
    
    Consider the variation of the $J$ with respect to the $\delta\boldsymbol{p}$ and $\delta\boldsymbol{q}$ as
    
    \begin{equation}
        \delta J = \int_{0}^{t}\delta H(\boldsymbol{q},\boldsymbol{p})dt = \int_{0}^{t}dt (\dot{\boldsymbol{q}}\delta\boldsymbol{p}+\boldsymbol{p}\delta\dot{\boldsymbol{q}}) - \int_{0}^{t}dt\delta\Lambda(\boldsymbol{q}, \nabla\boldsymbol{q}).
    \end{equation}
    
    Consider the last term. The variation of the Lagrangian is
    
    \begin{equation}
        \delta\Lambda = \int_{\Sigma}{^{(3)}\boldsymbol{\alpha}}\Bigg[\frac{\delta\Lambda}{\delta\dot{\boldsymbol{q}}}\delta\dot{\boldsymbol{q}}+\frac{\delta\Lambda}{\delta\boldsymbol{q}}\delta\boldsymbol{q}\Bigg],
    \end{equation}
    
    The first term in the square brackets can be reduced to $\boldsymbol{p}\delta\dot{\boldsymbol{q}}$, using the definition of the conjugate momentum. 
    The second term can be treated, applying the Euler-Lagrange equations (\ref{eq:theory:eulerlagrange}). 
    These manipulations result in
    
    \begin{equation}
        \delta\Lambda = \int_{0}^{t}dt\int_{\Sigma}{^{(3)}\boldsymbol{\alpha}}(\boldsymbol{p}\delta\dot{\boldsymbol{q}} + \dot{\boldsymbol{p}}\delta\boldsymbol{q}).
    \end{equation}
    
    Thus we obtain that 
    
    \begin{equation}
        \int_{0}^{t} \delta H(\boldsymbol{q},\boldsymbol{p})dt =   \int_{0}^{t}dt\int_{\Sigma}{^{(3)}\boldsymbol{\alpha}}(\dot{\boldsymbol{q}}\cdot\delta\boldsymbol{p}-\dot{\boldsymbol{p}}\cdot\delta\boldsymbol{q}),
    \end{equation}
    
    and as $\delta\boldsymbol{p}$ and $\delta\boldsymbol{p}$ are arbitrary, the \textit{Hamilton equations} read
    
    \begin{equation}
        \dot{\boldsymbol{q}}=\frac{\delta H}{\delta\boldsymbol{p}}, \hspace{5mm} \dot{\boldsymbol{p}} = -\frac{\delta H}{\delta\boldsymbol{q}}.
    \label{eq:theory:hamiltoneqs}
    \end{equation}
    
    The Hamiltonian formalism can be used to re-derive the field-equations in a from that once the initial data is specified on a hypersurface $\Sigma_0$ for $\boldsymbol{q}$ and $\boldsymbol{p}$, the equations (\ref{eq:theory:hamiltoneqs}) would govern whole the evolution.
    
    
    \paragraph{Extrinsic Curvature and Constraint equations}
    
    
    We define the \textit{extrinsic curvature} of a $D-1$-surface $\Sigma_t\subset\mathcal{M}$ at a point $\mathcal{P}\in\Sigma_t$ as mapping $\boldsymbol{K}$ such that $\boldsymbol{K}(\boldsymbol{\upsilon})=-\nabla_{\boldsymbol{\upsilon}}\boldsymbol{n}$. 
    Note, that the $\boldsymbol{K}$ does not depend on $\alpha$ and $\vec{\beta}$, it is a purely spatial tensor. 
    The components of the extrinsic curvature are 
    
    \begin{equation}
        K_{\mu\nu} = -{\gamma^{\alpha}}_{\mu}\nabla_{\boldsymbol{u}}^{\alpha} n_{\nu} = -\frac{1}{2}\mathcal{L}_{\vec{n}}\gamma_{\mu\nu},
    \label{eq:theory:extrcurvdef}
    \end{equation}
    
    where $\mathcal{L}_{\vec{n}}$ is the Lie derivative along the vector field $\vec{n}$. \\
    From the (\ref{eq:theory:extrcurvdef}) the extrinsic curvature can be interpreted as a "speed of the $\vec{n}$ during the parallel transport along the hypersurface $\Sigma_t$".
    
    \textit{Codazzi equations} relate the $4D$ Ricci tensor to the extrinsic curvature as
    
    \begin{equation}
        D_{\beta}K-D_{\alpha}{K^{\alpha}}_{\beta}=R_{\gamma\delta}n^{\delta}{\gamma^{\gamma}}_{\beta},
    \label{eq:theory:formomentum}
    \end{equation}
    
    here $K$ is a trace of the tensor $\boldsymbol{K}$.
    
    Gauss equation relates the $3D$ \textit{Riemann tensor} $^3{R_{\alpha\beta\gamma}}^{\delta}$ to the $4D$ one and the $\boldsymbol{K}$ as 
    
    \begin{equation}
        ^3{R_{\alpha\beta\gamma}}^{\delta} = {\gamma^{\mu}}_{\alpha}{\gamma^{\nu}}_{\beta}{\gamma^{\lambda}}_{\gamma}{\gamma^{\delta}}_{\sigma}{R_{\mu\nu\lambda}}^{\delta}-K_{\alpha\gamma}{K_{\beta}}^{\delta}+K_{\beta\gamma}{K^{\delta}}_{\alpha}.
    \label{eq:theory:forhamiltconst}
    \end{equation}
    
    The \textit{momentum constraint} thus can be obtained by substituting the (\ref{eq:theory:EFE}) into  (\ref{eq:theory:formomentum}) which yields
    
    \begin{equation}
        D_{\beta}K-D_{\alpha}{K^{\alpha}}_{\beta} = -8\pi{\gamma^{\alpha}}_{\beta} n^{\gamma}T_{\alpha\gamma}=:8\pi j_{\beta},
    \label{eq:theory:momconstraint}
    \end{equation}
    
    where $j^{\alpha}$ is the ADM momentum density.
    
    The \textit{Hamiltonian constraint} can be obtained by substituting EFE (\ref{eq:theory:EFE}) into the (\ref{eq:theory:forhamiltconst}), yielding 
    
    \begin{equation}
        ^3 R+ K^2 - K_{\alpha\beta}K^{\alpha\beta} = 2G^{\alpha\beta}n_{\alpha}n_{\beta} = 16\pi n_{\alpha}n_{\beta} T^{\alpha\beta} =: 16\pi E,
    \label{eq:theory:hamilconstraint}
    \end{equation}
    
    where $E$ is the ADM energy density.
    
    The obtained constraint equations represent a set of \textit{elliptic equations} that must be satisfied on every hyprsurface $\Sigma_i$ of the foliation. 
    It is however, possible to show that Einstein equations preserve the constraints, meaning that if they are satisfied at the initial slice $\Sigma_0$ they will be satisfied at any time in the future.
    
    
    \paragraph{The Hamiltonian Formulation of the Einstein Equations, ADM equations}
    
    
    \gray{deriving the evolution equations, ADM formulation}
    
    %% Part 1 [Extrinsic curvature]
    
    Here we briefly sketch to path of derivation of the Einstein field equations in the Hamiltonian framework. We will elude most of the intimidate and computationally extensive steps, as well as derivation of the boundary terms. For this we refer to \cite{Poisson:2004}.
    
    First it is useful to note that determinant of the three-metric $\sqrt{\gamma}$ can be expressed as $\sqrt{\gamma}=\sqrt{-g}/\alpha$. 
    The $p$ is the trace of the canonical momentum $\boldsymbol{p}$.
    
    Now, consider the \textit{scalar curvature}, $R$,
    
    \begin{align}
        G_{\mu\nu} &= R_{\mu\nu} - \frac{1}{2}Rg_{\mu\nu} \\
        -Rg_{\mu\nu}n^{\nu}n^{\mu} &= 2(G_{\mu\nu} n^{\nu}n^{\mu}-R_{\mu\nu}n^{\mu}n^{\mu})\\
        -Rn_{\mu}n^{\mu}& = 2(G_{\mu\nu}n^{\nu}n^{\mu} - R_{\mu\nu}n^{\mu}n^{\mu}) \\
        R &= 2(G_{\mu\nu}n^{\mu}n^{\nu} - R_{\mu\nu}n^{\mu}n^{\nu}).
    \end{align}
    
    From the \textit{Gauss-Codacci equation} (\ref{eq:theory:momconstraint}), which relates the spatial curvature $^{(3)}R$ to the spacetime curvature $R$, we have the following constraint relationship
    
    \begin{equation}
        2G_{\mu\nu}n^{\mu}n^{\nu} = {^{(3)}R} + K^2 - K_{\mu\nu}K^{\mu\nu}.
    \end{equation}
    
    The $R_{\mu\nu}n^{\mu}n^{\nu})$ can be expressed as a combination of extrinsic curvature and total divergences as follows.
    From the definition of the Ricci tensor $R_{\mu\nu}$, we have:
    
    \begin{align}
        R_{\mu\nu} &= {R_{\mu\gamma\nu}}^{\gamma} \\
        R_{\mu\nu}n^{\mu}n^{\nu} &= {R_{\mu\gamma\nu}}^{\gamma} \\
        &= -(\nabla_{\mu}\nabla_{\gamma} - \nabla_{\gamma}\nabla_{\mu})n^{\gamma}n^{\nu} \\
        &= n^{\mu}(\nabla_{\mu}\nabla_{\gamma} - \nabla_{\gamma}\nabla_{\nu})n^{\gamma} \\
        &= (\nabla_{\mu}n^{\mu})(\nabla_{\gamma}n^{\gamma}) - \nabla_{\mu}(n^{\mu}\nabla_{\gamma}n^{\gamma}) - (\nabla_{\gamma}n^{\mu})(\nabla_{\mu}n^{\gamma}) + \nabla_{\gamma}(n^{\mu}\nabla_{\mu}n^{\gamma}) \\
        &= K^2 - K_{\mu\gamma}K^{\mu\gamma} - \nabla_{\mu}(n^{\mu}\nabla_{\gamma}n^{\gamma}) + \nabla_{\gamma}(n^{\mu}\nabla_{\mu}n^{\gamma})
    \end{align}
    
    In case of variations with compact support, that we are interested in, the total divergences -- last two terms -- can be neglected. 
    Then the result is
    
    \begin{equation}
        R_{\mu\nu}n^{\mu}n^{\nu}= K^2 - K_{\mu\nu}K^{\mu\nu}.
    \label{eq:theory:rmunu_as_func_k}
    \end{equation}
    
    %% part 2 [Canonical momentum and Hamiltonian]
    
    Using the fact that $\sqrt{\gamma}=\sqrt{-g}/\alpha$ and the (\ref{eq:theory:rmunu_as_func_k}) we obtain the Lagrangian density in terms of the variables on the hypersurface:
    
    \begin{align}
        \Lambda &= \sqrt{-g}R \\
        &= \alpha\sqrt{\gamma}R \\
        &= 2\alpha\sqrt{\gamma}(G_{\mu\nu}n^{\mu}n^{\nu} - R_{\mu\nu}n^{\mu}n^{\nu})\\ 
        &= 2\alpha\sqrt{\gamma}\Big(\frac{1}{2}[{^{(3)}R} - K_{\mu\nu}K^{\mu\nu} + K^2] - K^2 - K_{\mu\nu}K^{\mu\nu}\Big)
    \end{align}
    
    Together with the contribution from matter fields, we obtain
    
    \begin{equation}
        \Lambda = \Lambda_g+\Lambda_m= \frac{1}{16\pi}\alpha({^{(3)}R} + K_{\mu\nu}K^{\mu\nu} - K^2)\sqrt{\gamma}+\Lambda_m
    \end{equation}
    
    Next we note that the extrinsic curvature of a
    surface $\Sigma$ is defined as $K_{\mu\nu} = \nabla_{\mu}n_{\nu}$. 
    
    To relate $K_{\mu\nu}$ to the metric, we make use of the following property of Lie derivatives:
    
    \begin{align}
        \mathcal{L}_{\vec{n}}g_{\mu\nu} &= n^{\gamma}\nabla_{\gamma}g_{\mu\nu} + g_{\gamma\nu}\nabla_{\mu}\upsilon^{\gamma} + g_{\mu\gamma}\nabla_{\nu}\upsilon^{\gamma} \\
        &= \nabla_{\mu}n_{\nu}+\nabla_{\nu}\upsilon_{\nu} \\
        &=2\nabla_{\mu}n_{\nu}
    \end{align}
    
    where the second line holds when $\nabla_{\gamma}\mu$ is the natural derivative operator corresponding to the metric $g_{\mu\nu}$ and the third line holds because $K_{\mu\nu}$ is symmetric.
    
    Substituting this into our definition of $K_{\mu\nu}$,
    
    \begin{align}
        K_{\mu\nu} &= -\frac{1}{2}\mathcal{L}_{\vec{\vec{n}}}g_{\mu\nu} \\
        &= -\frac{1}{2}\mathcal{L}_{\vec{\vec{n}}}(\gamma_{\mu\nu}-n_{\mu}n_{\nu}) \\
        &= -\frac{1}{2}\mathcal{L}_{\vec{\vec{n}}}\gamma_{\mu\nu} \\
        &= -\frac{1}{2}[n^{\gamma}\nabla_{\gamma}\gamma_{\mu\nu} + \gamma_{\gamma\nu}\nabla_{\mu}\upsilon^{\nu} + h_{\mu\gamma}\nabla_{\nu}\upsilon^{\gamma}] \\
        &= -\frac{1}{2\alpha}[\alpha n^{\gamma}\nabla_{\gamma}\gamma_{\mu\nu} + \gamma_{\gamma\nu}\nabla_{\mu}\alpha\upsilon^{\nu} + h_{\mu\gamma}\nabla_{\nu}\alpha\upsilon^{\gamma}] \\
        &= -\frac{1}{2\alpha}{\gamma_{\mu}}^{\gamma}{\gamma_{\nu}}^{\delta}[\mathcal{L}_{\vec{t}}\gamma_{\gamma\delta}-\mathcal{L}_{\vec{\beta}}\gamma_{\gamma\delta}] \\
        &= -\frac{1}{2\alpha}{\gamma_{\mu}}^{\gamma}{\gamma_{\nu}}^{\delta}[\partial_t\gamma_{\mu\nu}-D_{\mu}\beta_{\nu}-D_{\nu}\beta_{\mu}]
    \end{align}
    
    and on the hypersurface $\Sigma$ the \textit{projection operators} are not needed. So we obtain
    
    \begin{equation}
        K_{\mu\nu} = -\frac{1}{2}\mathcal{L}_{\vec{n}}\gamma_{\mu\nu}=-\frac{1}{2\alpha}(\partial_t\gamma_{\mu\nu}-D_{\mu}\beta_{\nu}-D_{\nu}\beta_{\mu})
    \end{equation}
    
    which allows us to express the canonical momentum $p^{\mu\nu}$ as
    
    \begin{align}
        p^{\mu\nu} &= \frac{\partial\Lambda}{\partial\dot{\gamma}_{\mu\nu}} \\
        &= -\frac{\sqrt{\gamma}}{16\pi}\alpha\Bigg[\frac{\partial {^{(3)}R}}{\partial\dot{\gamma}_{\mu\nu}} + \frac{\partial(K_{\mu\nu}K^{\mu\nu})}{\partial\dot{\gamma}_{\mu\nu}} - \frac{\partial K^2}{\partial\dot{\gamma}_{\mu\nu}}\Bigg] \\
        &= \frac{\sqrt{\gamma}}{16\pi}(K\gamma^{\mu\nu} - K^{\mu\nu}),
    \end{align}
    
    where 
    
    \begin{equation}
        \frac{\partial K_{\mu\nu}}{\partial \dot{\gamma}_{\mu\nu}} = \frac{1}{2\alpha}, \hspace{5mm} \frac{\partial {^{(3)}R}}{\partial \dot{\gamma}_{\mu\nu}} = 0, \hspace{5mm}\frac{\partial K^2}{\partial \dot{\gamma}_{\mu\nu}} = \frac{\gamma^{\mu\nu}K}{\alpha}
    \end{equation}
    
    assuming that there is no explicit dependency of the $\Lambda$ on $dot{\gamma}_{\mu\nu}$.
    
    Since, $\alpha$ and $\vec{\beta}$ are related to the the \textit{gauge freedom}, -- there are many ways the manifold $\mathcal{M}$ can be split into hypersurfaces -- the momenta associated with these functions and vectors is zero.
    
    Thus, the \textit{Hamiltonian density} is
    
    \begin{align}
        \mathcal{H} &= p^{\mu\nu}\dot{\gamma}_{\mu\nu} - \Lambda \\
        &= -\sqrt{\gamma}\alpha{^{(3)}R} + \frac{\alpha}{\sqrt{\gamma}}\Big[p^{\mu\nu}p_{\mu\nu}-\frac{1}{2}p^2\Big] + 2p^{\mu\nu} D_{\mu}\beta_{\mu} -\Lambda_m \\
        %    &=  \frac{\sqrt{\gamma}}{16\pi}\Bigg\{\alpha\Big[-{^{(3)}R}+h^{-1}p^{\mu\nu}p_{\mu\nu}-\frac{1}{2}h^{-1}p^2\Big] - 2\beta_{\nu}\big[D_{\mu}(h^{-1/2}p^{\mu\nu})\big] + D_{\mu}(h^{-1/2}\beta_{\nu}p^{\mu\nu})\Bigg\} \\
        &= \frac{\sqrt{\gamma}}{16\pi}\Bigg\{\alpha\Big[ -{^{(3)}R} + \gamma^{-1}p^{\mu\nu}p_{\mu\nu}-\frac{1}{2}\gamma^{-1}p^2\Big] +  2\beta_{\nu}\Big[D_{\mu}(\gamma^{-1/2}p^{\mu\nu})\Big] - 2D_{\mu}(\gamma^{-1/2}\beta_{\nu}p^{\mu\nu}) \Bigg\} - \Lambda_m,
    \end{align}
    
    where we restored the correct $16\pi$ factor in the last line.
    
    As we consider variations with compact suppot, the last boundary term, can be neglected.
    
    %% part 3 [Arriving at constraint equations (again)]
    
    Now we consider the variation of the matter action $S_m$ with respect to the $\alpha$ and $\vec{\beta}$
    
    \begin{align}
        \frac{\delta S_m}{\delta \alpha} &=-\alpha\frac{\delta S_m}{\delta g_{00}} = -\alpha\sqrt{-g}T^{00} = -\alpha^2\sqrt{\gamma}T^{00} = -\sqrt{\gamma}T^{\mu\nu}n_{\mu}n_{\nu} \\
        \frac{\delta S_m}{\delta \beta_{\mu}} &= \frac{\delta S_m}{\delta g_{\mu 0}} =\frac{1}{2}\sqrt{-g}T^{\mu 0} = -\frac{1}{2} \sqrt{\gamma}T^{\mu\nu}n_{\nu}.
    \end{align}
    
    As the variation of the Hamiltonian $H$ with respect to a quantity with vanishing canonical momentum is zero, we obtain two equations 
    
    \begin{align}
        \frac{\delta H}{\delta \alpha} &= 0 = -{^{(3)}R} + \gamma^{-1}p^{\mu\nu}p_{\mu\nu}-\frac{1}{2}\gamma^{-1}p^2 + 16\pi T^{\mu\nu}n_{\mu}n_{\nu} \\
        \frac{\delta H}{\delta \beta_{\mu}} &= 0 = - D_{\mu}(\gamma^{-1/2}p^{\mu\nu}) + 8\pi{\gamma^{\mu}}_{\nu}n_{\gamma}T^{\nu\gamma}.
    \label{eq:theory:hamiltonianvariation}
    \end{align}
    
    Note, that the $\delta H / \delta\beta_{\mu}$ is actually a \textit{Frech\'et differential} $dH$, $\delta \beta_{\mu}$, which is writes as
    
    \begin{equation}
        \langle dH,\delta\beta \rangle = \delta\beta_{\mu}\big[-D_{\nu}(\gamma^{-1/2}p^{\mu\nu})+8\pi n_{\gamma}T^{\mu\nu}\big], 
    \end{equation}
    
    containing $\delta\beta_{\mu}$ which is spatial. 
    
    Thus only the spatial part is being constrained in the equation above. 
    To account for that the projector ${\gamma^{\mu}}_{\nu}$ is added to the $\delta H/\delta \beta_{\mu}$.
    
    The pair of equations (\ref{eq:theory:hamiltonianvariation}) is in fact the constraint equations derived before, namely the (\ref{eq:theory:momconstraint}) and (\ref{eq:theory:hamilconstraint}), and as we now see, they are related to the coordinate freedom of $\mathcal{M}$ decomposition and a coodrinate freedom on hypersurfaces.
    
    %% Part 4 [hamiltonian equations for metric -- evolution equations]
    
    Proceeding with the Hamiltonian formalism we note that equation \ref{eq:theory:hamiltoneqs} leads to the evolution equations for the three-metric, assuming that $\Lambda$ explicitly does not depend on the momentum
    
    \begin{equation}
        \dot{\gamma}_{\mu\nu} =\frac{\delta H}{\delta p^{\mu\nu}} = 2\gamma^{-1/2}\alpha\big(p_{\mu\nu}-\frac{1}{2}\gamma_{\mu\nu}p\big) - D_{\nu}\beta_{\mu}-D_{\mu}\beta_{\nu}
        %    -2D_{(\mu}\beta_{\nu)},
    \label{eq:theory:_adm_metric_evo}
    \end{equation}
    
    The evolution equations for the canonical momentum can read
    
    \begin{align}
        \dot{p}^{\mu\nu} = -\frac{\delta H}{\delta \gamma_{\mu\nu}} = &+ \alpha\gamma^{1/2}\big({^{(3)}R}^{\mu\nu}-\frac{1}{2}{^{(3)}R\gamma^{\mu\nu}}\big) \\
        & - \frac{1}{2}\alpha\gamma^{-1/2}\gamma^{\mu\nu}\big(p_{\gamma\delta}p^{\gamma\delta}-\frac{1}{2}p^2\big) \\
        & + 2\alpha\gamma^{-1/2}\big(p^{\mu\gamma}{p^{\nu}}_{\gamma}-\frac{1}{2}pp^{\mu\nu}\big) \\
        & - \gamma^{1/2}\big(D^{\mu}D^{\nu}\alpha-\gamma^{\mu\nu}D^{\gamma}D_{\gamma}\alpha\big) \\
        & - \gamma^{1/2}D_{\gamma}\big(\gamma^{-1/2}\beta^{\gamma}p^{\mu\nu}\big) \\
        &+ 2p^{\gamma(\mu}D_{\gamma}\beta^{\nu)} + 8\pi \alpha \gamma^{1/2}S^{\mu\nu},
    \label{eq:theory:_adm_mom_evo}
    \end{align}
    
    where $A_{(\mu\nu)} = 0.5(A_{\mu\nu}+A_{\nu\mu})$ the convention used, and where $S^{\mu\nu}={\gamma^{\mu}}_{\alpha}{\gamma^{\nu}}_{\beta}T^{\alpha\beta}$. 
    
    Additionally, taking the variation of the matter field we noted that
    
    \begin{equation}
        \frac{\delta S}{\delta \gamma_{ik}} = \frac{\delta S_m}{\delta g_{ik}} = \frac{1}{2}\sqrt{-g}T^{ik}.
    \end{equation}
    
    The set of equations (\ref{eq:theory:hamiltonianvariation}), (\ref{eq:theory:_adm_metric_evo}) and (\ref{eq:theory:_adm_mom_evo}) comprise the ADM system. 
    A more widely used from of these equations is in turns of $\gamma_{ij}$ and $K_{ij}$ that reads
    
    \begin{align}
        (\partial_t - \mathcal{L}_{\vec{\beta}})\gamma_{ik} &= -2\alpha K_{ik}; \\
        (\partial_t - \mathcal{L}_{\vec{\beta}})K_{ik} &= -D_{i}D_{k}\alpha + \alpha\big(R_{ik} - 2K_{ij}{K^j}_k+KK_{ik}\big) - 8\pi\alpha\big(S_{ik} - \frac{1}{2}\gamma_{ik}(S-E)\big); \\
        {^{(3)}R} + K^2 - K_{ik}K^{ik} &= 16\pi E; \\
        D_{i}K-D_{k}{K^k}_i &= 8\pi j_i,
    \label{eq:theory:adm}
    \end{align}
    
    where $S = \gamma^{ij}S_{ij}$.
    
    These equations constitute the IVP for Einstein field equations and are known as ADM equations. 
    The last two equations are the constraint equations. They determine how to set the initial data on the hypersurface $\Sigma_0$, via prescribing the three-metric and extrinsic curvature. The first two equations then govern the evolution.
    
    \todo{make sure that the coefficients in formuals are consistent, $16\pi$ might me missing or $-$}
    \todo{Makse sure that $\Lambda$ stands for largangian density and $\mathcal{L}$ for lie derivative}
    
    
    \paragraph{Strongly Hyperbolic Formulations of the Einstein Equations}
    
    
    
    
    %% --- 
    
    \subsection{Conclusion}
    
    %% --- 
    
    %% Subsection 1 [Euler-Lagrange equations]
    In this section we have shown a derivation of \textit{Euler-Lagrange equations} from the variation of the action of \textit{Lagrange field theory} with respect to the \textit{generalized coordinates of the field}, and assuming the compact domain for boundary conditions.
    %% Subsection 2 [The Hilbert Action]
    Then, we sketched how the \textit{Einstein field equations} can be derived from the \textit{Einstein-Hilbert action}, that describes gravitational and matter fields, through the \textit{principle of least action}.
    %% Subsection 3 [3+1 Decomposition of Einstein field equations]
    Then we discussed how the Einstein field equations, which are the $10$ non-linear partial differential equations, can be decomposed into the $3+1$ system of equations, commonly adopted in numerical applications.
    This is done by assuming the space-time to be strongly hyperbolic, and defining the initial data on the numm hypersurface and performing the space-time foliation, -- in other words -- splitting the spacetime into a set of \textit{spacelike} hypersurfaces.
    There, the transition from one hyersurface to another is conveniently done with the help of vector $\vec{t} = \alpha\vec{n}+\vec{\beta}$. This "time flow vector" is composed of the part tangent to the hypersurface (to which the transition is done), the so-called \textit{shift}, $\vec{\beta}$; and the part, normal to the previous hypersurface in the direction of the next one, the lapse function $\alpha$. 
    The space-time metric is then decomposed into the spatian, \textit{Riemannian metric} and time part.
    %% paragraph []
    In light of the spacetime decomposition, the Hamiltonian formalism can be used to re-derive the field-equations in a from that once the initial data is specified on a hypersurface $\Sigma_0$ for $\boldsymbol{q}$ and $\boldsymbol{p}$, the equations (\ref{eq:theory:hamiltoneqs}) would govern whole the evolution. 
    Such form consists of a set of constraint and evolution equations.
    %% Extrisnsic curvature and momentum constraint.
    To obtain them, first the concept of the extrinsic curvature is introduced, which can be thought of as a speed of the norm to the hypersurface, $\vec{n}$, during its parallel transport along the hypersurface $(\Sigma_t)$.
    %% constraint equations
    Then, the first, \textit{momentum constraint}, can be obtained by inserting the EFE intor the Codazzi equation, that relates the $3D$ Ricci tensor to the extrinsic curvature. 
    The second, the \textit{Hamiltonian constraint} is derived by substituting the EFE into the gauss equation that relates the $4D$ Riemann tensor with the $3D$ one and extrinsic curvature.
    %% on the constraint equations
    The obtained constraint equations represent a set of \textit{elliptic equations} that must be satisfied on every hyprsurface $\Sigma_i$ of the foliation. 
    It is however, possible to show that Einstein equations preserve the constraints, meaning that if they are satisfied at the initial slice $\Sigma_0$ they will be satisfied at any time in the future. 
    %% paragraph [The Hamiltonian Formulation of the Einstein Equations]
    The derivation of the evolution equations can be summarized as follows. 
    %% --- Part 1 [Extrinsic curvature]
    We begin by expressing the extrinsic curvature $R$, through $G_{\mu\nu}$ and $R_{\mu\nu}$. 
    Then, we utilize \textit{Gauss-Codacci equation} (the momentum constraint), that relates spatial curvature $^{(3)}R$ to the spacetime curvature $R$.
    Next, we note that from its definition, the Ricci tensor, $R_{\mu\nu}$, can be expressed as a combination of extrinsic curvature, $K$, and $K_{\mu\gamma}K^{\mu\gamma}$ and total divergences, which in the case of variations with compact support, nullifies. 
    The result is a simple relation between the Ricci tensor $R_{\mu\nu}$ and extrinsic curvature $K$ and $K_{\mu\nu}K^{\mu\nu}$, written as 
    $R_{\mu\nu}n^{\mu}n^{\nu}= K^2 - K_{\mu\nu}K^{\mu\nu}$
    %% --- Part 2 [Deriving Canonical momentum and Hamiltonian]
    Now we can write the Lagrangian density, $\Lambda$ in terms of the variables on the hypersurface, which consists of the gravity and matter parts, as $\Lambda = \Lambda_g+\Lambda_m$. 
    Then, we relate the extrinsic curvature on the hypersurface, $K_{\mu\nu}$, to the metric, making use of a certain property of Lie derivative. 
    Then we arrive at an expression for the canonical momentum, $p^{\mu\nu}$, and in turn, to the Hamiltonian density $\mathcal{H}$.
    %% --- Part 3 [Arriving at constraint equations (again)]
    Now we consider the variation of the matter action $S_m$ with respect to the $\alpha$ and $\vec{\beta}$ and the variation of the Hamiltonian $H$.
    This gives a set of equations, in which only the spatial part is constrained, which requires an addition of a projector. Thus, we have arrived to the pair of constrained equations, derived before. However, now we see that they are related to the coordinate freedom of $\mathcal{M}$ decomposition and a coordinate freedom on hypersurfaces.
    %% --- Part 4 [hamiltonian equations for metric -- evolution equations]
    Recalling the Hamiltonian system of equations (canonical equations), we note that they lead to the evolution equations for the three-metric, $\dot{\gamma}_{\mu\nu}$. Then we obtain the evolution equations for the canonical momentum $\dot{p}^{\mu\nu}$. The set of equations we obtain, then, comprise the so-called ADM system.
    %% --- Remarks 
    These equations constitute the IVP for Einstein field equations and are known as ADM equations. The last two equations are the constraint equations. They determine how to set the initial data on the hypersurface $\Sigma_0$, via prescribing the three-metric and extrinsic curvature. The first two equations then govern the evolution.
    

}{
    pass
}






























