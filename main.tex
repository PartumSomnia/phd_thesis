\documentclass[11pt,a4paper,headinclude=true,DIV=14,BCOR=8mm,chapterprefix,listof=totoc,twoside,openright,abstracton]{scrbook}

\usepackage[headsepline]{scrpage2}
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{float}
\usepackage[intlimits]{amsmath}
% \usepackage{siunitx}
% \usepackage{color}
\usepackage{xcolor}
\usepackage{verbatim}
\usepackage{appendix}
\usepackage{hyperref}
\usepackage{hyperref}
\usepackage{mathtools}
% \usepackage[style=authoryear]{biblatex}
\usepackage{natbib}
% \usepackage{newtxtext}
% \usepackage{newtxmath}
% \usepackage{harvard}
\setcitestyle{aysep={}} 
\bibliographystyle{apalike}
\usepackage{xr}
\usepackage{wrapfig}
% \bibliographystyle{agsm}
%\usepackage{feynmf}
%\usepackage{tensor}
\usepackage[framemethod=tikz]{mdframed} % for a block of text

\setlength{\parindent}{0pt}
\geometry{a4paper, tmargin=3cm, bmargin=3cm, lmargin=3cm, rmargin=3cm, headheight=3em, headsep=2em, footskip=1cm}

\setcitestyle{citesep={,}}

\newcommand{\todo}[1]{\textcolor{red}{$\blacksquare$ TODO: #1}} 

\newmdenv[linecolor=cyan,backgroundcolor=cyan!20]{sidenote}


\geometry{a4paper, tmargin=2cm, bmargin=2cm, lmargin=1cm, rmargin=1cm, headheight=2em, headsep=2em, footskip=1cm}

\title{PhD thesis}
\author{Vsevolod Nedora}
\date{today}

\begin{document}
    
    \maketitle

%% --------------- 
%%
%% Theory
%%
%% ---------------

\chapter{General-Relativistic Hydrodynamics}

This chapter is meant to sketch several important parts of the mathematical background. We focus on the aspects relevant for the tools and methods employed in out discussion. We do not aim to provide a comprehensive overview. 
The chapter is divided into \todo{list the parts and their content}

\begin{sidenote}
    \textbf{Note on the exterior algebra} \\
    \textit{Understanding the exterior product, Wedge product} \\
    If $\phi$ and $\psi$ are the 2-forms given for example as 
    \begin{equation}
        \phi = x dx - y dy \hspace{5mm} \text{and} \hspace{5mm}\psi = z dx + x dz
    \end{equation}
    Then the exterior produce is given by 
    \begin{align}
        \phi\wedge\psi &= (x dx - y dy)\wedge(zdx + xdz) = \\
        &=xzdxdx+x^2dxdz-yzdydx-yxdydz= \\
        &=yzdxdy + x^2 dx dz - xydydz
    \end{align}
    as $dxdx=0$ and $dydx=-dxdy$. The product of two 1-forms is a 2-form.
    In general, the wedge product of a$p$-form and $q$-form is a $(p+q)$-form. \\
    
    Next, consider a surface $\mathcal{M}$ and two 1-forms on it $\phi$ and $\psi$ Then the wedge product is 
    \begin{equation}
        (\phi\wedge\psi)(v,w)=\phi(v)\psi(w) - \phi(w)\psi(v)
    \end{equation}
    for any $v$ and $w$ tangent vectors to $\mathcal{M}$. \\
    
    The central idea in exterior algebra is that the operations are designed to create the permutational antisymmetry. Let the $dx_i$ be the basis 1-from $\omega_j$ are the orbitrary $p$-form (of order $p_j$), $a$ and $b$ are arbitrary scalars. Then the wedge product is defined to have properties:
    
    \begin{align}
        (a\omega_1+b\omega_2)\wedge\omega_3 &= a\omega_1\wedge\omega_3+b\omega_2\wedge\omega_3 \hspace{5mm} (p_1 = p_2), \\
        (\omega_1\wedge\omega_2)\wedge\omega_3 &= \omega_1\wedge(\omega_2\wedge\omega_3), \hspace{5mm} a(\omega_1\wedge\omega_2) =  (a\omega_1)\wedge\omega_2\\
        dx_i\wedge dx_j &= -dx_j\wedge dx_i
    \end{align}
    Thus, any arbitrary differential form can be reduced to a coefficient multiplying $dx_i$ or a wedge produce of the generic form 
    \begin{equation}
        dx_i\wedge dx_j \wedge...\wedge dx_p
    \end{equation}
    with the properties allowing to put all coefficients together as 
    \begin{equation}
        a dx_1 \wedge b dx_2 = - a(b dx_2 \wedge dx_1) = -ab(dx_2 \wedge dx_1) = ab(dx_1 \wedge dx_2)
    \end{equation}
    
    The exterior or wedge product acts on tangent vectors. The $\wedge$ or two tangent vectors $\boldsymbol{u}\wedge\boldsymbol{v}$, ($\boldsymbol{u}, \boldsymbol{v}\in T_p(\mathcal{M})$) is an antisymmetric tensor product that in addition to bilinarity requires antisymmetry. 
    \begin{align}
        \boldsymbol{v} =& v^1e_1 + v^2 e_2 + v^3 e_3 \\
        \boldsymbol{u} =& u^1e_1 + u^2 e_2 + u^3 e_3 \\
        \boldsymbol{v}\wedge\boldsymbol{u} =& (v^1u^1 - v^2u^1)(e_1\wedge e_2) + \\
        & + (v^1u^3 - v^3u^1)(e_1\wedge e_1) + \\
        & + (v^2u^3 - v^3u^2)(e_2\wedge e_1)
    \end{align}
    mimicing the behaviour of the cross product. However, this can easly be extended to higher dimensions. \\
    Important, that the resulting object of $\boldsymbol{v}\wedge\boldsymbol{u}$ does not belong to $T_p M$. It is called and alternating bivector and is an element of the vector space $\Lambda^2 T_p (\mathcal{M})$ ,that is called -- second exterior power of $T_p \mathcal{M}$. \\
    Generally one obtains $\Lambda^k T_p (\mathcal{M})$ that is a linear subspace of $T_p ^k (\mathcal{M})$\\
    Consider a cotangent space $T_p ^* \mathcal{M}$. The exterior product on this space is copativle with wedge product on $T_p\mathcal{M}$ and is usually denoted with the same symbol and yeilds: $(\boldsymbol{\alpha}\wedge\boldsymbol{\beta})\in\Lambda^2 T_p ^* \mathcal{M}$.
\end{sidenote}

\begin{sidenote}
    \textbf{Differentia form} \\
    Used for multivariable calculus independent of coordinates. Used for integrands over curves, manifolds. For example, differential form can be used to define a volume element as $f(x,y,z)dx \wedge dy \wedge dz$.\\
    Albegra of diff.forms is organized to reflect the orientation of the domain of integration. For instance: the exterior product $d$ that converts $k$-from into $k+1$-form. This operation is similar to the divergence and the curl of a vector field. \\
    Differential 1-forms are naturally dual to vector field on a manifold. Pairing is done via inner product. \\
    If there are two manifolds, then the albegra of diff.forms and their exterior derivatives is preserved by the \textit{pullblack} under the smooth function. This allows geometrically invariant information to be moved from one space to another via the pullback. \\
    Let $\mathcal{M}$ be an orientated $m$-dimentional manifold and $\mathcal{M}'$ is the same manifold with the opposite orientation and $\omega$ is an $m$-form, then 
    \begin{equation}
        \int_{\mathcal{M}}\omega = -\int_{\mathcal{M}'}\omega.
    \end{equation}
    
    The \textit{exterior algebra} is used to make the notion of an oriented density precise.
    The basic $1$-forms are \textit{differentials} ofthe coordiantes $dx^1,...,dx^n$. Each of them is a \textit{covector} that measures a small displacement in the corresponding coordinate direction. A general $1$-form thus is the combination  of these differentials 
    \begin{equation}
        f_1dx^1\cdot\cdot\cdot f_ndx^n
    \end{equation}
    where $f_k=f_k(x^1,...,x^n)$ are functions of all the coordiantes. \\
    Wedge product is similar to cross product, and is used to be higher diff. forms out of lower ones, as the cross product in vector calculus. \\
    
    The \textit{Exterior derivative}, operator $d$, which is a generalisation of a differential of a function. Let $\omega=fdx^I$ being a simple $k$-form. Then its exterior derivative $d\omega$ is a $(k+1)$-form set by taking differential of the doefficient functions
    \begin{equation}
        d\omega = \sum_{i=1}^n \frac{\partial f}{\partial x^i}dx^i \wedge dx^I
    \end{equation}
    Thus a deferential form, lets say, differential 2-form is called an exterior derivative $da$ of $a=\sum_{j=1}^{n}f_j dx^j$. It is given by
    \begin{equation}
        da = \sum_{j=1}^n df_j \wedge dx^j = \sum_{i,j=1}^n \frac{\partial f_j}{\partial x^i}dx^i\wedge dx^j.
    \end{equation}
    Overall, the $da=0$ is required for a function $f$ such that $a=df$.
    
    On as mooth manifold $\mathcal{M}$ the differential from of degree $k$ is a smooth section of the $k$th exterior power of the cotangent bundle of $\mathcal{M}$. Then, the set of all the $k-$forms on $\mathcal{M}$ is a \textit{vector space} $\Omega^k(\mathcal{M})$. The formal definition then stands. At any point $p\in \mathcal{M}$ a $k-$form $\beta$ defines an element 
    \begin{equation}
        \beta_p\in\Lambda^kT^* _p \mathcal{M}
    \end{equation}
    where $T_p\mathcal{M}$is the tangent space tp $\mathcal{M}$ at $p$. The $T^* _p \mathcal{M}$ is its dual space. Thus, $\beta$ is also a linear functional such that $\beta_p:\Lambda^k T_p \mathcal{M}\rightarrow I\!R$
\end{sidenote}

\begin{sidenote}
    \textbf{Differential forms on a Reimannian maniforld} \\
    There metric defines a fiber-wise isomorphism of the tangent and cotangent spaces. This allows to convert vector fields to covector field and vice versa. It also allows the definition of the \textit{Hodge star operator}.
    
    Hodge star operator $\star$ is a linear map, defined on the exterior algebra of a finite-dimensional oriented vector space endowed with a nongegenerate symmetric bilinear form. Applying the operator to the element of the algebra produces the \textit{Hodge dual} of the element. \\ 
    
    Example. Consider a 3D Euclidean space. Let there be an orientated plane, that is presented by the exteriour product $\wedge$, of two basis vectors. Then its Hodge dual is the normal vector biven by the cross product. \\
    The Hodge operator $\star$ is a one-to-one mapping of $k-$ to $(n-k)$-vectors.\\
    
    The $\star$ can be applied to the cotangent bundle of a pseudo-reimanian manifold -- to differential $k$-forms. This allows the definition of a differential as a Hodge adjoint of the exteior derivative. 
    
    Formal definition. Let $V$ be a $n$-dimensional vector space with nondegenerate symmetric bilinear form $\langle\cdot,\cdot\rangle$ -- the inner product. This induces an inner product on $k-$vectors $\alpha,\beta\in\Lambda^k V$ for $0\leq k \leq n$ by defining it on decomposable $k$-vectors $\alpha = \alpha_1\wedge\cdots\wedge\alpha_k$ and $\beta=\beta_1\wedge\cdots\wedge\beta_k$
    ...
    \\
    The Hodge star operator is a linear operator on the exterior algebra of $V$, mapping $k$-vectors to $(n-k)$-vectors for $0\leq k \leq n$. It has following property that defines it completely
    \begin{equation}
        \alpha\wedge(\star\beta) = \langle\alpha,\beta\rangle\omega 
    \end{equation}
    for every pair of $k-$vectors $\alpha\beta\in\Lambda^kV$ Here the $\omega\in\Lambda^nV$ is the unit $n-$vector defined in terms of an oriented orthonormal basis $\{e_1,...,e_n\}$ of $V$ as
    \begin{equation}
        \omega := e_1 \wedge \cdots \wedge e_n.
    \end{equation}
    
    Dually in the space $\Lambda^n V^*$ of $n-forms$, the dual $\omega$ is the colume form $\textbf{det}$, the function whose value on $v_1\wedge\cdots\wedge v_n$ is the determinant of the $n\times n$ matric assembled from the column vectors of $v_i$ in $e_i$ coordinates. Thus the dual difinition is 
    \begin{equation}
       \text{det}(\alpha\wedge\star\beta) = \langle\alpha,\beta\rangle.
    \end{equation}
    or ecvilalently 
    \begin{align}
        \alpha =& \alpha_1\wedge\cdots\wedge\alpha_k \\
        \beta =& \beta_1\wedge\cdots\wedge\beta_k \\
        \star\beta =& \beta_1 ^{\star} \wedge\cdots\wedge \beta_{n-k} ^ {\star} \\
        \text{det}(\alpha_1\wedge\cdots\wedge\alpha_k\wedge\beta_1 ^{\star}\wedge\cdots\wedge\beta_{n-k}^{\star}) =& \text{det}(\langle\alpha_i,\beta_j\rangle)
    \end{align}
    
    \textit{Geometrical interpetation.}  -- cannot understand
    \textit{Examples}
    Consider 2D with normalized Euclidian metric and orientation given by ordering $(x,y)$. The Hodge star on $k-$forms is given by 
    
    \begin{align}
        \star 1 &= dx \wedge dy \\
        \star dx &= dy \\
        \star dy &= -dx \\
        \star(dx \wedge dy) &= 1.
    \end{align}
    
    Consider a more complex example. A plane that can be regarded as a vector space with a standard sesquilinear form as the metric. There the Hodge operator has a properiy that it is invariant under the holomorphic cahges of cooridantes. Consider $z = x + iy$ holomorphic function of $w=u + iv$. Then in the new coordiantes 
    
    \begin{align}
        \alpha &= pdx +qdy \\
        \star \alpha &= -q dx + p dy
    \end{align}
    
    \textit{3D} \\
    Here the $\star$ can be regarded as a correspondence between vectors and bivectors. Thus in Eucledian $\boldsymbol{R}^3$ with basis $dx,dy,dz$, basis of oneforms one finds
    \begin{align}
        \star dx =& dy\wedge dz \\
        \star dy =& dz\wedge dx \\
        \star dz =& dx \wedge dy \\
    \end{align}
    The relation to the exteriour and cross producs are:
    \begin{equation}
        \star(\boldsymbol{u}\wedge\boldsymbol{v})=\boldsymbol{u}\times\boldsymbol{v}, \hspace{5mm}\star(\boldsymbol{u}\times\boldsymbol{v}) = \boldsymbol{u}\wedge\boldsymbol{v}
    \end{equation}
    Thus in 3D the $\star$ provides and isomorphism between vectors and bivectors, so each axial vector $\boldsymbol{a}$ is associated with the bivector $\boldsymbol{A}$ as $\boldsymbol{A} = \star\boldsymbol{a}$ and $\boldsymbol{a} = \star\boldsymbol{A}$. It can also mean a correspondance betweeen the axis and ifenitesicmal rotation around the axis with the speed equal to the length of the axis vector.
    %% One can see that mapping $\star:V\rightarrow\Lambda^2V\subset V\otimes V$
    Consider a tensor $dx \otimes dy$that correesponds to the matrix with one $dx$ row and $dy$ column. The wedge $dx\wedge dy = dx\otimes dy - dy\otimes dx$ is a 3 by 3 \textit{skew-symmetric matrix} with all 0 excet $01$ and $10$ components that are 1. So the $\wedge$ operator turns $\boldsymbol{v} = adx + bdy + cdz$ into $\star\boldsymbol{v}\approx$ 3x3 matrix with 0 on diaoganals. \\
    
    \textit{4D}\\
    Here $\star$ acts as an endomorphism of the second exteriour power, mapping 2-forms into 2-forms.Consider Minkowski space time with signature $(+---)$ and coordinates $(t,x,y,z)$
    
    \begin{align}
        \star dt &= dx \wedge dy \wedge dz \\
        \star dx &= dt \wedge dy \wedge dz \\
        \star dy &= -dt \wedge dx \wedge dz \\ 
        \star dz &= dt \wedge dx \wedge dy 
    \end{align}
    
    \textit{Wedge on manifold}
    For an $n-$dimensional oriented pseudo-Reimannian manifold $\mathcal{M}$ we apply the construction such that to each cotangent vector space $T^* _p \mathcal{M}$ and its exterior powers $\Lambda^k T_p ^* \mathcal{M}$and hence to all differential $k-$forms $\xi\in\Omega^k(\mathcal{M})=\Gamma(\Lambda^k T^* \mathcal{M})$, the global sections of the bundle $\Lambda^k T^*\mathcal{M}\rightarrow \mathcal{M}$. The Reimannian metric induces inner product on $\Lambda^k T_p ^* \mathcal{M}$ at each point $p\in\mathcal{M}$. We define the Hodge dual of a $k-$form $\xi$ defining $\star\xi$ as a unique $(n-k)$-form satisfying
    \begin{equation}
        \eta\wedge\star\xi = \langle\eta,\xi\rangle\omega
    \end{equation}
    for every $k-$form $\eta$ where $\langle\eta,\xi\rangle$ is a real value function on $\mathcal{M}$ and the volume form $\omega$ is induced by the Reimannian metric.
    
    \textit{In coordiante form}
    Consider an orthonormal basis $\{ \frac{\partial}{\partial x_1}, \cdots,\frac{\partial}{\partial x_n} \}$ the a tangent space $V=T_p\mathcal{M}$. And its dual basis $\{ dx_1, ..., dx_n \}$ in $V^* = T_p ^*\mathcal{M}$, with the metric matrix $g_{ij} = \big(\langle\frac{\partial}{\partial x_i},\frac{\partial}{\partial x_j}\rangle\big)$ and its inverse matrix $g^{ij} = \big(\langle dx_i, dx_j \rangle\big)$. The Hodge dual of a decomposable $k$-form is them 
    \begin{equation}
        \star(dx^{i_1}\wedge\cdots\wedge dx^{i_k}) = \frac{\sqrt{|\text{det}[g_{ab}]|}}{(n-k)!}g^{i_1 j_1}\cdots g^{i_k j_k} \epsilon_{j_1 ... j_n} dx^{j_{k+1}}\wedge\cdots\wedge dx^{j_n}
    \end{equation}
    
\end{sidenote}

\section{The Cauchy Problem in General Relativity}

In this section we briefly recall the initial-value formulation of the Einstein equations of general relativity through the following steps. We start by introducing notations and the basics of GR. We summarize the Einstein field equations. Then we continue with how EFE can be split in a set of evolutionary equations and constraints. For that we focus on the Arnowitt, Deser and Misner, or ADM, formalism. In the end we comment on the stability of the ADM equations, on the need for strongly-hyperbolic formulations of the EFE, and on the choice of gauge conditions commonly used to
evolve spacetimes with singularities. This overview is based in \cite{Arnowitt:1962hi,Landau:1982dva,Wald:1984,Misner:1973,Baumgarte:2002jm}, which we refer to for more detained discussion.

\subsection{Euler-Lagrange equations}

We consider a spacetime defined by the real smooth manifold $\mathcal{M}$ and Lorentzian metric $\boldsymbol{g}$ on $\mathcal{M}$ of signature (-,+,+,+). The $\nabla$ denotes the affine connection associated w.ith $\boldsymbol{g}$, the Levi-Civita connection. \\
We use the convention that all Greek indices lie in $\{0, 1, 2, 3\}$ and Lower case Latin indices $\{1, 2, 3\}$. \\
The $\nabla\boldsymbol{T}$ denotes the covariant derivative of a tensor $\boldsymbol{T}$ and $\nabla_{\boldsymbol{u}}\boldsymbol{T}$ -- covariant derivative along a given vector field $\boldsymbol{u}$.\\
The scalar product of two vectors then 
\begin{equation}
    \boldsymbol{a}\cdot\boldsymbol{b}:=g_{\mu\nu}a^{\mu}b^{\nu}
\end{equation}
The action of a linear form on a vector however is represented as 
\begin{equation}
    \langle\boldsymbol{\omega},\boldsymbol{\upsilon}\rangle=\omega_{\mu}\upsilon^{\mu}
\end{equation}

Let the $\boldsymbol{\alpha}$ be the totally antisymmetric symbol that expresses through coordinates $x^{\mu}$ as
\begin{equation}
    \boldsymbol{\alpha} = dx^0 \wedge dx^1 \wedge dx^2 \wedge dx^3,
\end{equation}
where $\wedge$ denotes exterior product. Then, proper volume pseudo-form of the spacetime is

\begin{equation}
    \boldsymbol{\varepsilon} = \sqrt{-g}\boldsymbol{\alpha},
\end{equation}
where $g$ denotes the determinant of the spacetime metric. \\

In GR, the spacetime is represented by Lorentzian manifold $\mathcal{M}$ and $g$, the Loretzian metric. \\

The action principle of the Lagrangian field theory on the spacetime $(\mathcal{M}; \boldsymbol{g})$ is
\begin{equation}
    S(\boldsymbol{q}, \nabla\boldsymbol{q}) = \int_{\mathcal{M}}\boldsymbol{\alpha}\mathcal{L}(\boldsymbol{q}, \nabla\boldsymbol{q}),
\end{equation}
where $\boldsymbol{q}$ are a set of generalized coordinates for the fields described by the theory, $\nabla$ is the Levi-Civita connection, $\mathcal{L}$ is a scalar density of a scalar quantity $\lambda$ as $\lambda(\boldsymbol{q},\nabla\boldsymbol{q})$. 

Varying the action with respect to the $\boldsymbol{q}$
\begin{equation}
    \delta S(\boldsymbol{q}, \nabla\boldsymbol{q}) = \delta\int\boldsymbol{\alpha}\mathcal{L}(\boldsymbol{q}, \nabla\boldsymbol{q}) = \int\boldsymbol{\alpha}\Big(\frac{\partial\mathcal{L}}{\partial\boldsymbol{q}}\delta\boldsymbol{q}+\frac{\partial\mathcal{L}}{\partial(\nabla\boldsymbol{q})}\delta\nabla\boldsymbol{q}\Big)
\end{equation}

As $\delta$ and $\nabla$ commute, and partially integrating $\nabla$, we obtain

\begin{equation}
    \partial S(\boldsymbol{q}, \nabla\boldsymbol{q}) = \int\boldsymbol{\alpha}\Big(\frac{\mathcal{L}}{\partial\boldsymbol{q}}-\nabla\frac{\partial \mathcal{L}}{\partial(\nabla\boldsymbol{q})}\Big)\delta\boldsymbol{q} + \int_{\mathcal{M}}\boldsymbol{\alpha}\nabla\Big(\frac{\partial\mathcal{L}}{\partial(\nabla\boldsymbol{q})}\delta\boldsymbol{q}\Big)
\end{equation}

The last term is a boundary term and in order to vanish we impose boundary condition. Assume that the fields are defined over only a compact domain. \\
As the choice of $\partial\boldsymbol{q}$ is arbitrary, the 

\begin{equation}
    \partial S(\boldsymbol{q}, \nabla\boldsymbol{q}) = 0
\end{equation}

and the Euler-Lagrange equations are

\begin{equation}
    \frac{\partial \mathcal{L}}{\partial\boldsymbol{q}} - \nabla\Big(\frac{\partial\mathcal{L}}{\partial(\nabla\boldsymbol{q})}\Big) = 0
    \label{eq:theory:eulerlagrange}
\end{equation}

%% ----------------------------------------------- 
\subsection{The Hilbert Action}

The Einsteinâ€“Hilbert action allows to obtain an Einstein field equations through ad principle of least action. Here we briefly underline the procedure.

Introduce action that describes the graviatational field, and a matter field $\mathcal{L}_m$:
\begin{align}
    S_g &= \int\frac{1}{2\kappa}R\epsilon, \\
    S_m &= \int\mathcal{L}_{m}\epsilon,
\end{align}
where $R$ is the Ricci scalar and $\kappa$ is the  Einstein's constant. \\

The full action then:
\begin{equation}
    S = \int\Big(\frac{1}{2\kappa}R+\mathcal{L}_m\Big)\epsilon
\end{equation}

The action principle dicatates, that $\delta S = 0$  with respect to the inverse metric $g^{\mu\nu}$. 

\begin{equation}
    \int\Bigg[\frac{1}{2\kappa}\Big(\frac{\delta R}{\delta g^{\mu\nu}}+\frac{R}{\sqrt{-g}}\frac{\delta\sqrt{-g}}{\delta g^{\mu\nu}}\Big) + \frac{1}{\sqrt{-g}}\frac{\delta(\sqrt{-g}\mathcal{L}_m)}{\delta g^{\mu\nu}}\Bigg]\delta g^{\mu\nu}\epsilon
\end{equation}

Owing to the arbitrariness of $\delta g^{\mu\nu}$, the integrant must be zero. 

\begin{equation}
    \frac{\delta R}{\delta g^{\mu\nu}} + \frac{R}{\sqrt{-g}}\frac{\delta\sqrt{-g}}{\delta g^{\mu\nu}} = -2\kappa\frac{1}{\sqrt{-g}}\frac{\delta(\sqrt{-g}\mathcal{L}_m)}{\delta g^{\mu\nu}} = -\frac{2\kappa}{\sqrt{-g}}\frac{\delta S_m}{\delta g_{\mu\nu}} := \kappa T_{\mu\nu},
    \label{eq:theory:action1}
\end{equation}
where we introduced the stress-energy tensor $T_{\mu\nu}$ and te matter action $S_m$ for future use. \\

\todo{this matter action is used in deriving the $T_{\mu} ^{\nu}$ i the invariant fluid formalisn}

The continuation of this deriviation requires taking variation of the Riccia scalar $R$ and the determinantof the metric $\sqrt{-g}$. As this is a length procedure, we provide here the result. 

\begin{equation}
    \frac{\delta R}{\delta g^{\mu\nu}} = R_{\mu\nu},
    \label{eq:theory:deltaR}
\end{equation}
where the $R_{\mu\nu}$ is the Ricci curvature tensor.

\begin{equation}
    \frac{1}{\sqrt{-g}}\frac{\delta\sqrt{-g}}{\delta g^{\mu\nu}} = -\frac{1}{2}g_{\mu\nu}.
    \label{eq:theory:deltagmuny}
\end{equation}

Substituting Eq. \ref{eq:theory:deltaR} and Eq. \ref{eq:theory:deltagmuny} into equation of motion Eq.  \ref{eq:theory:action1} we obtain the Einstein's field equation 

\begin{equation}
    R_{\mu\nu} -\frac{1}{2}g_{\mu\nu}R=8\pi T_{\mu\nu},
    \label{eq:theory:EFE}
\end{equation}
where in the geometrized unit system, \textit{i.e} $c=G=1$, the $\kappa=8\pi$.

%% ----------------
\subsection{3+1 Decomposition of Einstein field equations}

The Einstein field equations (\ref{eq:theory:EFE}) represent a set of 10 non-linear partial differential equations. These equations can be defeined on a while metric $\mathcal{M}$ or a domain $\Omega\subset\mathcal{M}$, where in the latter, the boundary conditions on $\partial\Omega$ are required. \\
It is convenient to chose a null hyersurface $\Sigma\subset\mathcal{M}$ on which to define the initial data, from which the evolution of space-time begins. This, however, requires the spacetime to be strongly hyperbolic, meaning that the foliation $\mathcal{M}=\Sigma\times\mathbb{R}$ is allowed. This foliation can be understood as splitting the spacetime into a set of spacelike hypersurfaces $\Sigma_t$. 


\subsubsection{Spacelike Foliations}
Let the $t$ be the global smooth functions such that, 

\begin{equation}
    \Sigma_{\tau} = \{x^{\alpha}\in\mathcal{M}: t(x^{\alpha})=\tau\},
\end{equation}

and let $\vec{t}$ be a vector such that $\langle\nabla t, \vec{t}\rangle = 1$. This the $t$ can be seen as a "function that advances time" and $\vec{t}$ as a "flow of time" vector field. Continuing the analogy, the rate at which a given tensor quantity $\boldsymbol{q}$ changes between hypersurfaces $\Sigma_t$ is given by the Lie derivative of the $\boldsymbol{q}$ along the vector $\vec{t}$. \\

Consider two hypersurfaces $\Sigma_t$ and $\Sigma_{t+dt}$. A transition from one to another can be decomposed into the part tangent to the hypersurface $\Sigma_{t+dt}$ and expressed in a form of a vector $\vec{\beta}$ and a pert normal to the hypersurface $\Sigma_t$ and expressed as a $\alpha \vec{n}$, where $\vec{n}$ is a unit vector, normal to the $\Sigma_t$ in the diretion to $\Sigma_{t+dt}$. Then, the vector $\vec{t}$ can be written as 

\begin{equation}
    \vec{t} = \alpha\vec{n}+\vec{\beta}.
\end{equation}

$\vec{\beta}$ is called shift vector and $\alpha$ is called lapse-function. \\

The spacetime metric $\boldsymbol{g}$ can be decomposed into a spatial, Riemannian metric $\boldsymbol{\gamma}$  as $\boldsymbol{\gamma} = \boldsymbol{g} + \underline{n} \otimes \underline{n} $, where $\underline{n}$ is the 1-form associated to the vector $\vec{n}$. The Levi-Civita connection can be computed by projecting the $\nabla$ on the space tangent to the hypersurface $\Sigma_t$.

There are exist coordinates that are adapted to the foliation, namely $\{t, x^i\}$ with $\vec{\partial}_i\cdot \vec{n} = 0$. In these coordiantes the $\nabla t = dt$ and $\vec{t} = \vec{\partial}_t$. 

The connection between $\boldsymbol{g}$ and $\boldsymbol{\gamma}$ is $g_{\mu\nu}=\vec{\partial}_{\mu}\cdot\vec{\partial}_{\nu} $ and can be expressed in terms of $\alpha$ and $\vec{\beta}$ as

\begin{align}
    \text{spatial components: } g_{ik}&=\vec{\partial}_{i}\cdot\vec{\partial}_{j} =\gamma_{ik}, \\
    \text{time component: } g_{tt} &= \vec{\partial}_{t}\cdot\vec{\partial}_{t} = \vec{t}\cdot\vec{t} = - (\alpha^2-\vec{\beta}\cdot\vec{\beta}), \\
    \text{mixed components: } g_{ti} &= \vec{\partial}_{t}\cdot\vec{\partial}_{i} = \vec{t}\cdot\vec{\partial}_i = (\alpha\vec{n}+\vec{\beta})\cdot\vec{\partial}_i=\beta_i,
\end{align}
we we made use of $\vec{\beta}$ being the spatial vector, \textit{i.e} $\vec{\beta}\cdot\vec{\beta}=\gamma_{ik}\beta^i\beta^k$.

The line-element can be thus written as
\begin{equation}
    ds^2 = -(\alpha^2-\beta_i\beta^i)dt^2 +2\beta_i dx^i dt + \gamma_{ik} dx^i dx^k.
\end{equation}

\subsubsection{Ex-curse: Hamiltonian Field Theory}

First we recall the generalized coordinates $\boldsymbol{q}$ and their covariant derivatives $\nabla\boldsymbol{q}$. \\
In light of the spacetime decomposition discussed above, we divide the $\boldsymbol{\alpha}$ into the time $dt$ and spatial parts represented by the antisymmetric symbol ${^{(3)}\boldsymbol{\alpha}}$ as 

\begin{equation}
    \boldsymbol{\alpha} = dx^0 \wedge dx^1 \wedge dx^2 \wedge dx^3 = dt \wedge {^{(3)}\boldsymbol{\alpha}}.
\end{equation}

Next, we introduce the "time derivative" as a Lie derivative along the vector field $\vec{t}$ as 

\begin{equation}
    \dot{\boldsymbol{q}} := \mathcal{L}_{\vec{t}}\boldsymbol{q}.
\end{equation}

As the $\Lambda(\boldsymbol{q}, \nabla\boldsymbol{q})$ is the Lagrangian density, a conjugate momentum can be defined as 

\begin{equation}
    \boldsymbol{p} := \frac{\partial\Lambda}{\partial\dot{\boldsymbol{q}}},
\end{equation}

Assuming that $\boldsymbol{p}$ and $\nabla\boldsymbol{q}$ can be expressed as a function of $\boldsymbol{q}$ and $\boldsymbol{p}$, inspired by the Legendre transformation, we define the Hamiltonian and its density density as

\begin{align}
    \mathcal{H} &= \boldsymbol{p}\cdot\dot{\boldsymbol{q}} - \mathcal{L}(\boldsymbol{q}, \nabla\boldsymbol{q}) \\
    H &= \int_{\Sigma}\mathcal{H}{^{(3)}\boldsymbol{\alpha}}
\end{align}

Additionally we define the quantity 

\begin{equation}
    J = \int_{0}^{t}H(\boldsymbol{q},\boldsymbol{p})dt = \int_{0}^{t}dt\int_{\Sigma}\mathcal{H}(\boldsymbol{q},\boldsymbol{p}){^{(3)}\boldsymbol{\alpha}} = \int_{0}^{t}dt\int_{\Sigma}{^{(3)}\boldsymbol{\alpha}}\Big(\boldsymbol{p}\cdot\dot{\boldsymbol{q}} - \mathcal{L}(\boldsymbol{q},\nabla\boldsymbol{q})\Big).
\end{equation}

Consider the variation of the $J$ with respect to the $\delta\boldsymbol{p}$ and $\delta\boldsymbol{q}$ as

\begin{equation}
    \delta J = \int_{0}^{t}\delta H(\boldsymbol{q},\boldsymbol{p})dt = \int_{0}^{t}dt (\dot{\boldsymbol{q}}\delta\boldsymbol{p}+\boldsymbol{p}\delta\dot{\boldsymbol{q}}) - \int_{0}^{t}dt\delta\Lambda(\boldsymbol{q}, \nabla\boldsymbol{q}).
\end{equation}

Consider the last term, the variation of the Lagrangian 

\begin{equation}
    \delta\Lambda = \int_{\Sigma}{^{(3)}\boldsymbol{\alpha}}\Bigg[\frac{\delta\Lambda}{\delta\dot{\boldsymbol{q}}}\delta\dot{\boldsymbol{q}}+\frac{\delta\Lambda}{\delta\boldsymbol{q}}\delta\boldsymbol{q}\Bigg],
\end{equation}

The first term in the square brackets can be reduced to $\boldsymbol{p}\delta\dot{\boldsymbol{q}}$, suingthe definition of the conjugate momentum. The second term can be treated, applying the Euler-Lagrange equations (\ref{eq:theory:eulerlagrange}). These manipulations result in

\begin{equation}
    \delta\Lambda = \int_{0}^{t}dt\int_{\Sigma}{^{(3)}\boldsymbol{\alpha}}(\boldsymbol{p}\delta\dot{\boldsymbol{q}} + \dot{\boldsymbol{p}}\delta\boldsymbol{q}).
\end{equation}

Thus we obtain that 

\begin{equation}
    \int_{0}^{t} \delta H(\boldsymbol{q},\boldsymbol{p})dt =   \int_{0}^{t}dt\int_{\Sigma}{^{(3)}\boldsymbol{\alpha}}(\dot{\boldsymbol{q}}\cdot\delta\boldsymbol{p}-\dot{\boldsymbol{p}}\cdot\delta\boldsymbol{q}),
\end{equation}

and as $\delta\boldsymbol{p}$ and $\delta\boldsymbol{p}$ are arbitrary, the Hamilton equations read

\begin{equation}
    \dot{\boldsymbol{q}}=\frac{\delta H}{\delta\boldsymbol{p}}, \hspace{5mm} \dot{\boldsymbol{p}} = -\frac{\delta H}{\delta\boldsymbol{q}}.
    \label{eq:theory:hamiltoneqs}
\end{equation}

The Hamiltonian formalism can be used to redirive the field-equations in a from that once the initial data is specified on a hypersurface $\Sigma_0$ for $\boldsymbol{q}$ and $\boldsymbol{p}$, the equations (\ref{eq:theory:hamiltoneqs}) would govern whole the evolution.


\subsubsection{Extrinsic Curvature and Constraint equations}

We define the \textit{extrinsic curvature} of a $D-1$-suface $\Sigma_t\subset\mathcal{M}$ at a point $\mathcal{P}\in\Sigma_t$ as mapping $\boldsymbol{K}$ such that $\boldsymbol{K}(\boldsymbol{\upsilon})=-\nabla_{\boldsymbol{\upsilon}}\boldsymbol{n}$. Note, that the $\boldsymbol{K}$ thus does not depend on $\alpha$ and $\vec{\beta}$, it is a purely spatial tensor. The components of the extrinsic curvature are \\

\begin{equation}
    K_{\mu\nu} = -{\gamma^{\alpha}}_{\mu}\nabla_{\boldsymbol{u}}^{\alpha} n_{\nu} = -\frac{1}{2}\mathcal{L}_{\vec{n}}\gamma_{\mu\nu},
    \label{eq:theory:extrcurvdef}
\end{equation}
where $\mathcal{L}_{\vec{n}}$ is the Lie derivative along the vector field $\vec{n}$. \\
From the (\ref{eq:theory:extrcurvdef}) the extrinsic curvature can be interprated as a "speed of the $\vec{n}$ during the parallel transport along the hypersurface $\Sigma_t$".

Codazzi equations relate the $4D$ Ricci tensor to the extrinsic curvature as

\begin{equation}
    D_{\beta}K-D_{\alpha}{K^{\alpha}}_{\beta}=R_{\gamma\delta}n^{\delta}{\gamma^{\gamma}}_{\beta},
    \label{eq:theory:formomentum}
\end{equation}

here $K$ is a trace of the tensor $\boldsymbol{K}$. \\

Gauss equation realtes the $3D$ Riemann tensor $^3{R_{\alpha\beta\gamma}}^{\delta}$ to the $4D$ one and the $\boldsymbol{K}$ as

\begin{equation}
    ^3{R_{\alpha\beta\gamma}}^{\delta} = {\gamma^{\mu}}_{\alpha}{\gamma^{\nu}}_{\beta}{\gamma^{\lambda}}_{\gamma}{\gamma^{\delta}}_{\sigma}{R_{\mu\nu\lambda}}^{\delta}-K_{\alpha\gamma}{K_{\beta}}^{\delta}+K_{\beta\gamma}{K^{\delta}}_{\alpha}.
    \label{eq:theory:forhamiltconst}
\end{equation}

The \textit{momentum constraint} thus cab be obtained by substituting the (\ref{eq:theory:EFE}) into  (\ref{eq:theory:formomentum}) which yields

\begin{equation}
    D_{\beta}K-D_{\alpha}{K^{\alpha}}_{\beta} = -8\pi{\gamma^{\alpha}}_{\beta} n^{\gamma}T_{\alpha\gamma}=:8\pi j_{\beta},
    \label{eq:theory:momconstraint}
\end{equation}
where $j^{\alpha}$ is the ADM momentum density. \\

The \textit{Hamiltonian constrant} can be obtained by substituting EFE (\ref{eq:theory:EFE}) into the (\ref{eq:theory:forhamiltconst}), yielding 

\begin{equation}
    ^3 R+ K^2 - K_{\alpha\beta}K^{\alpha\beta} = 2G^{\alpha\beta}n_{\alpha}n_{\beta} = 16\pi n_{\alpha}n_{\beta} T^{\alpha\beta} =: 16\pi E,
    \label{eq:theory:hamilconstraint}
\end{equation}
where $E$ is the ADM energy density. \\

The obtained constraint equations represent a set of elliptic equations that must be satisfied on every hyprsurface $\Sigma_i$ of the foliation. It is however, possible to show that Eistein equations preserve the constraints, meaning that if they are satisfied at the initial slice $\Sigma_0$ they will be satisfied at any time in the future. 





\subsubsection{The Hamiltonian Formulation of the Einstein Equations}

Here we briefly sketch to path of derivation of the Einstein field equations in the Hamiltonian framework. We will elude most of the intimidate and computationally extensive steps, as well as derivation of the boundary terms. For this we refer to \cite{Poisson:2004}.\\
First it is useful to note that determinant of the three-metric $\sqrt{\gamma}$ can be expressed as $\sqrt{\gamma}=\sqrt{-g}/\alpha$. The $p$ is the trace of the canonical momentum $\boldsymbol{p}$.

Now, consider the scalar curvature, R

\begin{align}
    G_{\mu\nu} &= R_{\mu\nu} - \frac{1}{2}Rg_{\mu\nu} \\
    -Rg_{\mu\nu}n^{\nu}n^{\mu} &= 2(G_{\mu\nu} n^{\nu}n^{\mu}-R_{\mu\nu}n^{\mu}n^{\mu})\\
    -Rn_{\mu}n^{\mu}& = 2(G_{\mu\nu}n^{\nu}n^{\mu} - R_{\mu\nu}n^{\mu}n^{\mu}) \\
    R &= 2(G_{\mu\nu}n^{\mu}n^{\nu} - R_{\mu\nu}n^{\mu}n^{\nu}).
\end{align}

From the Gauss-Codacci equation (\ref{eq:theory:momconstraint}), which relates the spatial curvature $^{(3)}R$ to the spacetime curvature $R$, we have the following constraint
relationship

\begin{equation}
    2G_{\mu\nu}n^{\mu}n^{\nu} = {^{(3)}R} + K^2 - K_{\mu\nu}K^{\mu\nu}.
\end{equation}

The $R_{\mu\nu}n^{\mu}n^{\nu})$ can be expressed as a combination of extrinsic curvature and total divergences as 

From the definition of the Ricci tensor $R_{\mu\nu}$, we have:

\begin{align}
    R_{\mu\nu} &= {R_{\mu\gamma\nu}}^{\gamma} \\
    R_{\mu\nu}n^{\mu}n^{\nu} &= {R_{\mu\gamma\nu}}^{\gamma} \\
    &= -(\nabla_{\mu}\nabla_{\gamma} - \nabla_{\gamma}\nabla_{\mu})n^{\gamma}n^{\nu} \\
    &= n^{\mu}(\nabla_{\mu}\nabla_{\gamma} - \nabla_{\gamma}\nabla_{\nu})n^{\gamma} \\
    &= (\nabla_{\mu}n^{\mu})(\nabla_{\gamma}n^{\gamma}) - \nabla_{\mu}(n^{\mu}\nabla_{\gamma}n^{\gamma}) - (\nabla_{\gamma}n^{\mu})(\nabla_{\mu}n^{\gamma}) + \nabla_{\gamma}(n^{\mu}\nabla_{\mu}n^{\gamma}) \\
    &= K^2 - K_{\mu\gamma}K^{\mu\gamma} - \nabla_{\mu}(n^{\mu}\nabla_{\gamma}n^{\gamma}) + \nabla_{\gamma}(n^{\mu}\nabla_{\mu}n^{\gamma})
\end{align}

In case of variations with compact support, that we are interested in, the total divergences. last two terms, can be neglected. Then the result is

\begin{equation}
    R_{\mu\nu}n^{\mu}n^{\nu}= K^2 - K_{\mu\nu}K^{\mu\nu}.
    \label{eq:theory:rmunu_as_func_k}
\end{equation}

Using the fact that $\sqrt{\gamma}=\sqrt{-g}/\alpha$ and the (\ref{eq:theory:rmunu_as_func_k}) we obtain the Lagrangian density in terms of the variables of the hypersurface:

\begin{align}
    \Lambda &= \sqrt{-g}R \\
    &= \alpha\sqrt{\gamma}R \\
    &= 2\alpha\sqrt{\gamma}(G_{\mu\nu}n^{\mu}n^{\nu} - R_{\mu\nu}n^{\mu}n^{\nu})\\ 
    &= 2\alpha\sqrt{\gamma}\Big(\frac{1}{2}[{^{(3)}R} - K_{\mu\nu}K^{\mu\nu} + K^2] - K^2 - K_{\mu\nu}K^{\mu\nu}\Big)
\end{align}

Together with the contribution from matter fields, we obtain

\begin{equation}
    \Lambda = \Lambda_g+\Lambda_m= \frac{1}{16\pi}\alpha({^{(3)}R} + K_{\mu\nu}K^{\mu\nu} - K^2)\sqrt{\gamma}+\Lambda_m
\end{equation}

Next we note that the extrinsic curvature of a
surface $\Sigma$ is defined as $K_{\mu\nu} = \nabla_{\mu}n_{\nu}$. \\
To relate $K_{\mu\nu}$ to the metric, we make use of the following property of Lie derivatives:

\begin{align}
    \mathcal{L}_{\vec{n}}g_{\mu\nu} &= n^{\gamma}\nabla_{\gamma}g_{\mu\nu} + g_{\gamma\nu}\nabla_{\mu}\upsilon^{\gamma} + g_{\mu\gamma}\nabla_{\nu}\upsilon^{\gamma} \\
    &= \nabla_{\mu}n_{\nu}+\nabla_{\nu}\upsilon_{\nu} \\
    &=2\nabla_{\mu}n_{\nu}
\end{align}

where the second line holds when $\nabla_{\gamma}\mu$ is the natural derivative operator corresponding to the metric $g_{\mu\nu}$ and the third line holds because $K_{\mu\nu}$ is symmetric.

Substituting this into our definition of $K_{\mu\nu}$,

\begin{align}
    K_{\mu\nu} &= -\frac{1}{2}\mathcal{L}_{\vec{\vec{n}}}g_{\mu\nu} \\
    &= -\frac{1}{2}\mathcal{L}_{\vec{\vec{n}}}(\gamma_{\mu\nu}-n_{\mu}n_{\nu}) \\
    &= -\frac{1}{2}\mathcal{L}_{\vec{\vec{n}}}\gamma_{\mu\nu} \\
    &= -\frac{1}{2}[n^{\gamma}\nabla_{\gamma}\gamma_{\mu\nu} + \gamma_{\gamma\nu}\nabla_{\mu}\upsilon^{\nu} + h_{\mu\gamma}\nabla_{\nu}\upsilon^{\gamma}] \\
    &= -\frac{1}{2\alpha}[\alpha n^{\gamma}\nabla_{\gamma}\gamma_{\mu\nu} + \gamma_{\gamma\nu}\nabla_{\mu}\alpha\upsilon^{\nu} + h_{\mu\gamma}\nabla_{\nu}\alpha\upsilon^{\gamma}] \\
    &= -\frac{1}{2\alpha}{\gamma_{\mu}}^{\gamma}{\gamma_{\nu}}^{\delta}[\mathcal{L}_{\vec{t}}\gamma_{\gamma\delta}-\mathcal{L}_{\vec{\beta}}\gamma_{\gamma\delta}] \\
    &= -\frac{1}{2\alpha}{\gamma_{\mu}}^{\gamma}{\gamma_{\nu}}^{\delta}[\partial_t\gamma_{\mu\nu}-D_{\mu}\beta_{\nu}-D_{\nu}\beta_{\mu}]
\end{align}

and on the hypersurface $\Sigma$ the projection operators are not needed. So we obtain

\begin{equation}
    K_{\mu\nu} = -\frac{1}{2}\mathcal{L}_{\vec{n}}\gamma_{\mu\nu}=-\frac{1}{2\alpha}(\partial_t\gamma_{\mu\nu}-D_{\mu}\beta_{\nu}-D_{\nu}\beta_{\mu})
\end{equation}

which us to express the canonical momentum $p^{\mu\nu}$ as

\begin{align}
    p^{\mu\nu} &= \frac{\partial\Lambda}{\partial\dot{\gamma}_{\mu\nu}} \\
    &= -\frac{\sqrt{\gamma}}{16\pi}\alpha\Bigg[\frac{\partial {^{(3)}R}}{\partial\dot{\gamma}_{\mu\nu}} + \frac{\partial(K_{\mu\nu}K^{\mu\nu})}{\partial\dot{\gamma}_{\mu\nu}} - \frac{\partial K^2}{\partial\dot{\gamma}_{\mu\nu}}\Bigg] \\
    &= \frac{\sqrt{\gamma}}{16\pi}(K\gamma^{\mu\nu} - K^{\mu\nu}),
\end{align}
where 
\begin{equation}
    \frac{\partial K_{\mu\nu}}{\partial \dot{\gamma}_{\mu\nu}} = \frac{1}{2\alpha}, \hspace{5mm} \frac{\partial {^{(3)}R}}{\partial \dot{\gamma}_{\mu\nu}} = 0, \hspace{5mm}\frac{\partial K^2}{\partial \dot{\gamma}_{\mu\nu}} = \frac{\gamma^{\mu\nu}K}{\alpha}
\end{equation}

assuming that there is no explicit dependency of the $\Lambda$ on $dot{\gamma}_{\mu\nu}$.

Since, $\alpha$ and $\vec{\beta}$ are related to the the gauge freedom, as there are many ways manifold $\mathcal{M}$ can be split into hypersurfaces, the momenta associated with these function and vector is zero. 

Thus, the Hamiltonian density is

\begin{align}
    \mathcal{H} &= p^{\mu\nu}\dot{\gamma}_{\mu\nu} - \Lambda \\
    &= -\sqrt{\gamma}\alpha{^{(3)}R} + \frac{\alpha}{\sqrt{\gamma}}\Big[p^{\mu\nu}p_{\mu\nu}-\frac{1}{2}p^2\Big] + 2p^{\mu\nu} D_{\mu}\beta_{\mu} -\Lambda_m \\
%    &=  \frac{\sqrt{\gamma}}{16\pi}\Bigg\{\alpha\Big[-{^{(3)}R}+h^{-1}p^{\mu\nu}p_{\mu\nu}-\frac{1}{2}h^{-1}p^2\Big] - 2\beta_{\nu}\big[D_{\mu}(h^{-1/2}p^{\mu\nu})\big] + D_{\mu}(h^{-1/2}\beta_{\nu}p^{\mu\nu})\Bigg\} \\
    &= \frac{\sqrt{\gamma}}{16\pi}\Bigg\{\alpha\Big[ -{^{(3)}R} + \gamma^{-1}p^{\mu\nu}p_{\mu\nu}-\frac{1}{2}\gamma^{-1}p^2\Big] +  2\beta_{\nu}\Big[D_{\mu}(\gamma^{-1/2}p^{\mu\nu})\Big] - 2D_{\mu}(\gamma^{-1/2}\beta_{\nu}p^{\mu\nu}) \Bigg\} - \Lambda_m,
\end{align}
where we restored the correct $16\pi$ factor in the last line.

As the we consider variations with compact suppot, the last boundary term, can be neglected. \\

Now we consider the variation of the matter action $S_m$ with respect to the $\alpha$ and $\vec{\beta}$

\begin{align}
    \frac{\delta S_m}{\delta \alpha} &=-\alpha\frac{\delta S_m}{\delta g_{00}} = -\alpha\sqrt{-g}T^{00} = -\alpha^2\sqrt{\gamma}T^{00} = -\sqrt{\gamma}T^{\mu\nu}n_{\mu}n_{\nu} \\
    \frac{\delta S_m}{\delta \beta_{\mu}} &= \frac{\delta S_m}{\delta g_{\mu 0}} =\frac{1}{2}\sqrt{-g}T^{\mu 0} = -\frac{1}{2} \sqrt{\gamma}T^{\mu\nu}n_{\nu}.
\end{align}

As the variation of the Hamiltonian $H$ with respect to a quantity with vanishing canonical momentum is zero, we obtain two equations 

\begin{align}
    \frac{\delta H}{\delta \alpha} &= 0 = -{^{(3)}R} + \gamma^{-1}p^{\mu\nu}p_{\mu\nu}-\frac{1}{2}\gamma^{-1}p^2 + 16\pi T^{\mu\nu}n_{\mu}n_{\nu} \\
    \frac{\delta H}{\delta \beta_{\mu}} &= 0 = - D_{\mu}(\gamma^{-1/2}p^{\mu\nu}) + 8\pi{\gamma^{\mu}}_{\nu}n_{\gamma}T^{\nu\gamma}.
    \label{eq:theory:hamiltonianvariation}
\end{align}


Note, that the $\delta H / \delta\beta_{\mu}$ is actually a Frech\'et differential $dH$, $\delta \beta_{\mu}$, which is writes as
\begin{equation}
    \langle dH,\delta\beta \rangle = \delta\beta_{\mu}\big[-D_{\nu}(\gamma^{-1/2}p^{\mu\nu})+8\pi n_{\gamma}T^{\mu\nu}\big], 
\end{equation}
containing $\delta\beta_{\mu}$ which is spatial. Thus only the spatial part is being constrained in the equation above. To account for that the procector ${\gamma^{\mu}}_{\nu}$ is added to the $\delta H/\delta \beta_{\mu}$. \\

The pair of equations (\ref{eq:theory:hamiltonianvariation}) is in fact the constraint equations derived before, namely the (\ref{eq:theory:momconstraint}) and (\ref{eq:theory:hamilconstraint}), and as we now see, they are related to the coordinate freedom of $\mathcal{M}$ decomposition and a coodrinate freedom on hypersurfaces. \\

Proceeding with the Hamiltinan formalism we note that equation \ref{eq:theory:hamiltoneqs} leads to the evolution equations for the three-metric, assuming that $\Lambda$ explicitly does not depend on the momentum

\begin{equation}
    \dot{\gamma}_{\mu\nu} =\frac{\delta H}{\delta p^{\mu\nu}} = 2\gamma^{-1/2}\alpha\big(p_{\mu\nu}-\frac{1}{2}\gamma_{\mu\nu}p\big) - D_{\nu}\beta_{\mu}-D_{\mu}\beta_{\nu}
%    -2D_{(\mu}\beta_{\nu)},
    \label{eq:theory:_adm_metric_evo}
\end{equation}

The evolution equations for the canonical momentum can read

\begin{align}
    \dot{p}^{\mu\nu} = -\frac{\delta H}{\delta \gamma_{\mu\nu}} = &+ \alpha\gamma^{1/2}\big({^{(3)}R}^{\mu\nu}-\frac{1}{2}{^{(3)}R\gamma^{\mu\nu}}\big) \\
    & - \frac{1}{2}\alpha\gamma^{-1/2}\gamma^{\mu\nu}\big(p_{\gamma\delta}p^{\gamma\delta}-\frac{1}{2}p^2\big) \\
    & + 2\alpha\gamma^{-1/2}\big(p^{\mu\gamma}{p^{\nu}}_{\gamma}-\frac{1}{2}pp^{\mu\nu}\big) \\
    & - \gamma^{1/2}\big(D^{\mu}D^{\nu}\alpha-\gamma^{\mu\nu}D^{\gamma}D_{\gamma}\alpha\big) \\
    & - \gamma^{1/2}D_{\gamma}\big(\gamma^{-1/2}\beta^{\gamma}p^{\mu\nu}\big) \\
    &+ 2p^{\gamma(\mu}D_{\gamma}\beta^{\nu)} + 8\pi \alpha \gamma^{1/2}S^{\mu\nu},
    \label{eq:theory:_adm_mom_evo}
\end{align}
where $A_{(\mu\nu)} = 0.5(A_{\mu\nu}+A_{\nu\mu})$ the convention was used. \\

where $S^{\mu\nu}={\gamma^{\mu}}_{\alpha}{\gamma^{\nu}}_{\beta}T^{\alpha\beta}$. 
Taking the variation of the matter field we noted that 


\begin{equation}
    \frac{\delta S}{\delta \gamma_{ik}} = \frac{\delta S_m}{\delta g_{ik}} = \frac{1}{2}\sqrt{-g}T^{ik}
\end{equation}

The set of equations (\ref{eq:theory:hamiltonianvariation}), (\ref{eq:theory:_adm_metric_evo}) and (\ref{eq:theory:_adm_mom_evo}) comprise the ADM system. A more widely used from of these equations is in turns of $\gamma_{ij}$ and $K_{ij}$ that reads

\begin{align}
    (\partial_t - \mathcal{L}_{\vec{\beta}})\gamma_{ik} &= -2\alpha K_{ik}; \\
    (\partial_t - \mathcal{L}_{\vec{\beta}})K_{ik} &= -D_{i}D_{k}\alpha + \alpha\big(R_{ik} - 2K_{ij}{K^j}_k+KK_{ik}\big) - 8\pi\alpha\big(S_{ik} - \frac{1}{2}\gamma_{ik}(S-E)\big); \\
    {^{(3)}R} + K^2 - K_{ik}K^{ik} &= 16\pi E; \\
    D_{i}K-D_{k}{K^k}_i &= 8\pi j_i,
    \label{eq:theory:adm}
\end{align}
where $S = \gamma^{ij}S_{ij}$.
These equations constitute the IVP for Einstein field equations and are known as ADM equations. The last two equations are the constraint equations. They determine how to set the initial data on the hypersurface $\Sigma_0$, via prescribing the three-metric and extrinsic curvature. The first two equations then govern the evolution.

\todo{make sure that the coefficients in formuals are consistent, $16\pi$ might me missing or $-$}
\todo{Makse sure that $\Lambda$ stands for largangian density and $\mathcal{L}$ for lie derivative}

\subsubsection{Strongly Hyperbolic Formulations of the Einstein Equations}

It has been shown, that the ADM system of equations in its original form (\ref{eq:theory:adm}) is only weekly hyperbolic \cite{Baumgarte:2002jm}. It was shown that in such system the errors tend to couple with zero-velocity modes \cite{Alcubierre:1999rt}.  \\
In an attempt to mitigate this problem, different formulations of the Einstein equations as initial-value problem were created. In particular, the the generalized-harmonic formulation \cite{Friedrich:1985,Lindblom:2005qh,Lindblom:2009}, the BSSNOK formulation, derived by Baumgarte, Shapiro, Shibata, Nakamura, Oohara and Kojima \cite{Nakamura1987,Shibata:1995we,Baumgarte:1998te} and and the Z4 formulation \cite{Bona:2003fj,Bernuzzi:2009ex,Ruiz:2010qj,Weyhausen:2011cg,Alic:2011gg}. We do not attempt to elaborate on any of these formations and only aim to emphasize that a search for a new and better formulations of Einstein equations for numerical applications is ongoing. We limit ourselves to sketching only the conformal-covariant variant of the Z4 formulation, also known as Z4c. The numerical implementation of this formulation was used to obtain the results discussed in this thesis. 


\subsubsection*{The CCZ4 Formulation}

The idea behind the Z4 formulation is to derive a set of evolution equations that is free from the zero-speed modes of the original ADM and thus -- strongly-hyperbolic. This is achieved by not explicitly enforcing the constraints and treating the deviation from them as an dependent variable $Z_{\mu}$. The $Z_{\mu}$ is also called the Z4 four-vector.

One starts with the covariant Lagrangian
\begin{equation}
    \Lambda = g^{\mu\nu}[R_{\mu\nu} + 2\nabla_{\mu}Z_{\nu}]\sqrt{g} + \Lambda_m,
\end{equation}

and applying Palatini-type variational principle \cite{Bona:2010is}, obtains an evolution equations

\begin{equation}
    R_{\mu\nu} + \nabla_{\mu}Z_{\nu} + \nabla_{\nu}Z_{\mu}=8\pi\Big(T_{\mu\nu} - \frac{1}{2}Tg_{\mu\nu}\Big),
    \label{eq:theory:z4fieldeq}
\end{equation}

and two sets of constraint equations

\begin{equation}
    \nabla_{\rho} g^{\mu\nu} = 0, 
    \label{eq:theory:z4connect}
\end{equation}

and

\begin{equation}
    Z_{\mu} = 0,
\end{equation}

where the latter is called an algebraic constraint. If its derivative vanishes, it is equivalent to imposing the ADM momentum and Hamiltonian constraints \cite{Bona:2009}. 

The Einstein field equations themselves are recovered from (\ref{eq:theory:z4connect}) and (\ref{eq:theory:z4fieldeq}) when the algebraic constraint is satisfied. \\

The Z4 system preserves the constraint, $\partial_t (Z_{\mu})= 0$. This allows to obtain the solution of the Einstein equations. 

However, the numerical solution of the system of equations introduces error, that leads to a constraint violation during the evolution. To mitigate this problem the Z4 system is further modified to enforce the dampening of the constraint violation propagation \cite{Gundlach:2005eh}.

A new version of Z4 was recently introduced by \cite{Alic:2011gg}. It incorporates the constraint-damping properties of the original Z4 and also allows for a better black hole treatment via \textit{moving-puncture}, that will be discussed later. 
The CCZ4 system reads 

\begin{align}
    \partial_{t}\widetilde{\gamma}_{ij} = & -2\alpha\widetilde{A}_{ij}^{\text{TF}} + 2\widetilde{\gamma}_{k(i}\partial_{j)}\beta^k - \frac{2}{3}\widetilde{\gamma}_{ij}\partial_k \beta^k + \beta^k\partial_k\widetilde{\gamma}_{ij}, \\
    \partial_{t}\widetilde{A}_{ij}^{\text{TF}} = & \phi^2\big[-\nabla_i\nabla_j\alpha + \alpha\big({^{(3)}R}_{ij}+\nabla_{i}Z_{j} + \nabla_{j}Z_{i}- 8\pi S_{ij}\big)\big]^{\text{TF}} \\
    & + \alpha\widetilde{A}_{ij}(K-2\Theta)-2\alpha\widetilde{A}_{il}{\widetilde{A}^l}_{j} + 2\widetilde{A}_{k(i}\partial_{j)}\beta^{k} \\
    & -\frac{2}{3}\widetilde{A}_{ij}\partial_{k}\beta^{k} + \beta^{k}\partial_{k}\widetilde{A}_{ij} \\
    \partial_{t} \phi = & \frac{1}{3}\alpha\phi K - \frac{1}{3}\phi\partial_{k}\beta^{k} + \beta^{k}\partial_{k}\phi \\
    \partial_{t}K = &-\nabla^{i}\nabla_{i}\alpha + \alpha\big({^{(3)}R} + 2\nabla_{i}Z^{i} + K^2 - 2\Theta K\big) + \beta^{j}\partial_{j}K \\
    & - 3\alpha\kappa_1(1+\kappa_2)\Theta + 4\pi\alpha (S-3E) \\
    \partial_{t}\Theta = &\frac{1}{2}\alpha\Big(R + 2\nabla_{i}Z^{i} - \widetilde{A}_{ij}\widetilde{A}^{ij} + \frac{2}{3}K^2 - 2\Theta K\Big) - Z^{i}\partial_{i}\alpha \\
    & + \beta^{k}\partial_{k}\Theta - \alpha\kappa_1(2 + \kappa_2)\Theta - 8\pi\alpha E \\
    \partial_{t}\hat{\Gamma}^j = & 2\alpha\Bigg({\widetilde{\Gamma}^i}_{jk}\widetilde{A}^{ij} - 3\widetilde{A}^{ij}\frac{\partial_{j}\phi}{\phi} -\frac{2}{3}\widetilde{\gamma}^{ij}\partial_{j}K\Bigg) + 2\widetilde{\gamma}^{ki}\Big(\alpha\partial_{k}\Theta - \Theta\partial_{k}\alpha - \frac{2}{3}\alpha K Z_{k}\Big) \\
    & - 2\widetilde{A}^{ij}\partial_{j}\alpha + \widetilde{\gamma}^{kl}\partial_{k}\partial_{l}\beta^{i} + \frac{1}{3} \widetilde{\gamma}^{ik}\partial_{k}\partial_{l}\beta^{l} + \frac{2}{3}\widetilde{\Gamma}^i\partial_{k}\beta^{k} \\
    & - \widetilde{\Gamma}^k\partial_{k}\beta^{i} + 2\kappa_3\Big(\frac{2}{3}\widetilde{\gamma}^{ij}Z_{j}\partial_{k}\beta^{k} - \widetilde{\gamma}^{jk}Z_{j}\partial_{k}\beta^{i}\Big) + \beta^{k}\partial_{k}\hat{\Gamma}^i \\
    & -2\alpha\kappa_1\widetilde{\gamma}^{ij}Z_{j}- 16\pi\alpha\widetilde{\gamma}^{ij}S_j,
    \label{eq:theory:ccz4equations} % used for Whisky Code description
\end{align}

where $\Theta:=n_{\mu}Z^{\mu}=\alpha Z^0$, the $\widetilde{\Gamma}^i:=\widetilde{\gamma}^{jk}{\widetilde{\Gamma}^i}_{jk} = \widetilde{\gamma}^{ij}\widetilde{\gamma}^{kl}\partial_{l}\widetilde{\gamma}_{jk}$ and $\hat{\Gamma}:=\widetilde{\Gamma}^i + 2\widetilde{\gamma}^{ij}Z_j$, constants $\kappa_1$ and $\kappa_2$ are related to the constraint damping terms, the $\kappa_3$ is the additional constant for further adjustments, the The three-dimensional Ricci tensor ${^{(3)})R}_{ij}$ is split into conformal part $\widetilde{R_{ij}^{\phi}}$ and the $\widetilde{R_{ij}}$ that contains the derivatives of the conformal metric

\begin{align}
    \widetilde{R_{ij}} &= -\frac{1}{2}\widetilde{\gamma}^{lm}\partial_{l}\partial_{m}\widetilde{\gamma}_{ij} + \widetilde{\gamma}_{k(i}\partial_{j)}\widetilde{\Gamma}_{(ij)k} + \widetilde{\gamma}^{lm}\big[2\widetilde{\Gamma}^{k}_{l(i}\widetilde{\Gamma}_{j)km} + \widetilde{\Gamma}^{k}_{im}\widetilde{\Gamma}_{kjl}\big] \\
    \widetilde{R_{ij}}^{\phi} &= \frac{1}{\phi^2}\big[\phi\big(\widetilde{\nabla}_{i}\widetilde{\nabla}_{j}\phi + \widetilde{\gamma}_{ij}\widetilde{\nabla}^{l}\phi\widetilde{\nabla}_{l}\phi\big) - 2\widetilde{\gamma}_{ij}\widetilde{\nabla}^{l}\phi\widetilde{\nabla}_{l}\phi\big]
\end{align}

And as one sees, the ecolution of $Z_i$ is now included in $\hat{\Gamma}$. 
\todo{understand the conformal stuff and add some steps to show how the ccz4 was made}

\subsubsection{Gauge conditions}

During the discussion of the original ADM system, the choice of the lapse function, \textit{i.e} slicing condition, and shift vector \textit{i.e} spatial gauge condition was left open. The right choice however, is crutual for the stable evolution and in itself presents a broad and rapidly evolving subject. Here we are going to discuss only the gauge that is relevant for our work. 

\paragraph{Slicing condition} One of the widely used conditions is so called 'maximal slicing' that sets $K=0$, which in turn results in the equation

\begin{equation}
    D^{i}D_{i}\alpha = \alpha\big[K_{ij}K^{ij} + 4\pi(e+S)\big].
\end{equation}

This conditions has an advantage of being \textit{singularity-avoiding}. For example, it was shown that in the case of Schwarzschild black hole, the $\alpha$ goes to zero at a finite distance from singularity \cite{Geyer:1995}. However implementation of this condition in from of a elliptic equations is computationally expensive.   \\
A class of slicing conditions in form of hyperbolic equations that are more favorable from numerical standpoint and that reproduces the desired behavior of the maximal scicing was proposed in \cite{Bona:1994dr}. It is read 

\begin{equation}
(\partial_t - \beta^i\partial_i)\alpha = \alpha^2 f(\alpha)K
\label{eq:theory:gauge_onepluslog}
\end{equation}

which in CCZ4 reads 

\begin{equation}
    (\partial_t - \beta^i \partial_i )\alpha = \alpha^2 f(\alpha)(K-2\Theta)
\end{equation}

where $f(\alpha)$ is a positive function. For many numerical applications, including those that are discussed in this work, the "1 + log" slicing is adopted, the $\beta_i=0$. Then, integrating equation (\ref{eq:theory:gauge_onepluslog}) yields 

\begin{equation}
    \alpha = 1 + \log\gamma
\end{equation}

This condition is numerically more favorable and as $f\rightarrow\infty$ in the vicinity of a singularity, allows to treat black holes well like maximal slicing \cite{Baumgarte:2002jm}.

\todo{add/modify some text.}

\paragraph{Spatial gauge conditions}

The requirements for the gauge are similar as in the case of the $\alpha$, namely hyperbolicity and minimization of numerical distortions for more stable evolution.  

One of the widely used shift conditions is so called \textit{Gamma driver} condition \cite{Alcubierre:2002kk}, 

\begin{align}
    \partial_t\beta^i &= \frac{3}{4}\alpha B^i, \\
    \partial_t B^i &= \partial_t\widetilde{\Gamma}^i - \eta B^i,
\end{align}

where $\eta$ is a dumping coefficient. \\

This gauge condition tries to decrease the coordinate stretching that occur in the vicinity of a singularity. It was shown to be effective in numerical applications, in particular for a single moving black hole. However it has a zero-speed mode, that can amplify the numerical errors and destabilize the system \cite{vanMeter:2006vi}.

A modified \textit{Gamma driver}, gauge that does not have zero or small speed modes:

\begin{align}
    (\partial_t - \beta^j\partial_j)\beta^i &= \frac{3}{4}B^i \\
    (\partial_t - \beta^j\partial_j)B^i &= (\partial_t - \beta^j\partial_j)\widetilde{\Gamma}^i-\eta\beta^i,
\end{align}

was proposed by \cite{vanMeter:2006vi} and was applied to study binary black holes by \cite{Campanelli:2005dd}.

\subsection{The Equations of General-Relativistic Hydrodynamics}

In this section we discuss the equations of general relativistic hydrodynamics. We consider the fluid on a Lorentzian manifold and how its flow affects the spacetime. \\ 

The topics that we are going to touch are:
\begin{itemize}
    \item fluid kinematics,
    \item equations of motion for perfect fluids (assuming that there is no thermal conduction or viscosity)
    \item the â€œValencia formulationâ€ of the hydrodynamic equations.
\end{itemize}

We note that the following description is very brief and is based on the following works: \cite{Misner:1973},\cite{Schutz:2009a},\cite{Gourgoulhon:2006bn},\cite{Andersson:2006nr},\cite{Rezzolla:2013} to which we refer the reader for more details.  

\subsubsection{Kinematics of a Relativistic Fluid}

In Newtonian physics, a fluid is an "entity" whose dynamics is described by flows of quantities such as energy density, mass, momentum density. However, in general and special relativity, the these quantities are not well defined and depend on the observer. In other words, different observers perceive the the same fluid being in different thermodynamic state. Hence, a description of the fluid dynamics in relativity requires a new formulation, a formulation in which a fluid is not represented by a scalar and vector fields, that are observer-dependent, but implicitly by a "flow" in spacetime. These are \textit{flux-conservative formulations} of hydrodynamics.

Consider the classical mass density, a scalar $\rho$, usually defined as total umber of particles $N$ of rest-mass $m$ in the volume $V$. Then, the total mass is given by

\begin{equation}
    \int_V \rho \text{d}^3x = m\int_V n \text{d}^3 x = mN.
\end{equation}

However, while the number of particles $N$ would be the same regardless of the observer, the $\text{d}^3x$ would be measured differently by observers moving in relation to each other. Hence, the $n$ would differ. One of the solutions is to chose a frame of reference, say comoving with the fluid and define the $\rho$ there. However, this would hinder our ability to generalize to other reference frames.\\ A better soution is to construct a \textit{covariant description in terms of invariant quantities}. 
 
We start by defining the flow of the fluid density in space-time, the 3 pseudo-form $\boldsymbol{\rho}$ that on any three dimensional submanifold describes the flow of mass transverse to the submanifold as

\begin{equation}
    \int_{\Sigma} \boldsymbol{\rho},
\end{equation}

where $\Sigma$ be a spacelike hypersurface,  $\vec{n}$ -- the future-oriented normal vector. This is the density measured by an observer with 4-velocity $\vec{n}$. 

To define a mass flow measured by an Eulerian observer across any spacelike surface $\Omega\subset\Sigma$, we need to construct a two-form $\boldsymbol{\rho}(\vec{n}, \cdot, \cdot)$ given by the interior product between the 3 pseudo-form $\boldsymbol{\rho}$ and $\vec{n}$. Then the mass flow is 

\begin{equation}
\int_{\Omega} i_{\vec{n}}\boldsymbol{\rho}.
\end{equation}

The conservation of the number of particles of the fluid is expressed by the vanishing exterior product of the density form, i.e. $\text{d}\boldsymbol{\rho}=0$, or in an integral form 

\begin{equation}
\int_{\partial\Omega} \boldsymbol{\rho} = \int_{\Omega}\text{d}\boldsymbol{\rho} = 0,
\end{equation}

that reads as the following: the net flow across any sufficiently regular surface $\partial\Omega$ enclosing a four-dimensional open set $\Omega\subset\mathcal{M}$ is zero.

Next we define a flux. First, let us reintroduce the volume pseudo-form

\begin{equation}
\text{Vol}_x ^4 = \sqrt{-g}dx^0 \wedge dx^1 \wedge dx^2 \wedge dx^3,
\end{equation}

where $g$ is the determinant of the spacetime metric. \\
On a on the submanifold $\Sigma$, the intrinsic volume then would be defined as 

\begin{equation}
\text{Vol}_x ^3 = i_{\vec{n}} \text{Vol}_x ^4.
\end{equation}

A flux of a vector field can be described by a three-form, for which on a pseudo-Riemannian manifold there exist a vector field associated with it.

A vector field associated with density is called \textit{rest-mass density four-vector} and is denoted by $\vec{j}$.

It is constructed from the one-form by rasing indexes, $\vec{j} = {^{\#}\underline{j}}$. The one-form $\underline{j}$ is obtained as $\underline{j}\star\boldsymbol{\rho}$, where $\star$ is the Hodge dual operator (see \textit{e.g.,} \cite{Frankel:1982dva}). 

Then if the $\boldsymbol{\rho} = i_{\vec{j}}\text{Vol}_x ^4$ the flux of $\vec{j}$ can be shown as 

\begin{equation}
\int_{\Sigma} \boldsymbol{\rho} = - \int_{\Sigma}\vec{j}\cdot\vec{n}\text{Vol}_x ^3,
\end{equation}

where $\vec{n}$ is the future-oriented unit-timelike normal to $\Sigma$.


\textcolor{gray}{
[Direct copy... maybe not needed] More generally the flux associated with a flow defined by a vector field, $\vec{X}$, across a hypersurface, $\Sigma$, transverse to it and with normal $\vec{\nu}$ (with appropriate sign depending on the signature of the metric and on $\Sigma$), is given 
\begin{equation}
\int_{\Sigma} \star\underline{X} = \int_{\Sigma}i_{\vec{X}}\text{Vold}^n = \int_{\sigma}i_{\vec{X}}\big[\underline{\nu}\wedge\text{Vol}^{n-1}\big] = \int_{\Sigma}\vec{X}\cdot\vec{\nu}\text{Vol}^{n-1}
\label{eq:theory:flux_of_flow}
\end{equation}
}
\textcolor{red}{this piece is used in Liuille theorem though}

We note that $\vec{j}$ is time like (or null). It is given by the the flux of particles across any future-oriented spacelike hypersurface is positive (or zero). If $\vec{j}$ is timelike, there exists a unique decomposition 

\begin{equation}
\vec{j} = \rho \vec{u},
\label{eq:theory:defofjandu}
\end{equation}
where the scalar $\rho$ can be seen as density in the comoving frame and unit-timelike vector $\vec{u}$ as a fluid four-velocity.\\

The divergence of vecotor $j$ then gives a familiar mass conservation expression

\begin{equation}
0 = \nabla_{\mu}j^{\mu} = \frac{1}{\sqrt{-g}}\partial_{\mu}[\sqrt{-g}\rho u^{\mu}].
\label{eq:theory:nablamu_jmu}
\end{equation}

\textcolor{gray}{Similarly energy and momentum of a fluid can be defined, using the Cartan formalism... but this is a PAIN! and is done to show that div(T)=0 is not really energy/momentum conservation...}

Next, let us introduce the mixed tensor $\boldsymbol{T}$. Since the three-forms are equivalent to vectors, we can define a flow of the $\nu$ momentum across the volume element orthogonal to $dx^{\mu}$ as 

\begin{equation}
{T^{\mu}}_{\nu}=\boldsymbol{T}(dx^{\mu},\partial_{\nu}).
\end{equation}

${T^{\mu}}_{\nu}$ is the stress energy tensor that was already introduced earlier \ref{eq:theory:action1}. 

Note, that if the Einstein equation are satisfied the Bianchi identities dictate that the $\nabla_{\mu}{T^{\mu}}_{\nu}$ must vanish as

\begin{equation}
\nabla_{\mu}{T^{\mu}}_{\nu} = 0= \frac{1}{\sqrt{-g}}\partial_{\mu}(\sqrt{-g}{T^{\mu}}_{\nu}) - {\Gamma^{\alpha}}_{\mu\nu}{T^{\mu}}_{\alpha}.
\label{eq:theory:nablamu_tmunu}
\end{equation}

However, this statement does not imply the conservation of the energy and momentum of the fluid in a general sense. The conservation of the $\nu$-momentum requires $\vec{\partial}_{\nu}$ to be a Killing vector.


\todo{define somewhere an eulerian observer}

\subsubsection{Dynamics of a Relativistic Fluid}

In the previous subsection we have introduced the fluid kinematic, and defined the important quantities such as mass, energy and momentum and their "conservation" in \ref{eq:theory:nablamu_jmu} and \ref{eq:theory:nablamu_tmunu}.

In this thesis we consider only the \textit{perfect fluid}, meaning that in the co-moving frame, there is not heat conduction and there is no viscosity. \todo{actually we do have a viscous part -- you have to add this...}. The former criterion implies that the fluid is in local thermodynamic equilibrium (LTE). The latter however requires more explanation. There is still no consensus on the correct mathematical formulation, especially with respect to the numerical applications, of the viscous and/or thermally conducting fluids in general-relativity (see e.g., \cite{Andersson:2006nr} and references therein). \textcolor{blue}{however in recent youers there have been some progress GRELS models and David's implementation I must add!}. \\

Consider a stress-energy tensor of a perfect fluid in the comoving frame with the fluid. To construct it, we return to the fluid's four velocity $\vec{u}$ from (\ref{eq:theory:defofjandu}). If $e_{i}$ is the basis vector, the scalar product $\vec{u}\cdot\vec{e}_i=0$ and $\vec{e_i}\cdot\vec{e}_k = \delta_{ik}$. then the orthonormal tetrad $\{\vec{u},\vec{e}\}$ is comoving with the fluid, and the $\{\underline{u},\underline{e}^i\}$ is the dual basis. \\
Tensor $\boldsymbol{T}$ is the stress-energy tensor with the following components: 

\begin{itemize}
    \item $\boldsymbol{T}(\underline{u}, \vec{u})$ energy-density in the rest-frame of the fluid, the scalar $e$
    \item $\boldsymbol{T}(\underline{u}, \vec{e}_i) = 0$ represent the energy flowing transverse to the four-velocity, which we set to $0$ in the absence of the heat-conduction.
    \item $\boldsymbol{T}(\underline{e}^i, \vec{e}_k) = 0$ represent the $k$ component of the force exchanged across the surface element orthogonal to $\underline{e}_i$.
\end{itemize}

Taking into account that the $\boldsymbol{T}$ must be invariant with respect to the rotations of the $\{\vec{e}_i\}$ and that the viscosity is not included, force exchange can be effectively desibed by a scalar $p$, that we call pressure as

\begin{equation}
    \boldsymbol{T}(\underline{e}^i,\vec{e}_k) = p {\delta^i}_k,
\end{equation}

Combining the aforementioned description of the components of $\boldsymbol{T}$ we get

\begin{equation}
\boldsymbol{T} = (e + p)\vec{u}\otimes \underline{u} + p\boldsymbol{\delta}.
\end{equation}

Defining the enthalpy of the fluid as $h = 1 + \epsilon = p/\rho$, where $\epsilon$ is the specific internal energy, we rewrite $\boldsymbol{T}$ as 

\begin{equation}
\boldsymbol{T} = \rho h \vec{u}\otimes\underline{u} + p\boldsymbol{\delta}
\label{eq:theory:stressenergytensor}
\end{equation}

In addition to the fluid kinematics (eqs. \ref{eq:theory:nablamu_jmu} and \ref{eq:theory:nablamu_tmunu}) and the description of motion (eq. \ref{eq:theory:stressenergytensor}), the relation between the pressure, internal energy and density is needed to fully describe the dynamics of the fluid. This relation is usually called the equation of state.

The commonly adopted equations (EoS) of state are the the ideal-gas, or gamma-law EoS $\rho = (\Gamma-1)\rho\epsilon$, where $\Gamma$ is the polytropic index of the gas, the polytropic EoS $p = K\rho^{\Gamma}$ and the microphysical equation of state \todo{that you need to discuss more..., as we use only it.}

Combined with an EoS, equations \ref{eq:theory:adm}, \ref{eq:theory:nablamu_jmu}, \ref{eq:theory:nablamu_tmunu} and \ref{eq:theory:stressenergytensor} form a hyperbolic
system of equations that can be evolved, once initial data is prescribed. The complete evolution of spacetime and the dynamics of the matter requires initial data to be set on the Cauchy surface.

\subsubsection{Conservative Formulations}

In the pioneering works of May and White \cite{May:1966} and Wilson \cite{Wilson:1972} the equations of general relativistic hydrodynamics were solved using the finite-difference (FD) schemes after casting them a from of non-linear advection-like equations. To avoid excessive oscillations at shocks a combination of upwinding and artificial-viscosity methods was employed. This however led to severl limitations, such as difficulty with tunning the artificial viscosity to still allow shocks to develop, and the limit on a flows being only mildly relativistic \cite{Font:2008fka}. \\
A next big advancement in the numerical relativistic hydrodynamics was made after the non-conservative nature of the Wilsonâ€™s approach was pointed out \cite{Marti:1991wi} and the conservation formulation was developed. 

An important example of the conservation formulation that is adopted to $3 + 1$ formalism is the "Valencia formulation" \cite{Banyuls:1997} that can be represented as following

\begin{equation}
    \frac{\partial\boldsymbol{F}^{0}(\boldsymbol{u})}{\partial t} + \frac{\partial\boldsymbol{F}^{i}(\boldsymbol{u})}{\partial x^{i}} = \boldsymbol{S}(\boldsymbol{u})
    \label{eq:theory:valencia_formalism}
\end{equation}

where $u$ is a â€œvectorâ€ of \textit{primitive quantities}, such as the rest-mass density or the specific internal energy, $\boldsymbol{F}^0$ is a â€œvectorâ€ of \textit{conserved quantities} and $\boldsymbol{F}^i$ and $\boldsymbol{S}$ are their fluxes and sources respectively. \\

This formulation allowed to study ultra-relativistic flows and resolve shocks without spurious oscillations and without need for artificial viscosity.

It was shown to be especially well suited for use with numerical methods that take into account the conservation laws. These are the finite-volume (FV) FD high-resolution shock capturing (HRSC) methods, that will be discussed in Chapter \ref{chapter:num_methods} \\

Many recent advancements in numerical relativistic hydrodynamics and magnetohydrodynamics (MHD) have relied on these methods (\textit{e.g.,} \cite{Giacomazzo:2010bx} [274]\cite{Rezzolla:2011da} and references therein \todo{add recolla/bernuzzi/radice/shibata}).

There are other conservative formulations and methods (see \textit{e.g.,} \cite{Papadopoulos:1999kt}). However, we will limit our focus to the "Valencia formulation". \\

To begin we split the four-velocity $\vec{u}$ into the component parallel to the normal vector $\vec{n}$ and a purely spatial component as

\begin{equation}
    \vec{u} = (-\vec{u} \cdot \vec{n})(\vec{n} + \vec{\upsilon}),
\end{equation}

where naturally the Lorentz factor, measured by the Eulerian observer $W = (-\vec{u}\cdot\vec{n})$ emerges, and the $\upsilon$ is the fluid three-velocity measured by the Eulerian observer, 

\begin{equation}
    \vec{\upsilon} = \frac{\vec{u}}{W} -\vec{n},
\end{equation}

components of which are

\begin{equation}
    \upsilon^i = \frac{u^i}{W}+ \frac{\beta^i}{\alpha}, \hspace{10mm} \upsilon_i= \frac{u_{i}}{W}.
\end{equation}

Divergence of the rest-mass density four-vector $j$, (\ref{eq:theory:nablamu_jmu}) can easily be cast as 

\begin{eqnarray}
    0 = \nabla_{\mu}j^{\mu} = \frac{1}{\sqrt{-g}}\partial_{t}[\sqrt{\gamma}\rho W] + \frac{1}{\sqrt{-g}}\partial_{i}[\sqrt{\gamma}\rho(\alpha \upsilon^{i} - \beta^{i})]
\end{eqnarray}

where $D=\rho W = -\vec{j}\cdot \vec{n}$ is the conserved density.

To write the energy and momentum equations we note that for any vector field $\vec{p} $ \cite{Rezzolla:2013}, 

\begin{equation}
    \nabla_{\mu}[{T^{\mu}}_{\nu}p^{\nu}].
\end{equation}

To obtain the Valencia formulation we set $\vec{p}$ to have zeroth component $-\vec{n}$ and spatial components $\vec{\partial}_i$. Then the

\begin{itemize}
    \item ${T^0}_{\nu}p^{\nu}$ represent the conserved quantities,
    \item ${T^i}_{\nu}p^{\nu}$ are associated fluxes,
    \item ${T^{\mu}}_{\nu}p^{\nu}$ are sources
\end{itemize}

with the former being 

\begin{equation}
    S_{i} = \alpha {T^0}_{\nu}(\partial_i)^{\nu}=-\boldsymbol{T}(\vec{n},\vec{\partial}_i), \hspace{10mm} E = -\alpha{T^0}_{\nu}n^{\nu} = \boldsymbol{T}(\vec{n},\vec{n})
\end{equation}

for numerical reasons we will replace the total internal energy density $E$ with $\tau = E-D$, where $D$ is the rest mass density. This is done to avid errors emerging due to $E$ being much smaller then $D$. 

Now we can combine the obtained expressions for the conserved quantities, associated fluxes and sources with eq. (\ref{eq:theory:valencia_formalism}) and obtain

\begin{equation}
    \frac{1}{\sqrt{-g}}\Big[\frac{\partial\sqrt{\gamma}\boldsymbol{F}^{0}(\boldsymbol{u})}{\partial t} + \frac{\partial\sqrt{-g}\boldsymbol{F}^{i}(\boldsymbol{u})}{\partial x^i}\Big] = \boldsymbol{S}(\boldsymbol{u}),
    \label{eq:theory:grhdeq_thc} % used for THC section Code
\end{equation}

where primitive quantities being

\begin{equation}
    \boldsymbol{u} = [\rho,\: \upsilon_i,\: \epsilon],
\end{equation}

conserved quantities: 

\begin{equation}
    \boldsymbol{F}^0(\boldsymbol{u}) = [D,\: S_j,\: \tau] = [\rho W,\: \rho h W^2 \upsilon_j,\: \rho h W^2 - p - \rho W],
\end{equation}

associated fluxes

\begin{equation}
    \boldsymbol{F}^i(\boldsymbol{u})=\Bigg[D\Big(\upsilon^{i}-\frac{\beta^i}{\alpha}\Big),\: S_{j}\Big(\upsilon^{i}-\frac{\beta^i}{\alpha}\Big)+p{\delta^i}_j ,\: \tau\Big(\upsilon^{i}-\frac{\beta^i}{\alpha}+p\upsilon^i\Big)\Bigg]
\end{equation}

and sources 

\begin{equation}
    \boldsymbol{S}(\boldsymbol{u}) = \Bigg[0,\: T^{\mu\nu}\Big(\frac{\partial g_{\nu j}}{\partial x^{\mu}} - \Gamma^{\delta}_{\nu\mu}g_{\delta j}\Big),\: \alpha\Big(T^{\mu 0}\frac{\partial\log\alpha}{\partial x^{\mu}}-T^{\mu\nu}\Gamma^{0}_{\nu\mu}\Big)\Bigg]^T
\end{equation}

The from of the obtained general relativistic hydrodynamics equations resemble the one of the Newtonian gas dynamics. If the latter is adopted for numerical solutions. \\
There are however several complications. In particular there is no explicit inverse relation between the primitive quantities and the conserved ones. Thus one has to resort to the root-finding algorithms to reconstruct them (More on this in later chapters). In addition, it was pointed out that the $W$ cpuples the equation for the momenta in different direction \cite{Pons:2000,Rezzolla:2002ra,Rezzolla:2002cc,Aloy:2006rd}. This leads to the fact that the dynamics of the shock wave can be affected by the non-zero tangential velocity. Hence, the increased complexity if he problem of GR hydrodynamics \cite{Mignone:2005ns,Zhang:2005qy}.


\subsection{The General-Relativistic Boltzmann Equation}

In special relativity the Boltzmann equation was expressed by Synge \cite{Synge:1957}. Later Chernikov \cite{Chernikov:1962} and Tauber and Weinberg \cite{Tauber:1961} proposed its extension to the general relativity. \\
The list of applications of the Boltzmann equation was limited to the relativistic gas at first \cite{Israel:1963}. Later the list was supplemented by transient relativistic thermodynamics \cite{Israel:1979wp}, radiative transfer \cite{Lindquist:1966}, core-collapse supernovae \cite{Bruenn:1985} and others (see \textit{e.g.}, \cite{Cercignani:2002} and references therein). \\

Different formulations of the general relativistic Boltzmann equation exists in the literature. Lindquist \cite{Lindquist:1966} and Ehlers \cite{Ehlers:1971} proposed a geometrical interpretation. Later, a formulation based on Riemannian structure of tangent bundles was proposed by Sasaki \cite{Sasaki:1958,Sasaki:1962}. In addition, Debbasch and van Leuuwen \cite{Debbasch:2009a,Debbasch:2009b} recently provided a detailed derivation, albeit strongly focused on the algebraic aspects while eluding simple geometrical interpretation. \\
Here we recall the detailed derivation of the general relativistic Boltzmann equation, using modern differential geometry notation by Radice. 

\textcolor{red}{This.Is.Tough. Pure math. Copied from David + his sources.}

\subsubsection{The geometry of the tangent bundle}

Let the $\mathcal{M}$ be $4$ dimensional differential manifold such that $(\mathcal{M},\: g_{\alpha\beta})$ form the $C^2$ spacetime. The set of tangent vectors of $\mathcal{M}$ constitutes \textit{tangent bundle} of $\mathcal{M}$, the we denote as $T\mathcal{M}$. The set of all unit vectors of $\mathcal{M}$ constitute the \textit{subbundle} of $T\mathcal{M}$. \\
\textcolor{gray}{incompressible vector field}\\
\textit{Every Killing vector field of $\mathcal{M}$ is in incompressible vector field}

\paragraph{Extended transformation and extended tensors}

Let the $T\mathcal{M}$ be the set of all the tangent vectors of $\mathcal{M}$. The $T\mathcal{M}$ has a natural topology, bundle structure with $\mathcal{M}$ and the base - linear vector space $E^i$. We call $T\mathcal{M}$ the \textit{tangent bundle} of $\mathcal{M}$. Natural projection, or a projection map $\pi:\: T\mathcal{M}\rightarrow\mathcal{M}$.  \\

Let $U$ be a coordinate neighborhood, or a coordinate patch of $\mathcal{M}$ with $n$ variables $x^{\alpha}$ as coordinates. Then, every tangent vector of $\mathcal{M}$ at a point $p\in U$ with $2n$ variables $(x^i,\upsilon^{\alpha})$. Here $x^{\alpha}$ are coordinates of $p$ with respect to the coordinate patch ${x^{\alpha}}$ and $\upsilon^{\alpha}$ are components of a tangent vector in the natural frame that constitutes by the vectors $\partial/\partial x^4$ at $q$. Thus, the vector $\vec{p}$ at $q$ can be written as:

\begin{equation}
    \vec{p} = p^{\alpha}\frac{\partial}{\partial^{\alpha}}
\end{equation}

and its dual as 

\begin{equation}
    \underline{p} = p_{\alpha}dx^{\alpha}:=g_{\alpha\beta}p^{\beta}dx^{\alpha}
\end{equation}

In addition we introduce a coordiante patch $TU$, $\{z^A\}$, where $A$ runs from $0$ to $7$ of $T\mathcal{M}$ as 

\begin{equation}
    z^{\alpha} = z^{\alpha}, \hspace{10mm} z^{\alpha+4} = p^{\alpha}.
\end{equation}

Now, let the $U(x^{\alpha})$ and $\hat{U}(\hat{x}^{\alpha})$ be the two coordinate patches of $\mathcal{M}$ such that $U\cap\hat{U}$ is not empty. Then the intersection of the coordinate patches is also not empty. 
for every coordinate transformation of $\mathcal{M}$, there is a corresponding matrix $\frac{\partial \hat{x}^{\alpha}}{\partial x^{\beta}}$.
The coordinate transformation is then

\begin{equation}
    \hat{x}^{\mu} = \hat{x}^{\mu}(x), \hspace{5mm} \hat{p}^{\mu} = \frac{\partial\hat{x}^{\mu}}{\partial x^{\nu}}p^{\nu}
\end{equation}

which denotes the extended transforation of the $\hat{x}^{\mu} = \hat{x}^{\mu}(x)$. \\


The corresponding Jacobian matrix is 
\renewcommand\arraystretch{1.6} %% it stretches the matrix
\begin{equation}
\frac{\partial\hat{z}^A}{\partial z^B} = 
    \begin{pmatrix}
    \frac{\partial\hat{x}^{\alpha}}{\partial x^{\beta}} & 0 \\
    \frac{\partial^2\hat{x}^{\alpha}}{\partial x^{\beta} \partial x^{\gamma}}p^{\gamma} & \frac{\partial\hat{x}^{\alpha}}{\partial x^{\beta}} 
    \end{pmatrix}
\end{equation}
\renewcommand\arraystretch{1.0}




\paragraph{Vectors on $T\mathcal{M}$}

As we will need to introduce connections on a tangent bundle, here we discuss the double tangent bundle, ot a second tangent bundle. Since $T\mathcal{M}$ is a vector bundle on its own right, its tangent bundle has the secondary vector bundle structure $TT\mathcal{M}$. Let point $b\in TU$ and $T_b T\mathcal{M}$ be the tangent space to $T\mathcal{M}$ at $b$. \\
Given a vector $\partial/\partial x^{\alpha}$ at a point $b$, it can be "pushed forward" to the point on the $TT\mathcal{M}$ by means of so called \textit{differential of} $\pi$, whitten as $\pi_*$ \cite{Frankel:2002}.
On a natural basis the push-forward acts as 

\begin{equation}
    \pi_*\Big[\frac{\partial}{\partial x^{\alpha}}\Big] = \frac{\partial}{\partial x^{\alpha}}, \hspace{5mm} \pi_* \Big[\frac{\partial}{\partial p^{\alpha}}\Big] = 0,
\end{equation}

and the pull back 

\begin{equation}
    \pi^* {\text d} x^{\alpha} = {\text d} x^{\alpha}.
\end{equation}

Consider a vector field $\vec{X} \ in TT\mathcal{M}$  in a vicinity of the point $b$, which is associated with the point $q$ of $\mathcal{M}$ and vector $\vec{x}\in T_{q}\mathcal{M}$. Let $b{\lambda}$ be the flow of $b$ generated by $\vec{X}$. The $b(\lambda)$ is associate with $q(\lambda)$, the one parameter family of points of $\mathcal{M}$. The $b(\lambda)$ is also associated with $\vec{x}(\lambda)$ the one parameter family of vectors on $T\mathcal{M}$.  \\

The vector field $\vec{X}$ is called \textit{vertical} if the $q(\lambda)\in\mathcal{M}$ are constant along the flow. Similarly, the vector field $\vec{X}$ is called \textit{horizontal} if $\vec{x}(\lambda)\in T_p \mathcal{M}$ is "constant" along the flow, meaning that $\vec{x}(\lambda)$ is just $\vec{x}$ that is \textit{parallel transported} to $q(\lambda)$. \\
As there is no unique way to perform a parallel transport, the linear connection $\nabla$ on $\mathcal{M}$ has to be chosen. This choice is akin choosing two vector spaces $\mathcal{O}_b$ and $\mathcal{V}_b$ of the horizontal and vectical vectors respectively at each point $b$ that the direct sum of these spaces yields

\begin{equation}
    \mathcal{O}_b\oplus \mathcal{V}_p = T_b T\mathcal{M}.
\end{equation}

Having the connection allows to prescribe a manner of lifting curves from the base manifold $T\mathcal{M}$ into the $T_b T\mathcal{M}$ \textcolor{red}{I need to fix this and understand}. A lift is the unique horizontal vector $\vec{X}\in T_bT\mathcal{M}$ whose projection is a vector $\vec{x}\in T_q\mathcal{M}$.\\ 
\textcolor{red}{fill it}
Let us now define a \textit{connection vector basis} adopted to the aforementioned split of $T_b T\mathcal{M}$ $\{\text{D}/\partial x^A \}:=\{\text{D}/\partial x^{\alpha}, \partial/\partial p^{\alpha} \}$ where 

\textcolor{red}{I did not find where this is derived from... difficult}

\begin{equation}
    \frac{\text{D}}{\partial x^{\alpha}}{\partial x^{\alpha}} := \frac{\partial}{\partial x^{\alpha}} - {\Gamma^{\beta}}_{\alpha\gamma}p^{\gamma}\frac{\partial}{\partial p^{\beta}}.
\end{equation}

Similarly a connection can be build for differential forms. Using the pull-back $\pi^*$ the dual basis $\{ \text{D}z^{A} \}:=\{\text{d}x^{\alpha}, \text{D}p^{\alpha}\}$ that satisfies 

\begin{equation}
    \text{D} = \text{d} p ^{\alpha} + {Gamma^{\alpha}}_{\beta\gamma}p^{\gamma}\text{d}x^{\beta}.
\end{equation}

\paragraph{Metric on $T\mathcal{M}$}

Note that 

\begin{equation}
    \frac{\partial^2 \hat{x}^{\mu}}{\partial x^{\nu}\partial x^{\lambda}}p^{\lambda} = {\hat{\Gamma}^{\mu}}_{\delta\gamma}p^{\lambda}\frac{\partial\hat{x}^{\delta}}{\partial x^{\nu}}.
\end{equation}

Let us assume that for any point $b\in T\mathcal{M}$ there exist an open set $TU$, such that $b\in TU$ with a coordinate system on $TU$ that satisfies

\begin{equation}
    G_{AB} = (\boldsymbol{\eta}\otimes\boldsymbol{\eta})_{AB},
\end{equation}

where $\boldsymbol{\eta} = \text{diag}(-1, 1, 1, 1)$. \\
Let the $\hat{x}^A$ denote the generic coordinate system on $TU$. Then the metric in this coordinate system can be expressed as

\begin{align}
    \hat{G}_{\mu\nu} &= \frac{\partial \hat{x}^{\alpha}}{\partial x^{\mu}}\frac{\partial \hat{x}^{\beta}}{\partial x^{\nu}}\eta_{\alpha\beta} + \frac{\partial \hat{x}^{\alpha}}{\partial x^{\mu}}{\hat{\Gamma}^{\gamma}}_{\:\:\:\alpha\lambda}p^{\lambda}\frac{\partial \hat{x}^{\beta}}{\partial x^{\nu}}{\hat{\Gamma}^{\delta}}_{\:\:\:\beta\xi}p^{\xi}\eta_{\gamma\delta}; \\
    \hat{G}_{\mu\: \nu+4} &= \frac{\partial \hat{x}^{\alpha}}{\partial x^{\mu}}\frac{\partial \hat{x}^{\gamma}}{\partial x^{\nu}}{\hat{\Gamma}^{\beta}}_{\:\:\:\gamma\lambda}p^{\lambda}\eta_{\alpha\beta}; \\
    \hat{G}_{\mu+4 \: \nu+4} &= \frac{\partial \hat{x}^{\alpha}}{\partial x^{\mu}}\frac{\partial \hat{x}^{\beta}}{\partial x^{\nu}} \eta_{\alpha\beta}
\end{align}

and the line element 

\begin{align}
    dS^2 &= \hat{G}_{AB}d\hat{z}^A d\hat{z}^B = \hat{g}_{\mu\nu}\text{d}\hat{x}^{\mu}\text{d}\hat{x}^{\nu} + \hat{g}_{\mu\nu}[\text{d}p^{\mu} + {\hat{\Gamma}^{\mu}}_{\:\:\:\alpha\beta}p^{\beta}\text{d}x^{\alpha}] [\text{d}p^{\nu} + {\hat{\Gamma}^{\nu}}_{\:\:\:\alpha\beta}p^{\beta}\text{d}x^{\alpha}] \\
    &= \hat{g}_{\mu\nu}\text{d}\hat{x}^{\mu}\text{d}\hat{x}^{\nu} + \hat{g}_{\mu\nu}\text{D}\hat{x}^{\mu}\text{D}\hat{x}^{\nu}
\end{align}

It is possible to show that the determinant $|\text{det}\boldsymbol{G}| = g^{2}$ as the transformation from the natural frame to the connection frame is unimodular \cite{Lindquist:1966}. Thus the volume pseudo-form on $T\mathcal{M}$ is in the coordiante patch $TU$

\begin{align}
    \text{Vol}^8 &:= -g \text{d}x^{0} \wedge \text{d}x^{1} \wedge ... \wedge \text{d}p^{3} := - g\text{d}^{4}x \text{d}^{4}p, \\
    &:= -g \text{d}x^{0} \wedge \text{d}x^{0} \wedge ... \wedge \text{D}p^{3} :=-g \text{d}^{4}x\text{D}^4 p
\end{align}

\textcolor{red}{I kinda gave up here and just copied.}


\paragraph{the Liuville theorem}

Let us start by introducing a \textit{cotangent bundle}. Let $\mathcal{M}$ be a differentiable manifold. Similarly to the construction of the tangent bundle, we can make a set of covectors on a given manifold into a vector bundle over $\mathcal{M}$, denoted $T^*\mathcal{M}$ and called \textit{cotangent bundle} of $\mathcal{M}$.  Similarly we can define a contangent bundle of a tangent one $T^*T\mathcal{M}$. The contangent bundle $T^*\mathcal{M}$ is the vector bundle dual to the tangent bundle $T\mathcal{M}$. 

Let us start by defining \textit{Poincar\'e} 1-form on $T\mathcal{M}$, $\underline{\lambda}\in T^* T\mathcal{M}$. Consider point $q$ on a manifold $\mathcal{M}$ and a point $A$ associated with $q$ on a tangent bundle $T\mathcal{M}$. Let there be a 1-form $\underline{\alpha}\in T^* _q\mathcal{M}$. The $\underline{\lambda}$ and $\underline{\alpha}$ are uniquely connected $\underline{\lambda} = \pi^* \alpha$, and the former is called the \textit{Poincar\'e} 1-form. In local coordinate patch, $TU$ it is expressed as

\begin{equation}
    \underline{\lambda} = p_{\alpha} \text{d}x^{\alpha}.
\end{equation}

the associated vector is 

\begin{equation}
    \vec{\lambda} = p^{\alpha} \frac{\text{D}}{\partial x^{\alpha}} = p^{\alpha}\frac{\partial}{\partial x^{\alpha}} - p^{\alpha}{\Gamma^{\beta}}_{\alpha\gamma}p^{\gamma}\frac{\partial}{\partial p^{\beta}},
\end{equation}

is called the $\textit{geodesic flow field}$. \\
This flow represents a phase-space flow of particles moving along geodesics. \\

Consider a mass shell, that at a point $q\in U$can be defined as a set:\\
\textcolor{red}{remider: I have no idea how is this possible...}

\begin{equation}
    \mathcal{S}_m = \big\{ p^{\alpha}\in T_q\mathcal{M}: p_{\mu}p^{\mu}+m^2 =:f(p) = 0 \big\}.
\end{equation}

The normal to the mass-shell is 

\begin{align}
    \text{if } m &\neq 0 \hspace{5mm} \underline{\pi}:=\frac{q}{2m}\text{d}f, \hspace{5mm} \text{d}f = \frac{\partial f}{\partial x^{\mu}} + \frac{\partial f}{\partial p^{\mu}}\text{d}p^{\mu} = 2p_{\mu}\text{d}p^{\mu}, \\
    \text{if } m &= 0 \hspace{5mm} \underline{\pi}:=\frac{1}{2}\text{d}f
\end{align}

Next, we introduce a unique form $\underline{\nu}$ whose restriction on $T_q\mathcal{M}$ is equal to $\underline{\pi}$. 

\begin{align}
    \text{if } m &\neq 0 \hspace{5mm} \underline{\nu} = \frac{1}{m}p_{\alpha}\text{D}p^{\alpha} \\
    \text{if } m &= 0 \hspace{5mm} \underline{\nu} = p_{\alpha}\text{D}p^{\alpha}
\end{align} 

Note that $\underline{\nu} = 0$, meaning that the $\underline{\nu}$ is irrotational. It becomes clear if we re-express it as 

\begin{equation}
    \underline{\nu} = \frac{1}{2m}\frac{\text{D}f}{\partial p^{\alpha}}\text{D}p^{\alpha}
\end{equation} 

for massive particle case. For the mass-less the procedure is analogous. \\

It can be shown that $\underline{\lambda}$ is ncompressible \textit{i.e.,} $\text{d}^{\star}\underline{\lambda} =\star \text{d}\star\underline{\lambda} =0$. \\

In addition, both $\underline{\lambda}$ and $\underline{\nu}$ are harmonic forms as 

\begin{equation}
    \nabla\underline{\nu} = 0 , \hspace{5mm}
    \nabla\underline{\lambda} = [\text{dd}^{\star} + \text{d}^{\star}\text{d}]\underline{\lambda} = 0.
\end{equation}

Let us now consider the density of states in the phase space, of particles moving along tgeodeiscs with velocities on the mass shell. \\ 
In the previous section we introduced a flux of the vector field $\vec{X}$ across $\Sigma$ in \ref{eq:theory:flux_of_flow}, we define the following six-form

\begin{align}
    \boldsymbol{\omega} &= \star\big(\underline{\nu}\wedge\underline{\lambda}\big) = i_{\vec{\lambda}} i_{\vec{\nu}}\text{Vol}^8 \\
    &= i_{\vec{\lambda}}\Big[i_{\vec{\nu}}\big(\text{Vol}^{4}_{x}\wedge\text{Vol}^{4}_{p}\big)\Big] = i_{\vec{\lambda}} \big[\text{Vol}^{4}_{x}\wedge\text{Vol}^{3}_{p}\big],
\end{align}

where we used the definition of $\text{Vol}^8$. \\
The introduced four forms read,

\begin{align}
    \text{Vol}_x ^4 &:= \sqrt{-g} \text{d}x^{0} \wedge \text{d}x^{1} \wedge \text{d}x^{2} \wedge \text{d}x^{3}, \\
    \text{Vol}_p ^4 &:= \sqrt{-g} \text{D}p^{0} \wedge \text{D}p^{1} \wedge \text{D}p^{2} \wedge \text{D}p^{3}, \\
    \text{Vol}_p ^3 &:= i_{\vec{\nu}}\text{Vol}_p ^4,
\end{align}

where the four-forms are on the $TU$ and the latter three-form is on the mass shell $S_m$. \\

Consider coordinates adopted to the mass-shell, where $\underline{\nu} = (p_0/m)\text{D}p^0$ and $\underline{\nu} = p_0\text{D}p^0$ in the massive nad massless cases respectively, the three-form becomes

\begin{equation}
    \text{Vol}^3 _p =\frac{\sqrt{-g}}{-p_0}\text{D}p^1\wedge\text{D}p^2\wedge\text{D}p^3
\end{equation}

Now we have a three-form $\text{Vol}^3 _p$ and a four-form $\text{Vol}_x ^4$. In the context of the ADM foliation, we split spacetime manifold as $\mathcal{M}=\mathcal{R}\times\Sigma$, with $x^0 = \text{const}$ being constant hypersurfaces with normal $\underline{n} = - \alpha\text{d}x^0$ and $\alpha$ -- the lapse function. We can now simplify the $\boldsymbol{\omega}$, splitting $\text{Vol}_x ^3$ as 

\begin{align}
    \text{Vol}_x ^4 &= -\underline{n}\wedge\text{Vol}_x ^3 \hspace{5mm} \text{where,} \\
    \text{Vol}_x ^3 &= i_{\vec{n}}\text{Vol}_x ^4 = \sqrt{\gamma}\text{d}x^1\wedge\text{d}x^2\wedge\text{d}x^3
\end{align}

and the $\boldsymbol{\gamma}$ is the three-metric induced on the slices.  \\
The resulted coordinates, adapted to the mass shell and the spacetime foliation read

\begin{align}
    \boldsymbol{\omega} &=-(\vec{p}\cdot\vec{n})\frac{1}{-p_0}\sqrt{\gamma}\sqrt{-g}\text{d}x^1\wedge\text{d}x^2\wedge\text{d}x^3 \wedge\text{D}p^2\wedge\text{D}p^2\wedge\text{D}p^3 \\
    &= \frac{p^0}{-p_0}|g|\text{d}x^1 \wedge\text{d}x^2\wedge\text{d}x^3 \wedge\text{D}p^2\wedge\text{D}p^2\wedge\text{D}p^3
\end{align}

Now, consider a six-vector, $\delta_i x \delta_i p$ with $i\in\{1,2,3\}$. The $\delta_i x$ are tangent vectors to the slice $\Sigma$ and the $\delta_i p$ are tangent to mass shell $S_m$. \\
The action of $\boldsymbol{\omega}$ on the six-vectors $\delta_1 x$, $\delta_2 x$, $\delta_3 x$, $\delta_1 p$, $\delta_2 p$, $\delta_3 p$ yields

\begin{align}
    \boldsymbol{\omega}(\delta_1 x,...,\delta_3 p) =& \frac{p^0}{-p_0}|g|\big[\text{d}x^1\wedge\text{d}x^2\wedge\text{d}x^3\big](\delta_{1}x,\delta_{2}x,\delta_{3}x)\times \\
    & \hspace{10mm} \Big[\text{D}p^1\wedge\text{D}p^2\wedge\text{D}p^3\Big](\delta_1 p, \delta_2 p, \delta_3 p) \\
    & \hspace{2mm} -\frac{p^0}{-p_0}|g|\big[\text{d}x^1\wedge\text{d}x^2\wedge\text{d}x^3\big](\delta_{1}p,\delta_{2}p,\delta_{3}p)\times \\
    & \hspace{10mm} \Big[\text{D}p^1\wedge\text{D}p^2\wedge\text{D}p^3\Big](\delta_1 x, \delta_2 x, \delta_3 x) = \\
    =& \frac{p^0}{-p_0}|g|\big[\text{d}x^1\wedge\text{d}x^2\wedge\text{d}x^3\big](\delta_{1}x,\delta_{2}x,\delta_{3}x)\times \\
    & \hspace{10mm} \Big[\text{D}p^1\wedge\text{D}p^2\wedge\text{D}p^3\Big](\delta_1 p, \delta_2 p, \delta_3 p) = \\
    =& \frac{p^0}{-p_0}|g|\big[\text{d}x^1\wedge\text{d}x^2\wedge\text{d}x^3\big](\delta_{1}x,\delta_{2}x,\delta_{3}x)\times \\
    & \hspace{10mm} \Big[\text{d}p^1\wedge\text{d}p^2\wedge\text{d}p^3\Big](\delta_1 p, \delta_2 p, \delta_3 p), \\
\end{align}

where we used that $\text{d}x^i(\delta_j p)=0$ and the relation

\begin{equation}
    \text{D}p^{i}(\delta_j p) = \text{d}p^{i}(\delta_j p) - {\Gamma^i}_{\alpha\beta}p^{\alpha}\text{d}x^{\beta}(\delta_j p) = \text{d}p^i(\delta_j p)
\end{equation}

Thus, on the space-like hypersurface $\Sigma$ and on the mass shell we have

\begin{equation}
    \boldsymbol{\omega} = \frac{p^0}{-p_0}|g|\text{d}x^1\wedge\text{d}x^2\wedge\text{d}x^3\wedge\text{d}p^1\wedge\text{d}p^2\wedge\text{d}p^3 =: \boldsymbol{\Omega}
\end{equation}

The $\boldsymbol{Omega}$ can be split as 

\begin{align}
    \boldsymbol{\Omega} &= \boldsymbol{\Lambda} \wedge \boldsymbol{\Pi}, \hspace{5mm} \text{where} \\
    \boldsymbol{\Lambda} &= p^0 \sqrt{-g}\text{d}x^1\wedge\text{d}x^2\wedge\text{d}x^3 \\
    \boldsymbol{\Pi} &=  \frac{1}{-p_0}\text{d}p^1\wedge\text{d}p^2\wedge\text{d}p^3
\end{align}

The defined forms $\boldsymbol{\Lambda}$ and $\boldsymbol{\Pi}$ can be written in a coordinate-independent way at any point $q\in\mathcal{M}$ as 

\begin{equation}
    \boldsymbol{\Lambda} = \star_{\mathcal{M}}\underline{\lambda}, \hspace{5mm} \boldsymbol{\Pi} = \star_{T_q\mathcal{M}}\underline{\pi}
\end{equation}

and this are intrinsic forms in $T\mathcal{M}$. In addition, the $\boldsymbol{\Lambda}$ and $\boldsymbol{\Pi}$ are the proper geodesics flux
volume form on $\Sigma\in\mathcal{M}$ and mass shell $S_m\in T_q\mathcal{M}$ at a point $q\in U$ respectively. \\

Let us now consider the geodesic flow $\vec{\lambda}$. It generates a "tube" in a phase space, that we limit with $S_1$ and $S_2$ sections. Then the flux of points in phase space associated with geodesic flow is $\int_{S}\boldsymbol{\omega}$. It is possible to show that the flux satisfies

\begin{equation}
    \int_{S_1}\boldsymbol{\omega} = \int_{S_2}\boldsymbol{\omega}
    \label{eq:theory:liuville}
\end{equation}

which is the \textit{Liouvilleâ€™s Theorem} in the relativistic case. \\

To see taht this is indeed the case, consider the exterior differential of $\boldsymbol{\omega}$

\begin{equation}
    \star\text{d}\omega = \text{d}^{\star}(\underline{\nu}\wedge\underline{\lambda}) = d^{\star}\underline{\nu}\wedge\underline{\lambda} + \underline{\nu}\wedge\text{d}^{\star}\underline{\lambda}.
\end{equation}

The $\text{d}^{\star}=\text{const}=k$ as $\text{dd}^{\star}\underline{\nu}=0$. In addition, the $\text{d}^{\star}\underline{\lambda}=0$. This allow us to write 

\begin{equation}
    \text{d}\omega = -k(\star\lambda).
\end{equation}

We note the $\star\underline{\lambda}$ is the volume form of the hypersurfaces orthogonal to $\vec{\lambda}$. Hence, the $\star\underline{\lambda}[\vec{\lambda},...]=0$ along the "tube" in phase space. 

\begin{equation}
    \int_S\text{d}\boldsymbol{\omega} = 0.
\end{equation}

the \ref{eq:theory:liuville} is recovered, if we use the Stokeâ€™s Theorem, and using the fact that the $\boldsymbol{\omega}$ vanishes along the part of the boundary tangent to $\vec{\lambda}$.

\textcolor{red}{Note that I still have no Idea what I have written. I need to go through the original materal, which I could not find... at least I could not find what I could read and understand. }

\subsubsection{The Boltzmann equation}

Let us introduce the phase space version of the mass flux, the 6-form representing the number of phase-space trajectories crossing $S$ of the phase tube between $S_1$ and $S_2$ cross sections. \\
In the absence of collisions we obtain 

\begin{equation}
    \int_{S_1}\boldsymbol{\mu} = \int_{S_2}\boldsymbol{\mu}.
\end{equation}

Remembering that $\boldsymbol{\omega}$ represents the density of states in phase space of particles moving along geodesics, we obtain 

\begin{equation}
    \boldsymbol{\mu} = F\boldsymbol{\omega},
\end{equation}

where $F$ is \textit{invariant distribution function}, \textcolor{gray}{i.e. F is the Radon-Nikodym derivative of $\boldsymbol{\mu}$ with re $\boldsymbol{\omega}$}. \\

Consider now that collisions change the number of phase trajectories as 

\begin{equation}
    \delta N = \int_{S_2} \boldsymbol{\mu} - \int_{S_1}\boldsymbol{\mu} = \int_S \text{d}\boldsymbol{\mu} = \int_S \text{d}F\wedge\boldsymbol{\omega}.
\end{equation}

where 

\begin{equation}
    \text{d}F\wedge\boldsymbol{\omega} = \text{d}F\wedge\star (\underline{\nu}\wedge\underline{\lambda}) = \langle\text{d}F,\underline{\lambda}\rangle\star\underline{\nu} - \langle\text{d}F,\underline{\nu}\rangle\star\underline{\lambda},
\end{equation}

where $\langle\cdot,\cdot\rangle$ is a scalar product between forms and can be written as

\begin{equation}
    \langle\boldsymbol{\alpha},\boldsymbol{\beta}\rangle\text{Vol}^8 := \boldsymbol{\alpha}\wedge\star\boldsymbol{\beta},
\end{equation}

and with the $\star\underline{\lambda}=0$ on $S$ we obtain 

\begin{equation}
    \delta N = \int_S\langle\text{d}F\underline{\lambda}\rangle\star\underline{\nu} = \int_S\mathcal{C}[F]\star\underline{\nu},
\end{equation}

where we denoted the effect of collisions as

\begin{equation}
    \langle\text{d}F\underline{\lambda}\rangle = \mathcal{C}[F].
\end{equation}

This is the Boltzmann equation. In component from it reads as 

\begin{equation}
    p^{\alpha}\frac{\partial F}{\partial x^{\alpha}} - {\Game^{\gamma}}_{\alpha\beta}p^{\alpha}p^{\alpha}\frac{\partial F}{\partial p^{\gamma}} =\mathcal{C}[F].
\end{equation}

In the coordinate system adapted to the equation, when $P^0 = p^0(p^i)$, the equation reads \cite{Cercignani:2002}:

\begin{equation}
p^{\alpha}\frac{\partial F}{\partial x^{\alpha}} - {\Game^{i}}_{\alpha\beta}p^{\alpha}p^{\alpha}\frac{\partial F}{\partial p^{i}} =\mathcal{C}[F].
\end{equation}

Remembering that that the $\underline{\lambda}$ is incompressible, we can write

\begin{equation}
    \langle\text{d}F,\underline{\lambda}\rangle = \text{d}^{\star}[F,\underline{\lambda}],
\end{equation}

This allows to obtain a conservative formulation of the Boltzmann equation, that indicates the conservation of the number of particles \cite{Cardall:2002bp}

\begin{equation}
    \text{d}^{\star}[F\underline{\lambda}] = \mathcal{C}[F].
\end{equation}

Next, we re-introduce the Levi Civita connection $\nabla$ in phase space. For incompressible $\underline{\lambda}$ it gives

\begin{equation}
    \nabla_A\lambda^A=0,
\end{equation}

while the Boltzmann equation becomes 

\begin{equation}
    \lambda^A\partial_A F=\mathcal{C}[F]
\end{equation}

and its conservative form 

\begin{equation}
    \nabla_A[Fp^{A}] = \mathcal{C}[F],
    \label{eq:theory:liouvilletheorem}
\end{equation}

or in component form

\begin{equation}
    \frac{1}{|g|}\frac{\partial}{\partial x^{\mu}}\Bigg[|g|Fp^{\mu}\Bigg] + \frac{p_0}{|g|}\frac{\partial}{\partial p^{k}}\Bigg[\frac{|g|}{-p_0}{\Gamma^k}_{\alpha\beta}p^{\alpha}p^{\beta}F\Bigg] = \mathcal{C}[F].
\end{equation}

\subsubsection{From the Boltzmann Equation to the Euler Equation}

In order to derive from the Boltzmann equation the equations of hydrodynamics, we need to first define the needed varaibles of the kinetic description, such as mass and energy fluxes. We not that the density flux can easly be obtained from $\boldsymbol{\mu}$. We write the mass flow then as 

\begin{equation}
    \boldsymbol{\rho} = \int_{S_m} \boldsymbol{\mu}.
\end{equation}

Recalling the definition of the rest-mass denisty four-vector $J$, we note that

\begin{equation}
    \int_{\Sigma}(-J^{\mu}n_{\mu})\text{Vol}_x ^3 = \int_{\Sigma\times S_{m}} Fp^0\boldsymbol{\Pi}\text{Vol}_x ^3 = \int_{\Sigma\times S_{m}} F\boldsymbol{\Omega} = \int_{\Sigma}\boldsymbol{\rho}
\end{equation}

Thus, the $J$ can be written as 
\textcolor{red}{this is not clear how it was obtain. Must go through again.}

\begin{equation}
J^{\mu} = \int_{S_m}Fp^{\mu}\boldsymbol{\Pi}
\end{equation}

The second moment of the distribution function $F$ in a similar way gives the stress energy tensor 

\begin{equation}
    T^{\mu\nu} = \int_{S_m} F p^{\mu}p^{\nu}\boldsymbol{\Pi}
\end{equation}

the components of which in the frame comoving with the fluid are

\begin{equation}
    T^{\mu\nu} = 
    \begin{pmatrix}
    E & \vec{F} \\
    \vec{F} & \boldsymbol{P} \\
    \end{pmatrix}
\end{equation}

where $E$ and $\vec{F}$ are the energy density and flux respectively, and $\boldsymbol{P}$ is the stress tensor. 

The nature of the collisional operation ultimately defines the equilibrium configuration distribution function $F$ \cite{Cercignani:2002}, and thus the form of the stress-energy tenor. 

Now we use the Liouville Theorem to obtain the equations of hydrodynamics. 
To accomplish that we insert the $\boldsymbol{\Psi}$, a tensorial funcition of $p^i$, into the theorem, eqiation \ref{eq:theory:liouvilletheorem} on both sides and integrate with respect to $\boldsymbol{\Pi}$ as

\begin{equation}
    \int_{\text{I\!R}}\nabla_{A}[F\lambda^A\boldsymbol{\Psi}]\boldsymbol{\Pi}=\int_{\text{I\!R}}\mathbb{C}[F]\boldsymbol{\Psi}\boldsymbol{\Pi}
\end{equation}

where we used that $\lambda^A\nabla_{A}\boldsymbol{\Psi}=0$ as $\vec{\lambda}$ is the geodesic flow. \\

Letting the $F$ decay for large momenta we obtain the transfer equation \cite{Israel:1963,Cercignani:2002}:

\begin{equation}
    \nabla_{\mu}\int_{\text{I\!R}} F\boldsymbol{\Psi}p^{\mu}\boldsymbol{\Pi} =\int_{\text{I\!R}} \mathcal{C}[F]\boldsymbol{\Psi}\boldsymbol{\Pi},
    \label{eq:theory:transferequation}
\end{equation}

\textcolor{red}{check the sources. White intermediate steps}

In a particular case of a simple gas $\Psi$ can be shown to be one of the $\{1,p^0,p^1,p^2,p^3\}$ \cite{Cercignani:2002}. Then the right hand side of the transfer equation becomes 

\begin{equation}
    \int_{\text{I\!R}} \mathcal{C}[F]\boldsymbol{\Psi}\boldsymbol{\Pi} = 0.
\end{equation}

These $\boldsymbol{\Psi}$ are related to the quantities conserved by the collisional operator and are called \textit{collisional invariants}. Choice of $1$ would yield the mass conservation, while $p^{\mu}$ -- the energy and momentum conservation. \\

Now, having cancelled the R.H.S of the eq. \ref{eq:theory:transferequation}, we obtain the conservation laws in a following form

\begin{equation}
    \nabla_{\mu}J^{\mu} =0 \hspace{10mm}\nabla_{\nu}T^{\mu\nu} =0
\end{equation}

\subsection{Overview}

We start this section by revisiting the fundamental concepts, such as manifold, tangent and cotangent bundles, with vectors and differential forms defined on them, and operations such ans exterior, Wedge product and Hodge star operator. \\

Then we set ourselves a goal to obtain the general form of general relativistic hydrodynamics. This includes the equations for space-time evolution adopted adopted for use in numerical applications and Euler equations for the fluid, which we aim to obtain through the Liuville's theorem and Boltzmann equations. \\

To derive the Einstein field equations we perform the variation of the so-called Hilbert action, applying the Euler-Lagrange equation. Thus we start by briefly deriving the Euler-Lagrange equations, using the fact that the fields we are interested in are defined over only a compact domain and that the choice of the variation of coordinates is arbitrary, i.e. $\partial S(\boldsymbol{q}, \nabla \boldsymbol{q}) = 0$. Then, in a similar way, the variation of the Hilbert action, yields the Einstein Field equation. \\

For practical applications it is useful to express the EFE as a initial value boundary problem. The hamiltonian formalism allows to do that, which we briefly review. We then sketch the $3+1$ decomposition procedure, introducing the spacelike foliation and extrinsic curvature that allow us to obtain the constraint equations, that has to be satisfied on every hyper-surface of the hypersurface. Then, emplying the EFE and Gauss-Codacci equations we write the Hamiltonian density, whose variation with respcet to the variables of folliation $\alpha$ and $\beta$ yileds constraint equation. The evolution equations then are obtained through the variation of the Hamiltinan with respect to the three-metric and momentum. \\

The obtained ADM system is however not well suited for numerical applications, being only weekly hyperbolic. We thus briefly touch on a strongly hyperbolic formulation, the Z4 formulation, that exhibit such usefull for numercs properties as constraint violation dumpening (constrain preservation) and its evolution, the CCZ4 formulation that is furhter adopted for BH evolution. \\

After, we briefly touch on the gauge conditions, as in the 3+1 we are left with the freedom on how to do the foliation, namely, chosing the lapse function and shift vector. \\

Then we proceed with deriving equations of general relativistc hydrodynamics, aiming to provide a flux-conservative formulation. We first define the kinematics of the relativistc fluid, \textit{i.e.,} a covariant description in terms of invariant quantities. With this goal in mind we define the rest-mass density vector, whose divergence give the number of particles conservation. Then we re-introduce the stress energy tensor ans show that via Bianki identities, its divergence alse vanishes. \\

To discuss the dynmaics of the fluid, we first, set its type. We consider the fluid that hs and thermal conductivity and no viscosity, \textit{i.e.}, the perfect fluid. In addition to fluid kinematics and the stress-energy tensor, describing tis motion, we discuss an equation of state. Together they from a hyperbolic ssytem of equations that describes the evolution of the fluid in space-time, once the initial data is set.\\

For the reasosns of numerical stability, a special formulation of the equations of general relativistic hydrodynamics is required. Such is the Valencia formulation. The main idea is to constract an advection-like equation for fluxes of conserved quantites, from which the promitive quantities can be reconstructed.\\ 

To derive these fluxes we first decompose the four velocity into the component parallel to the normal to the hypersurface and a purely spatial part. This leads us to the defention of the conserved density. Then we introduce a vector whose zeroth component is just a norm and spatial component which is a \textcolor{gray}{tangent vector to hypersurface}. This allows us to write the conserved and primitive qiantities of the formulatio, as well as the sourve term. \todo{not all quntities in Val.Form. are clear. What is $S_j$ and $\epsilon$} \\

Next we consider geometrical approach to the general-relativistic boltzmann equation \textcolor{gray}{still not sure why though}. To do that we first introduce necessary tools, namely vectors and tensors that are needed to define the phase-space. There there are $2n$ components with the first $n$ being coordinates and the second $n$ being impulses. In addition, we introduce the coordinate trnaformation and finally, the metric on the tangent bundle. \\

Having tools set, we derive the Liuville theorem. In order to do that we write phase-space flow of particles moving along geodesics which is represented by the Poincare 1-form and associated vecotr. In addition we define a mass shell, a norm to it and a irrotational form on a tangent bundle. Together with the poincare form it allows us to define the denisty of the phase-space trjectories which we denote ad a Hodge operator of the wedge product of these two forms. After some calculations, we obtain that this form can be expressed in a coordiante independed way as a split of two froms, the proper geodeiscs flux froms on the hypersurface and the mass shell respectively. By considering the "phase tube" with two crossections, we arrive that itegrated flux is conserved, which constitutes the Liouville\'s Theorem. \\

After that we proceed with deriving the Boltzmann equation. Which we start by intoducing the number of phase-space trajectories crossing the section of a "phase tube". The relation between the number of the phase space trajectoies and the density defined above, yilds the invariant distribution function. Considering the change in the number of particles due to collisions. The change in scalar product between the exteriour derivative of the distribution function and poincare 1-form due to collisions constitudes the Boltzmann equation. \textcolor{gray}{revise this.}. Re-introducing the Levi Civita connection in phase space, and taking an advantage of the incompressibility if the poincare 1-form, we obtain a conservative form of the Boltzmann equation. \\

From Boltzmann equation we can now obtain an equations of hydrodynamics. For that we firs redefine the variables of the kinetic description, such as mass and energy fluxes, recalling the definition of the rest-mass density four-vector. Similarly how the vector can be now exprressed as a first moment of the distribution function, the second moment gives the sress energy tensor. However, we note that the nature of the collisional operation ultimately denes the equilibrium conguration distribution function and thus the form of the stress-energy tenor. \\

Next we use the Liouville Theorem to obtain the equations of hydrodynamics introducing a tensorial function of the momenta, that is related to the quantities conserved by the collisional operator and are called collisional invariants into the integral form onf the theorem. Letting the distribution function decay for large momenta we obtain the transfer equation. For as simple gas this can be reduced to already familiar equations where divergence of the rest mass vector J and stress energy tensor is zero. 



\chapter{Numerical Approximation of Conservation Laws}

In this chapter we aim to briefly remark on the theory of the numerical approximation of conservational laws. Owing to its key importance in physics, there is quite an extensive amount of literature concerning the topic. We therefore select the aspects that are of relevance to this work, namely high-order, state-of-the-art numerical methods for the solution of conservation laws. For the sake of compactness we would refrain from stating complete descritions of these schemes, focusing on key ideas behind them, their advantages and drawbacks in the context of general-relativistic hydrodynamics. \\

This chapter is structured as following. In Section \ref{sec:theory:conserv_laws:theorback} we state the basics behind the theory of conservation laws and their numerical approximation. In Section \textcolor{red}{[??]} we give a brief overview of the Godunov-like finite-volume schemes. Next, in Section \textcolor{red}{[??]} we focus on the high-resolution shock-capturing (HRSC) finite-difference schemes. \textcolor{gray}{Finally, in Section [??????] we present discontinuous Galerkin methods.}

\textcolor{red}{note that here section is capital 'S'}

\section{Theoretical Background}
\label{sec:theory:conserv_laws:theorback}

In this section we briefly recall the basics behind the mathematical theory of conservational laws and subsequently, their numerical application. We start by defining the weak and entropic solutions, and present certain results regarding existence and uniqueness of these solutions for conservation laws. We then proceed with reviewing numerical approximation to conservation laws, as well as concepts of consistency, stability and convergence, \textcolor{gray}{briefly stating the Lax-Richtmeyer theorem}. Then we conclude with reviewing the extension to the case of non-linear equations. This section is based on the descriptions provided in \cite{LeVeque:1992,Tadmor1998}, and we refer the reader to these sources for more in-depth discussion. \\

\subsection{Conservation Laws}

Let us consider the consercation laws in the following form

\begin{align}
    \partial_t\boldsymbol{u} + \nabla\cdot\boldsymbol{f}(\boldsymbol{u}) = 0, \hspace{10mm} &(t,x)\in \text{I\!R}_{+}\times\text{I\!R}^d , \\
    \boldsymbol{u}(0, x) = \boldsymbol{u}(x), \hspace{18mm} &x\in \text{ I\!R},
    \label{eq:theory:conservlaws}
\end{align}

where $\boldsymbol{u}$ is the vector of $m$ unknowns, $\boldsymbol{f}=(\boldsymbol{\boldsymbol{f}^1,...,\boldsymbol{f}^m})$ is a $d$-dimensional flux and $\boldsymbol{u_0}\in\big[L^{\infty}(\text{I\!R}^d)\big]^m$ is the initial data. \\

Investigations of the system \ref{eq:theory:conservlaws} showed irrespective of the initial data, the solution can develop discontinuities (shocks) in a finite time. Thus, the system should be viewed in distribution formalism. There, if for all test functions $\upsilon\in C_0 ^1 (\text{I\!R}^{d+1})$ and $i=1,2,...,m$  we obtain

\begin{equation}
    \int_{0}^{\infty}\text{d}t\int_{\text{I\!R}^d}\big[u^i \partial_t\upsilon + \boldsymbol{f}^i(\boldsymbol{u})\cdot\nabla\upsilon\big]\text{d}x = \int_{\text{I\!R}^d} u_0 ^i \upsilon \text{d}x,
\end{equation}

then, the vector $\boldsymbol{u}\in\big[\text{I\!R}_{+}\times\text{I\!R}^d\big]^m$ is a \textit{weak solution} of \ref{eq:theory:conservlaws}.\\

It can be shown that that multiple weak solutions are allowed even for a scalar conservation law. Let us then consider the concept of the entropic solution. A convex function \textcolor{red}{what is it?}, $\eta(\boldsymbol{u})$, is said to be an entropy function if its Hesian \textcolor{red}{what is it???}, $\nabla_{\boldsymbol{u}}^2\eta$, symmetrizes the spatial Jacobian, $\nabla_{\boldsymbol{u}}f^i$ \textcolor{red}{WHAT IS IT?!},

\begin{equation}
    \nabla_{\boldsymbol{u}}^2\eta\cdot\nabla_{\boldsymbol{u}}\boldsymbol{f}^i = [\nabla_{\boldsymbol{u}}\boldsymbol{f}^i]^{T}\cdot\nabla_{\boldsymbol{u}}^2\eta, \hspace{10mm} i = 1, ... , m.
\end{equation}

Here we infer the compatibility relation, introducing the entropy flux $\boldsymbol{\psi} = (\boldsymbol{\psi}^1,...,\boldsymbol{\psi}^m)$, as 

\begin{equation}
    [\nabla_{\boldsymbol{u}}\eta]^T\cdot\nabla_{\boldsymbol{u}}\boldsymbol{f}^i = [\nabla_{\boldsymbol{u}}\boldsymbol{\psi}^i]^T, \hspace{15mm} i = 1,...,m.
\end{equation}

The pair $\eta\boldsymbol{\psi}$ is referred to as \textit{entropy pair}. \\

Then, the \textit{entropic solution} is a weak solution that for any $(\eta\boldsymbol{\psi})$, in the sense of   admits

\begin{equation}
    \partial_t\eta(\boldsymbol{u}) + \nabla\cdot\boldsymbol{\psi}(\boldsymbol{u})\leq 0.
\end{equation}

Concerning distributions, the \textit{entropic solution} requires that for any positive test function $\upsilon\in C_0 ^1 (\text{I\!R}_+\times\text{I\!R}^d)$ that 

\begin{equation}
    \int_{\text{I\!R}_+\times\text{I\!R}^d} \big[\eta(\boldsymbol{u})\partial_t\upsilon + \boldsymbol{\psi}(\boldsymbol{u}) \cdot \nabla\upsilon \big]\text{d}t\text{d}x = 0
\end{equation}

It is possible to show \cite{LeVeque:1992}, that this condition in a scalar cast is equivalent to making characteristic line impinged into shock waves. This constitutes the the process that resulted in a shock forming is irreversible and that the time-symmetry is not longer applies. \\

Considering the scalar case, where $m=1$, it is possible to prove the existence and uniqueness of the entropic solution under very general conditions \cite{Kruzkov:1970}. It s is also can be extended to measure-valued solutions \cite{DiPerna:1985} and to the case of conservation laws on manifolds \cite{Benartzi:2007}. \\

On the other hand, uniqueness and stability of entropic solutions is not well understood in case of systems of conservation laws, as not even the existence of $(\eta\boldsymbol{\psi})$ for the general system of equation has been proven. In \cite{Chen:2009} a novel approach has been employed, based on divergence-measure vector fields. For one dimensional
Riemann problem, where the initial data in a form 


\begin{equation}
    \boldsymbol{u}_0(x) = 
    \begin{dcases}
        \boldsymbol{u}^L, \hspace{5mm} \text{if } x<0; \\
        \boldsymbol{u}^R, \hspace{5mm} \text{if } x>0.
    \end{dcases}
\end{equation}

it allowed to prove the existence, uniqueness and stability of the entropic solution of the Euler equations for a classical ideal-gas \cite{Chen:2003}. \\

However the mere exestiance of the weak solution to the Riemann problem for general equation of state is not guaranteed \cite{Curtis:1972}. (for more recent results regarding classical Euler equations, see the review \cite{Chen:2006}). \\

On the other hand, using Glimmâ€™s method \cite{Glimm:1965} in the existence of solutions to the Riemann problem was shown in the relativistic case but for the ultrarelativistic equation of state \cite{Smoller:1993}. \\

For \textit{strictly hyperbolic systems} \textit{i.e.,} when $\nabla_{\boldsymbol{u}}\boldsymbol{f}$ has a complete set of real eigenvalues and eigenvectors, the existence of weak solutions was proven in case when the initial data having small enough initial jump \cite{Lax:1957}.

\subsection{Consistency, Stability and Convergence}

Now we consider how the conservation laws can be treated numerically. We limit the discussion to the $m=1$ case, as the non-linear theory is well established only for the scalar fields. Thus we define a problem as 

\begin{align}
    \partial_t u + \nabla\cdot\boldmath(u) = 0&, \hspace{10mm} (t,x) \in I\!R_{+}\times I\! R^d \\ 
    u(0, x) = u_o(x)&, \hspace{15mm} x\in I\!R^{d},
\end{align}

where $u$ is now just a scalar function. \\

Let us introduce the following notation. The form of equations \ref{eq:theory:conservlaws} allows us to view the solution to this system in a form of a "curve" in an infinite dimensional vector sapce $L^{\infty}I\!(R^d)$, or as a sequence of bounded functions $u(t,\cdot)\in L^{\infty}(I\! R^d)$, that we can consider only being functions of time $u(t)$ with values in the vector space. Owing to the curve being bounded in $L^{\infty}(I\!R^d)$, the sequence of bounded functions read $u(t)\in L^{\infty}[I\!R_{+};L^{\infty}(I\!R^d)]$. Then the system  \ref{eq:theory:conservlaws} can be seen as a system of ordinary differential equations (ODEs), which can be represented as 

\begin{equation}
    \frac{\text{d}u(t)}{\text{d}t} = \mathcal{L}[u(t)], \hspace{10mm} u(0) = u_0,
    \label{eq:theory:conservlawsode}
\end{equation}

where we associate the operator $\mathcal{L}(\cdot)$ with the $-\nabla\cdot\boldsymbol{f}(\cdot)$. It is important to remember, that as the $u(t)$ is not a smooth function of time, the equation \ref{eq:theory:conservlawsode} should be considered from a point of view of distributions. In addition, we note that stating $u(0) = u_0$ is in all mathematical rigor is a restriction of general functions $L^{\infty}[I\!R_{+};L^{\infty}(I\!R^d)]$ to the set of zero Lebesgue measure, which is not define. For the purpose of keeping the discssion brief we refer to the \cite{Kruzkov:1970} for the related discussion. For the numerical applications we further restrict $u(t)$ to be a smooth function of time, and leave the mathematical subtleties out of discussion.  \\

Transitioning from general formulation \ref{eq:theory:conservlaws} to one adopted for a scalar function $u(t)$ \ref{eq:theory:conservlawsode}, we can introduce the numerical approximation, that is depended in a discrimination parameter $\Delta$. This approximation reads

\begin{equation}
    \frac{\text{d}u^{\Delta}(t)}{\text{d}t} = L^{\Delta}[u^{\Delta}(t)], \hspace{10mm} u^{\Delta}(0) = P^{\Delta}[u_0],
    \label{eq:theory:conservlawsodepde}
\end{equation}

where $u^{\Delta}$ and $L^{\Delta}$ are approximations of $u$ and $\mathcal{L}$, \textit{i.e.,} $u^{\delta}\approxeq u u$, $L^{\Delta}\approxeq \mathcal{L}$ and $P^{\Delta}$ is a projection operator. However, as the error associated with it is negable in comparison with other errors arizing in discritisation of conservation laws, we will ignore it, effectively assinging that $u^{\Delta}(0) = u_0$. One of such errors is the trucaction error. \\
The \textit{ local truncation error} can be defined as 

\begin{equation}
    r^{\Delta} = L^{\Delta}[u(t)] - \mathcal{L}[u(t)],
\end{equation}

where $u(t)$ is the exact solution to \ref{eq:theory:conservlaws}. We call a numerical scheme \textit{consistent} if the $r^{\Delta}\rightarrow 0$ when $\Delta\rightarrow 0$ in a given norm for all possible initial data $u_0$. Note, however, that the choice of norm is problem- and method- dependent and may limit the allowable initial data. \\

We then call a scheme to be of order $r$ if 

\begin{equation}
    || r^{\Delta}(t) || = \mathcal{O}(\Delta^r).
\end{equation}

\begin{sidenote}
    \textbf{Infimum and Supremum} \\
    Im math, the \textit{infimum (inf)} of a subset $S$ of a partially ordered set $T$ is the greatest element of $T$ that is less than or equal to all elements of $S$. \\
    The \textit{supremum (sup)} of a subset $S$ of a partially ordered set $T$ is the least element in $T$ that is greater than or equatl to all elements of $S$. The upper bound of a subset $S$ of a partially ordered set (P,$\leq$) is an element $b$ of $P$ such that $b\geq x$ for all $x$ in $S$. If a supremum of a subset $S$ exhists it is unique. The supremum of a subset $S$ of partially ordered set $P$ does not necessearly belongs to $S$. But if it does, it is the maximum, or the greatest element of $S$. \\
    Examples of suprema.
    The supremum of a set of real numbers of $\{1,2,3\}$ is $3$. The number $4$ is an upper bound but it is not the least upper bound and hence not the supremum. \\
    \begin{align}
        \sup\{x\in\text{I\!R}|0<x<1\} = 1. \\
        \sup\{(-1)^n - 1/n | n = 1,2,3,... \} = 1. \\
        \sup\{x\in\mathbb{Q} | x^2 < 2\} = \sqrt{2}
    \end{align}
\end{sidenote}

A scheme is considered to be \textit{stable} if the norm $L^{\Delta}$ is limited 

\begin{equation}
    |||L^{\Delta}||| := \sup \frac{||L^{\Delta}||}{||\upsilon||}\leq C,
\end{equation}

where $C\geq 0$ is a constant independent of $\upsilon$. \\
A scheme is considered to be \textit{convergent} if 

\begin{equation}
    \lim_{\Delta\rightarrow 0} ||u^{\Delta}(t)-u(t)|| = 0, \hspace{10mm} \text{a.e. } t\in \text{I\!R}_{+}.
\end{equation}

The relation between the consistency, stability and convergence is given by the Lax-Richtmeyer equivalence theorem \cite{Lax:1956}. It states that the numerical approximation of well-posed problems is convergent if and only if the scheme is stable and consistent. In addition, consider a scheme of the order $r$, then

\begin{equation}
    || u^{\Delta}(t) - u(t) || = \mathcal{O}(\Delta^r).
\end{equation}

However, in the non-linear case, the \textit{non-linear stability} is required in addition to the stability and consistency are to assure convergence. 

\subsection{Non-Linear Equations and Non-Linear Stability}

The system \ref{eq:theory:conservlawsodepde} is a system of ordinary differential equations, where the discritisation of time has to made as well as space. However, up to now we were discussing only the latter, introducing the operator $\mathcal{L}$ and its approximation $L^{\Delta}$. The reason for that is the following. The spatial discritisation introduces much more prominent truncation error than the time descritisation, which allowed us to limit the discussion of non-linear conseravation laws to different choices in constructing $L^{\Delta}$. However, the properties of the time discritisation start to play an important role in the context of non-linear stability and convergence of numerical schemes in the non-linear case. Thus, we shall discuss a \textit{fulli descrete} schemes. \\

Let us start by introducing a one-parameter family of evolution operators $\{\mathcal{T}_{s\in\text{I\!R}_+}\}$. Following \cite{Kruzkov:1970}, the $\{\mathcal{T}_{s\in\text{I\!R}_+}\}$ allows an operation of composition that forms a semi-group and the $\mathcal{T}_t(u_0)$ yields a solution \ref{eq:theory:conservlaws} at a time $t$, given the initial data $u_0$, \textit{i.e.,}

\begin{equation}
    u(t) = \mathcal{T}_t(u_0), \hspace{10mm} \mathcal{T}\circ\mathcal{T}_t = \mathcal{T}_{t+s}.
\end{equation}

Its descrete version then

\begin{equation}
    u^{\Delta}(k\Delta t) = T^{\Delta}_{\Delta t}(u_0), \hspace{10mm} T^{\Delta}_s\circ T^{\Delta}_t = T^{\Delta} _{t+s}
\end{equation}

\textit{i.e.,}

\begin{equation}
    u^{\Delta}(t+\Delta t) = T^{\Delta} _{\Delta t}[u^{\Delta}(t)]
\end{equation}

in a fully desrete form. \\

Importantly, there is only one discretization parameter $\Delta$ for time and space. This is allows due to the  Courantâ€“Friedrichsâ€“Lewy (CFL) condition, which is in essence a linear stability condition of a time-integrator, that links two discretizations. \\

For a fully-discrete from, the truncation error reads 

\begin{equation}
    r^{\Delta}(t) = T^{\Delta}_{\Delta t}[u(t)] - u(t + \Delta t) = T^{\Delta}_{\Delta t}[u(t)] - \mathcal{T}_{\Delta t}[u(t)],
\end{equation}

where $u(t)$ is the exact solution to \ref{eq:theory:conservlaws}. \\
For the consistency, it is required that the norm $||\cdot||$, $||r^{\Delta}(t)||\rightarrow 0$ when $\Delta\rightarrow 0$. \\
A scheme is said to be of an order $r$ if $||r^{\Delta}(t) = \mathcal{O}(\Delta^r)||$. \\
A scheme is regarded to be linearly stable if 

\begin{equation}
    |||T^{\Delta}_{\Delta t}||| \leq C,
\end{equation}

where $C$ is a constant. \\

Let us consider how a numerical scheme in a non0-linear case then can be constructed. The Lax-Wendroff theorem \cite{Lax:1960} reads, that for a function $u$ to be a weak solution of \ref{eq:theory:conservlaws}, the numerically approximated solution $u^{\Delta}$ to the \ref{eq:theory:conservlawsode} obtained via conservative and consistent scheme should converge strongly. By conservative we understand a scheme such that 

\begin{equation}
    \int_{\text{I\!R}^d} T^{\Delta}_s(\upsilon)\text{d}x = \int_{\text{I\!R}^d}\upsilon\text{d}x, \hspace{10mm} \text{for any } \upsilon\in L^1(\text{I\!R}^d),
\end{equation}

where $L^1$ is norm and the strong convergence implies that this $L^1$ is the norm to the function $u$. \\

Thus, the important point is to obtain a conditions that is sufficient for a scheme to be convergent. Then, the ax-Wendroff theorem will ensure that this solution is a weak solution. It is however important to note that the theorem does not guarantee that the solution also entropic, and an additional criterion of satisfying the entropy inequality, then has to be imposed. \\

\begin{sidenote}
    \textbf{Meaasure in mathematics} \\
    measure of a set is a systematic way to assign a number to each suitable subset of that set intuitively interpreted as its size. Thus, a measure is a generalisation of length, area, volume. Example: \textit{Lebesgue measure on a Euclidean space} that assignes the conventional length area and volume to Eucledian geometry to the suitable subsets of the $n-$dimensional Eucledian space $\mathbb{R}^n$. For instance the Lebesgue measure of the interval $[0,1]$ in the real numbers is this length. \\
    Measure is a function, that assigns a non-negative real number to certain subsets of a set $X$. It mist be countably addictive. \\
    The formal defitinion: let $X$ be a set and $\Sigma$ a $\sigma$-algebra over $X$. A function $\mu$ from $\Sigma$ to the extended real number line is called measure if it sutisfies the following property:
    \begin{itemize}
        \item Non negativity: For all $E$ in $\Sigma$ we have $\mu(E)\geq 0$
        \item Null empty set: $\mu(\emptyset) = 0$.
        \item Countable addictivity or $\sigma$ addictivity: for all countable collections $\{E_k\}_{k=1}^{\infty}$ of pairwise disjoint sets in $\Sigma$: $\mu\Big(U_{k=1}^{\infty}E_k\Big) = \sum_{k=1}^{\infty}\mu(E_k)$.
    \end{itemize}
    \textbf{Lebesgue measure} \\
    This is a standart way of assigning a measure to subset of $n-$dimensional Eucledian space. For $n=1,2,3$ it coinsides with simply length, area and volume. In general it is also called a $n-$dimensional volume or $n-$volume. Usually a measure of the Lebesgue-measurable set $A$ is denoted with $\lambda(A)$. \\
    Formal definition: \\
    Given a subset $E\subseteq\mathbb{R}$ with the length of interval $I=[a,b]$ (or $I=(a,b)$) given by $l(I) = b-a$ Lebesgue outer measure $\lambda^*(E)$ is defined as 
    \begin{equation}
        \lambda^*(E) = \inf\Bigg\{\sum_{k=1}^{\infty}l(I_k):(I_k)_{k\in N} \text{ is a sequence of open intervals with } \subseteq U_{k=1}^{\infty}I_k\Bigg\}
    \end{equation}
    The first part of the definition states that the subset $E$ of the real numbers is reduced to its outer measure by coverage by sets of open intervals. Each of these sets of intervals $I$ covers $E$E in the sense that when the intervals are combined together by union, they contain $E$. The total length of any covering interval set can easily overestimate the measure of $E$, because $E$ is a subset of the union of the intervals, and so the intervals may include points which are not in $E$. The Lebesgue outer measure emerges as the greatest lower bound (infimum) of the lengths from among all possible such sets. Intuitively, it is the total length of those interval sets which fit $E$ most tightly and do not overlap.\\
    That characterizes the Lebesgue outer measure. Whether this outer measure translates to the Lebesgue measure proper depends on an additional condition. This condition is tested by taking subsets $A$ of the real numbers using $E$ as an instrument to split $A$ into two partitions: the part of $A$ which intersects with $E$ and the remaining part of $A$ which is not in $E$: the set difference of $A$ and $E$. These partitions of $A$ are subject to the outer measure. If for all possible such subsets $A$ of the real numbers, the partitions of $A$ cut apart by $E$ have outer measures whose sum is the outer measure of $A$, then the outer Lebesgue measure of $E$ gives its Lebesgue measure. Intuitively, this condition means that the set $E$ must not have some curious properties which causes a discrepancy in the measure of another set when $E$ is used as a "mask" to "clip" that set, hinting at the existence of sets for which the Lebesgue outer measure does not give the Lebesgue measure. (Such sets are, in fact, not Lebesgue-measurable.)\\
    \textbf{$L^p$ space} \\
    The $L^p$ spaces are function spaces defined using a natural generalisation of the $p-$form for a fintie-dimensitiona vector space. They are also called \textit{Lebesgue spaces}. $L^p$ spaces form an important class of \textit{Banach spaces} in functional analysis, and of topological vector spaces. \\
    \textit{$p-$form in finite dimensions} \\
    Consider a length vector $x=(x-1, x_2...,x_n)$ in the $n-$ dimensional real vector space $R^n$ is usually bien by the Euclidean norm 
    \begin{equation}
        ||x||_2 = (x_1 ^2 + ... + x_n ^2)^{1/2}.
    \end{equation}
    For real numbers the $p-$norm or $L^p$-norm of $x$ is defined by
    \begin{equation}
        ||x||_p = (|x_1|^p + ... + |x_n|^p)^{1/p}.
    \end{equation}
    \textit{$l^p$ spaces}
    an $L^p$ space may be defined as a space of measurable functions for which the $p-$th power of an absolute value is  Lebesgue integrable where functions which agree almost everywhere are identified.
    \textbf{Total variation.} \\
    The total variation of a real-valued function $f$ defined on an interval $[a,b]\subset R$ is the quantity 
    \begin{equation}
        V_b ^a (f) = \sup_{\mathcal{P}}\sum_{i=0}^{n_p -1}|f(x_{i+1} - f(x_i)|,
    \end{equation}
    where the supremum runs over the set of all partitions $\mathcal{P} = \{\mathcal{P}=\{x_0,...,x_{np}\}|P\text{ is the partition of }[a,b]\}$ of the given interval. \\
    \textit{total variation for function of $n>1$ real variables} \\
    Let $\Omega$ be an open subset of $\mathbb{R}^n$. Given a function $f$ belonging to $L^1(\Omega)$, the total variation of $f$ in $\Omega$ is defined as 
    \begin{equation}
        V(f,\Omega):=\sup\Bigg\{\int_{\Omega}f(x)\text{div}\phi(x)\text{d}x:\phi\in C_{c}^1(\Omega, \mathbb{R}), ||\phi||_{L^{\infty}(\Omega)}\leq 1\Bigg\}
    \end{equation}
    where $C_c ^1(\Omega, \mathbb{R}^n)$ is the set of continuously differentiable vector functions of compact support contained in $\Omega$ and $||\cdot||_{L^{\infty}(\Omega)}$ is the essential supremum norm. 
    \textbf{Bounded variation} \\
    A function of bounded variation also known as $BV$ dunction is a real valued function whose total variation $TV$ is bounded or finite. \\
    In case of a continous function of one variable, for that function to be of  bounded variation implies taht the distance along the direction of the $y-$axis, neglecting the $x-$axis motion contribution, traversed by a point, moving along the grap, has a finite value. \\
    In case of several variables a function $f$ defined on an open subset $\Omega$ of $\mathbb{R}^n$ is staid to have bounded variation it its distributional derivative is a vector-valued finite Radon measure.\\
    Importantly, functions of bounded variation form an algebra of dinsontinous functions whose first derivative exists almost everywhere. Thus, they can be used to define generalized solutions of nonlinear problems involving functionals. ODE, PDE.\\
    Returning to the definition of the total variation $TV$ for a function of one variable, $V_a ^b (f)$. If $f$ is differentiable and its derivative is Reimann-integrable, its total variation is the verical component of the arc-length of its graph, \textit{i.e.,}
    \begin{equation}
        VC_a ^b(f) - \int_a ^b |f'(x)|\text{d}x.
    \end{equation}
    A condinous real-valued function $f$ on the real line is said to be of bounded variation \textit{BV function} on a chosen interval $[a, b]\subset \mathbb{R}$ if its total variation is finitie, \textit{i.e.,}
    \begin{equation}
        f\in\text{BV}([a,b]) \leftrightarrows V_a ^b (f) < +\infty
    \end{equation}
    The space of bounded varaition (BV functions) can be defined as 
    \begin{equation}
        \text{BV}(\Omega) = \{u\in L^1(\Omega): V(u, \Omega) < +\infty\}
    \end{equation}
\end{sidenote}

Let us then proceed with derivation of the conditions that is sufficient for convergence. We start by introducing the total-variation of a function $u$, belonging to $L^1(\Omega)$ in a domain $\Omega$

\begin{equation}
    \text{TV}(\upsilon;\Omega):=\sup\Bigg\{ \int_{\Omega} \upsilon\nabla\cdot\boldsymbol{\phi}\text{d}x: \boldsymbol{\phi}\in [C_0 ^1 (\Omega)]^d, ||\boldsymbol{\phi}||_{L^{\infty}(\Omega)}\leq 1 \Bigg\}, \hspace{5mm} \text{ for any }\boldsymbol{\phi} \in C_0 ^1 (\Omega)
\end{equation}

where $C_0 ^1(\Omega)$ is the space of continuously differentiable vector functions $\boldsymbol{\phi}$ of compact support contained in $\Omega$ and $||\cdot||_{L^{\infty}(\Omega)}$ is the essential supremum norm. \\

It is possible to show that (\textit{e.g.,} \cite{Luigi:2002}) if $\text{TV}(\upsilon ; \Omega) < \infty$, then $\text{TV}(\upsilon ; \Omega) = |D\upsilon|(\Omega)$ where $|\cdot|$ stands for the vector-valued measure $D\upsilon$ or 

\begin{equation}
    \text{TV}(\upsilon; \Omega) = \int_{\Omega}|D\upsilon|\text{d}x
\end{equation}

where $D\upsilon$ is a gradient of $\upsilon$ is a sense of distributions. \\
Further we introduce the vector space BV, $\text{BV}(\Omega)$, that is the spce of all functions in $L^1(\Omega)$ with finite total variation. This is a Banach space with respect to the norm 

\begin{equation}
    || \upsilon ||_{\text{BV}(\Omega)} = \int_{\Omega}\big(|\upsilon| + |D\upsilon|\big)\text{d}x.
\end{equation}

The importance of BV spaces lies in the following. It was shown \cite{Conway:1966} that for any $t\geq 0$ $u(t)\in \text{BV}(\text{I\!R}^d)$, and if the initial data $u_o\in \text{BV}(\text{I\!R}^d)$, then the function $u \ in \text{BV}(\text{I\!R}\times\text{I\!R}^d)$. This constitutes the invariance property of the BV spaces. It is important to note, however, that the validity is confirmed only for scalar conservation laws. A system of conversational laws on the other can have a solution that is not BV even if the initial data was in BV space. Consider for example and Euler equation in Lagrangian coordinates. It was shown the the solution can develop vacuum regions, \textit{i.e.,} not BV, if the initial data exhibit sufficiently large variations, while still being in BV space.  Such a solution becomes an $L^1$ function or a Radon measure \cite{Chen:2006}. Another reason why BV are important is that boudned sets in BV$(\Omega)$ are sequentially compact in $L^1 _{\text{loc}}(\Omega)$ \textit{e.g.,} \cite{Luigi:2002}. This implies that for any sequence of functions $[\upsilon_n]\in\text{BV}(\Omega)$ there is a subsequence converging in the $L^1$-norm to a function $L^1 _{\text{loc}}(\omega)$. \\

Then, the goal is to construct a numerical scheme that is able to mimic the BV-invariance of the exact conservation laws. Then the Lax-Wendroff Theorem would assure that the numerical scheme that is $L^1$ stable if consistent produces a sequence of solutions, for different discritisation parameter $\Delta$, that will converge in $L^1$-norm to a weak solution as we decrease $\Delta$. It is however important to note, that not a sequence of solutions, but a union of subsequences $[u^{\Delta}]$ is produced, each of which is converging to a possible different weak solution. If this is not the case, then there exist a sequence $\{u^{\Delta_i}\}$ and $\epsilon > 0$ such that $\Delta_i\rightarrow 0 $ when $i\rightarrow \infty$ and $\text{dist}(W,u^{\Delta_i})>\epsilon$ for any $i$. Such schemes are called \textit{TV-stable}. The important propery of such scheme is, that for all initial data $u_0\in L^{\infty}(\text{I\!R}^d)\cap \text{BV}(\text{I\!R}^d)$ there exist $\Delta_0 > 0$ and $C\geq 0$ such that 

\begin{equation}
    \text{TV}(T_s ^{\Delta}(u_0); \text{I\!R}^d)\leq C \text{ for any } \Delta < \Delta_0.
\end{equation}

For example, if a scheme shows the property 

\begin{equation}
    \text{TV}(T_{\Delta t} ^{\Delta}(\upsilon_0); \text{I\!R}^d) \leq \text{TV}(\upsilon,  \text{I\!R}^d), \text{ for any } \upsilon\in L^{\infty}(\text{I\!R}^d)\cap \text{BV}(\text{I\!R}^d),
\end{equation}

it is one of the \textit{total-variation diminishing} (TVD) schemes. 

In the context of non-linear scalar conservation laws, an example of a convergent scheme is a \textit{monotone} scheme \textit{i.e.,}

\begin{equation}
    u \geq \upsilon \text{ a.e. } \rightarrow \hspace{5mm} T_{s}^{\Delta}(u) \geq T_{s}^{\Delta}(\upsilon).,
\end{equation}

and if $T_{s}^{\Delta}$ is conservative and monotone, it does satisfy the strong stability condition 

\begin{equation}
    || T^{\Delta} _{\Delta t} - T^{\Delta} _{\Delta t}(\upsilon)||_{L^1(\text{I\!R}^d)}, \text{  for any  } u.\upsilon\in L^1(\text{I\!R}^d),
\end{equation}

\textit{i.e.,} it is an $L^1$-contraction \cite{Crandall:1980proc}, which in implies that the method is TVD \cite{LeVeque:1992}. Crandall and Majda \cite{Crandall:1980} has shown that numerical solution thus, obtained with a consistent stable and momotone scheme converges to a weak solution of \ref{eq:theory:conservlaws}. In addition authors showed that the entropy inequality is satisfied by these schemes and hence the numerical solution converges to an entropic (unique) solution of the \ref{eq:theory:conservlaws}. The accuracy of the scheme has however been shown to be limited to the first order by Harten et al. \cite{Harten:1976}. Thus, while requireing a scheme to be monotonic allows for a non-linear stability, it prohibits the higher order accuracy.\\

The solution to the problem was first to use the non-linear dissipation methods that reduces convergence only locally to the tirst order in the vicinity of the dinsintiniuties. These schemes are high-order accuracy, high resolution shock-capturing (HRSC) schemes. They are not monotone, while being TVD in one dimentional case. And Goodman and LeVeque \cite{Goodman:1985} has shown that this is a limitation of TVD schemes. Than can be desigend to be any ordder of accuracy in 1D but can only but in multidminsinal caes they are at most first-order accuracy. \\

Multuple other high order accuracy schemes have been proposed whith however weaker conditions of non-linear stability and not yet fully explored convergence. For example, schemes that satisfy the maximum-principle \textit{i.e.,} such that if $m < u_0 < M$ then $u^{\Delta}(t,\cdot)\in[m, M]$. Such is the second-order central-scheme by Kurganov and Tadmor \cite{Kurganov:2000}. \\

It is however remains that the commonly used modern multidimensional HRSC schemes are not TVD or even has been shown to be TV-stable. Numerical evidence to support a hypothesis that these schemes converge to the entropic solution of conservation laws, how the mathematical proof is yet to be provided. Additionally, even the stabolity and convergence in one-dimensional case has not been forven for a general system of non-linear conservation laws, \cite{LeVeque:2002}, while there also numerical evidence for the convergence of these schemes. \\

It is believed that a more precise characterization of piecewise-regular entropic solutions of conservation laws would lead to a proof of convergence for high order schemes \cite{Tadmor1998}. Similarly, to prove the convergence of their numerical approximation likely requiresa  better understanding of the mathematical properties of systems of conservation laws. In light of a high demand for a practical approach, however, a more heuristic approach has been employed to the study of HRSC schemes for systems of conservation laws. And usually a starting point for such study is a one-dimensional scalar case for which TV-stability and convergence can be more easily explored.

\subsection{Finite-Volume Methods}

\begin{sidenote}
    \textbf{Reimann problem} \\
    Reimann problem is a specifit initial value problem composed of a conservation equation together with piece-wise constant initial data which has a single discontinuituy in the domain of interest. In numerical analysis it appears naturally in finite volume method for the solution of conservation law equations due to the discreteness of the grid. 
    \textbf{Reimann solver} \\
    A Reimann solver is a numerical method used to solve a Reimann problem. Generally speaking, Reimann solvers ar especific methods for computing the numerical flux across a discontinuityin the Riemann problem. They are wifely used in high resolution schemes. Usually, left and right states for the reimann Problem are calculated using some form on non-linear reconstraction, such as flux limiteror WENO method, and then used as inut for the reimann solver. \\
    An iterative solution to the RP is too costly, especially in MHD. Popular approximations are:
    \begin{itemize}
        \item Roe solver - using linearisation of the Jacobian, which then is solved exactly \\
        \item HLLE solver - approximate solution to the RP which is only based on the integral form of the conservational las and the largest and smallest signal velocities at the interface.
        \item HLLC solver - resotores the missing Rarefaction wave by some estiamtes, line linearesations. Efficient, But more diffusive. 
        \item Rotated-hybrid Riemann solvers. 
    \end{itemize}
\end{sidenote}

The finite-volume method, the Godunov scheme \cite{Godunov:1959}, was one of the fist \textit{monotonicity-preserving schemes}\footnote{Different from the monotonic schemes discussed above} that was able to yield solutions with discontinuities without spurious numerical extrema and with minimum numerical dissipation. There is a plethora of variations of Godunov-type, methods for conservation laws, built on top of the original method, see \textit{e.g.,} \cite{Toro:1999} for an up-to-date overview of the subject. \\
In this section we consider the basic Godunov method for the first order schemes. Then, we iterate on the second-order Godunov-type schemes, that are the most widely used in the field of relativistic hydrodynamics. In the end of the subsetion, we elaborate on the extension of FV methods to even higher orders, and pint out the difficulties arising in application to the relativistic hydrodynamics 



\subsubsection{The Godunov Method}
\textcolor{red}{my overall understanding of this method is rather poor and thus I copied David. It needs to be revised more.}

The pioneer work by Godunov \cite{Godunov:1959}, established principles that most modern hock-capturing methods are based upon. Studying the numerical approaches to linear-advection equation, the author showed that all monotonicity-preserving schemes for this equation are at most first-order accurate. The linearity the discrimination scheme was a basic assumption in this proof. As it was shown later, this assumtion has to be lifted to create a higher-order, monotonicity preserving schemes can be constructed. Boris \cite{Boris:1971} and van Leer \cite{vanLeer:1973} showed that a higer order scheme necessarily have to be nonlinear, even for linear equations. \\

In his work, Godunov has elaborated on the advantages of using the first-order upwind algorithm for the advection equation. In addition, author suggested a way to extend the method to non-linear case, establishing the Godunov scheme. \\

Let us consider a simple case of the one dimensional scalar hyperbolic equation, the advection equation

\begin{equation}
    \partial_t u + \partial_x f(u) = 0.
    \label{eq:theory:fv:adveq}
\end{equation}

that we cast on a uniformly-spaced grids in space and time 

\begin{equation}
    x_i = i\Delta^1, \hspace{5mm} i\in\mathbb{Z}, \hspace{10mm} t_n = n\Delta^0, \hspace{5mm} n\in\mathbb{N}
\end{equation}

Let us now consider control volumes, which in one dimension reduce to $[x_{i-1/2},x_{i+1/2}]$, over which the averages of $u$ read

\begin{equation}
    \bar{u}_i ^n = \frac{1}{\Delta^1}\int_{x_{i-1/2}}^{x_{i + 1/2}} u(x, t^n) \text{d}x.
\end{equation}

Averaging the avdection equation \ref{eq:theory:fv:adveq} over one control volume and one time-step we obtain

\begin{equation}
    \frac{\bar{u}_{i}^{n+1}-\bar{u}_{i}^{n}}{\Delta^0} = \frac{1}{\Delta^0}\int_{t_n}^{t_{n+1}}\big\{f[u(t,x_{i-1/2})] - f[u(t,x_{i+1/2})]\big\}\text{d}t
    \label{eq:theory:fv:intadveq}
\end{equation}

without making any approximation. We note that the computation of integrals on the r.h.s. of \ref{eq:theory:fv:intadveq} only requires to solve a sequence of Riemann problems centered at the intefaces between control-volumes.\\
To construct a FV scheme, we now approximate the integral from of the conservation law \ref{eq:theory:fv:intadveq}. At each times-step we heve an approximate solution $\{U_{i}^{n}\}_{i\in\mathbb{Z}} \approx \{\bar{u}_{i}^{n}\}_{i\in\mathbb{Z}}$ and evaluate the solution at the next time-step, $\{U_{i}^{n+1}\}_{i\in\mathbb{Z}}$. The assumption, introduced by Godunov, that allows to obtain the solution is the following. Assume that a solution can be represented as a piece-wise constant, \textit{i.e.,}

\begin{equation}
    U^n(x) = \sum_{i\in\mathbb{Z}}U_i ^n \chi_i (x)
\end{equation}

where $\chi_i(x)$ is the cahracteristic function of the control volume, \textit{i.e.,}

\begin{equation}
    \chi_i(x) = 
    \begin{cases}
    1, \text{ if } x\in[x_{i-1/2},x_{i+1/2}] \\
    0, \text{ otherwise, }
    \end{cases}
\end{equation}

then, for a sufficiently small time-step $\Delta^0$ the integral form of advection equation \ref{eq:theory:fv:intadveq} can be solved exactly. This is allowed as the Riemann problems, needed to compute the integrals in the r.h.s. of \ref{eq:theory:fv:intadveq}, are centered about the interfaces between adjacent control-volumes. Solution of these Riemann problems yields $u_{t, x_{i-1/2}}$ for all $i$ and all $t\in[t_n, t_{n+1}]$. The condition, that has to be satisfied for a time-step is the CFL condition, 

\begin{equation}
    \text{CFL}:=\frac{\Delta^0}{\Delta^1}\leq\frac{1}{c},
\end{equation}

where $c$ is the maximum propagation speed. \\
It allows for the interface value of the solution of the various Riemann problems to be computed exactly for most conservation laws, and be independent from each other. \\

The time integraion in this scheme is drasitcally simplifed as the $u(t, x_{i-1/2})$ does not depend on time \cite{LeVeque:1992}. \\

Let us summarize the the Godunov scheme

\begin{itemize}
    \item Given the solution at time $t= t_n$ as $\{U_i ^n\}_{i\in\mathbb{Z}}$, a piece-wise constant function $U^n(x)$ is constructed, such that it is only non-zero within a given control volume, \textit{i.e.,} $U^n(x) = U_i ^n$ if $x\in[x_{i-1/2}, x_{i+1/2}]$
    \item Then, the integral from of the advection equation \ref{eq:theory:fv:intadveq} is evolved exaclty for one time-step with initial data given by $U^n(x)$ to obtain $\{U^{n+1}_i\}_{i\in\mathbb{Z}}$ 
\end{itemize}

It is important to underline, that the assumption that the solution can be represented as a piece-wise constant in each control-volume, is the sole approximation of the Godunov scheme. \textcolor{red}{grphical representation... do I need it?} \\

Let us now focus on the r.h.s. of the equation \ref{eq:theory:fv:intadveq}. The solution $u(t, x_{i-1/2})$ depends on $U_{i-1} ^n$ and $U_{i} ^n$ as $u(t, x_{1/2}) =: u^* (U_{i-1}^{n}, U_{i}^n)$. It is convenient to express this dependence via \textit{numerical flux} $F(U_{i-1}^{n}):=f[u^*(U_{i-1}^{n}, U_{i}^{n})]$. The Godunov scheme is them reads

\begin{equation}
    \frac{U_{j}^{n+1} - U_{j}^{n}}{\Delta^0} = \frac{1}{\Delta^1}[F(U_{i-1}^{n}) - F(U_{i}^{n}, U_{i+1}^{n})].
    \label{eq:theory:fv:discrete}
\end{equation}

or, in the semi-descrete form:

\begin{equation}
    \frac{\text{d}U_i}{\text{d} t} = \frac{1}{\Delta^1}[F(U_{i-1}, U_{i}) - F(U_i, U_{i+1})].
    \label{eq:theory:fv:semi-discrete}
\end{equation}

To compute \ref{eq:theory:fv:semi-discrete}, a time integrator has to be chosen. The simplest option is the Euler method, which incidentally, transforms \ref{eq:theory:fv:semi-discrete} into its origignal form \ref{eq:theory:fv:discrete}. Time integrators of higher orders are not needed in this case, as the Godunov method is already exact with respect to time-update. \\

The semi-discrete form is overall useful in contracting higher order FV schemes as well as in discussing a coupling between hydrodynamic equations with some other system of equations \textit{e.g.,} the spacetime evolution equations, that is not solved using a FV scheme. We thus shall restrain ourselved to the discussion in semi-discrete form, leaving a complete discussion of FV methods for the sake of brevity. We refer the reader to \textit{e.g.,} \cite{Toro:1999} for a comprehensive description of FV methods and to \cite{Gassner:2011} for a more recent discussion regarding the higher order time discretization methods for FV. \\ 

Now, let us consider three dimensional Cartesian grid 

\begin{equation}
    \boldsymbol{x}_{i,j,k} = (i\Delta^1,j\Delta^2,k\Delta^3), \hspace{5mm} i, j, k \in \mathbb{Z},
\end{equation}

there the integral from of the FV scheme of the advection equation reads

\begin{align}
    \frac{\text{d}U_{i,j,k}}{\text{d}t} &= \frac{1}{\Delta^1}[F^1(U_{i-1,j,k}, U_{i,j,k}) - F^1(U_{i,j,k}, U_{i+1,j,k})] \\
    &+ \frac{1}{\Delta^2}[F^2(U_{i,j-1,k}, U_{i,j,k}) - F^2(U_{i,j,k}, U_{i,j+1,k})] \\
    &+ \frac{1}{\Delta^3}[F^3(U_{i,j,k-1}, U_{i,j,k}) - F^3(U_{i,j,k}, U_{i,j,k+1})]
    \label{eq:theory:fv:1storder3dscheme}
\end{align}

where $F^1$, $F^2$ and $F^3$ are the numerical fluxes associated with $f^1$, $f^2$ and $f^3$ respectively. \\


Extending the FV scheme to the multi-dimensional case and to a general unstructured grid, in a semi-discrete from we gain

\begin{equation}
    \frac{\text{d}U_a}{\text{d}t} = \frac{1}{|\Omega|}\int_{\partial\Omega}\boldsymbol{g}\cdot\boldsymbol{\nu}\text{d}\Sigma,
\end{equation}

where$\Omega_a$ is a control volume, $\boldsymbol{\nu}$ is the inwards pointing normal to $\Omega$.

As long as the solution of the Riemann problem can be constructed, the FV scheme can be applied to a system of equations. \\

%It is important to mention, that as at every time step we average the solution, $U^n(x) = \Sigma_i U_i ^n \chi_i(x)$, we destroy most of the information regarding full solution of the Riemann problem at every interface. Thus, a construction of a monotone FV scheme would required increasing the diffusivity of the method, even with the approximate Reimann solvers \cite{Harten:1983}. In case of a relativistic Euler equations, where the solution of the Reimann problem is complex, requiring iterative procedure, this property as shown be very usefull \cite{Marti:1994,Pons:2000,Giacomazzo:2005jy}. 
A popular examples or such solvers are HLLE solver \cite{Roe:1981}, the Marquina flux-formula \cite{Donat:1996} and HLLE solver \cite{Einfeldt:1988}. However, not all the flux-formulas constructed starting from an approximate solution of the original Reimann problem, \textit{i.e.},

\begin{equation}
    F(U_L, U_R) = f(u^*(U_L, U_R)), 
\end{equation}

even through being often called "approximate Riemann solvers". The $U_L$ and $U_R$ here are the left and right states across the interface. In certain cases there is a they approximate the flux-function directly. It has been further show by Harten et al. \cite{Harten:1983}, that a scheme is consistent and conservative\footnote{In particular the Lax-Wendroff theorem holds.} even if it is constructed via approximating numerical flux instead of the Godunov one, if the collowing criterion is satisfied by the flux formula

\begin{equation}
    F(u, u) = f(u) \text{ for any } u\in \mathbb{R}.
\end{equation}

Thus, a scheme converges to the correct entropic solution of the conservation law if it is non-linearly stable and the flux-formula is compatible with the entropy inequality. \\

Notably, higher order schemes have lower numerical dissipation. Thus, in high order FV schemes use of approximate flux is more justified.


\subsubsection{TVD Finite-Volume Methods}

The loss of information regarding the solution of the Reimann problem in the averaging procedure prevents us from constracting higher order FV scheme. However, it was shown, that the information on the solution can be \textit{reconstructed} from the averages $\{U_i ^n\}_{i\in\mathbb{Z}}$ using non-linear reconstruction procedure. This prevents spurious oscillations from arising. The procedure can be outlined as a following. Consider a solution withing a given control volume $U(x)$. Instead of setting $U(x) = U_i$ when $x\in[x_{i-1/2},x_{i+1/2}]$, the second order approximation of $u$ is used as 

\begin{equation}
    U_i(x) = U_i + \sigma_i(x-x_i), \hspace{10mm}x\in[x_{i-1/2},x_{i+1/2}]
\end{equation}

where $\sigma_i$ is the reconstructed slope in $[x_{i-1/2},x_{i+1/2}]$. \\

The $U_i(x)$ is essentially a profile of the solution $U$. We however set it with index $i$ as the profiles of two different control volumes might not agree at the interface between them. It is thus conveneitn to introduce the $\pm$ to indicate the from what side the slope is considered, talking about the inteface \textit{i.e.,} $U^{\pm} _{i-1/2}$ stands for $U_{i-1}(x_{i-1/2})$ and $U_i(x_{i-1/2})$. Applying this to the semi-discrete FV scheme we obtain 

\begin{equation}
    \frac{\text{d} U_i}{\text{d}t} = \frac{1}{\Delta^1}\big[F(U^{-}_{i-1/2},U^{+}_{i-1/2}) - F(U^{-}_{i+1/2},U^{+}_{i+1/2})\big]
    \label{eq:theory:fv:semi-disc-2ord}
\end{equation}

This is allowed as long as we are considering a semi-discrete formulation, as in this case the the instantaneous flux is given by $F(U_L, U_R)$, \textit{i.e.,} the solution at the interface between two cells at time $t_n ^+$ depends only on the jump between the two state $U_L$ and $U_R$. Thus, the second order scheme in time and space can be constructed, if a second order time-integrator is used in \ref{eq:theory:fv:semi-disc-2ord}. This is no longer the case in a fully descrete scheme, as $u(t, x_{i-1/2})$ is no longer time-independent. There, a solution of a generalized Riemann problem\footnote{A problem, with initial data having a piecewise linear profile} a use of predictor-corrector approach to compute the fluxes with second-order accuracy in time. \\

Now let us consider the choice of $\sigma_i$. It can be shown that if 

\begin{equation}
    \text{TV}\Bigg[\sum_{i}U_{i}(x)\chi_{i};\mathbb{R}\Bigg] \leq \text{TV}\Bigg[\sum_{i}U_{i}\chi_{i}(x);\mathbb{R}\Bigg]
\end{equation}

then the scheme \ref{eq:theory:fv:semi-disc-2ord} is TVD \cite{LeVeque:1992}. To satisfy this condition a special limiter, \textit{slope-limiter} has to be employed. The reason for that is that the scheme has to be limited to the first order near shocks to prevent oscillations. Consider an example a of a particular limiter, the \textit{minmod} limiter

\begin{equation}
    \sigma_i = \frac{1}{\Delta^1}\text{minmod}(U_{i+1} - U_{i}, U_{i}-U_{i-1}),
\end{equation}

where

\begin{equation}
    \text{minmod}(z_1,...,z_n) = 
    \begin{cases}
        \text{min}_i z_i \text{ if } z_i > 0 \text{ for any } i, \\
        \text{max}_i z_i \text{ if } z_i < 0 \text{ for any } i, \\
        0,  \text{               otherwise }.
    \end{cases}
\end{equation}

The minmod$2$ reconstruction is an another example 

\begin{equation}
    \sigma_i = \frac{1}{\Delta^1}\text{minmod}\Big[2(U_{i+1} - U_i), \frac{U_{i+1} - U_{i-1}}{2}, 2(U_i - U_{i-1})\Big].
\end{equation}

Notably, most of the slop-limiting techniques are only first order accurate at extrema. \\

The extension of a TVD FV scheme to a multi-dimensions is a Cartesian grids is done via a direction-by-direction approach. For an unstructured grid, however, the reconstruction in barycentric coordinates has to be performed. 

To extend the sheme to a system of equations the reconstraction can be performed component-vise. In case of the the relativistic Euler equation, the fact that $\bar{u}_i = u(x_i)$ is of second order accuracy is often unitized. It is usually conventient and less computationally expensive to perform the reconsturction in primitive variables, as the vallues at the interface are less likely to be unphysical. 

\textcolor{red}{what is actually reconstraction?..}

\subsubsection{Higher-Order Finite-Volume Methods}

In the previous subsection we showed that the extension of the Godunov scheme to second order can be achieved via introducing the profile $\sigma_i$, or a slope. This we effectively performed a linear regression of the solution $u$. This can be extended to a polynomial regression, to express the solution $u$ as a piecewise polynomial. The reconstruction however, becomes more involved.

\paragraph{Reconstruction Operators}

Let us beging with a simple one-dimensional case and expand on it later. Let $\upsilon(x)$ be a generic function whose volume average is 

\begin{equation}
    \widetilde{\upsilon}_i := \frac{1}{\Delta^1}\int_{x_{i-1/2}}^{x_{i+1/2}}\upsilon(x)\text{d}x.
\end{equation}

and consider how it can be reconstructed at higher orders. A non-linear operator  $\mathcal{R}$ that allows that returns a high-order approximation of $\upsilon$ at a given point $x$ from $\widetilde{\upsilon}$ volume averages, is a reconstruction operator. As, in general, function $\upsilon(x)$ can contain discontinuities, lift-biased ($\mathcal{R}^-$) and right-biased ($\mathcal{R}^+$) reconstruction operators. Consider an $\mathcal{R}$ reconstraction operator of order $r$, that acts on a set of averages $\{\widetilde{\upsilon}_i\}$, then

\begin{align}
    [\mathcal{R}^{-}(\{\widetilde{\upsilon}_{i}\})](x) &= \lim_{y\rightarrow x^{-}} \upsilon(y) + \mathcal{O}(\Delta^r), \\
    [\mathcal{R}^{+}(\{\widetilde{\upsilon}_{i}\})](x) &= \lim_{y\rightarrow x^{+}} \upsilon(y) + \mathcal{O}(\Delta^r).
\end{align}

The result of acting with $\mathcal{R}^-$ ($\mathcal{R}^+$) on the $\upsilon$ is then at $x_{i+1/2}$ is $\upsilon^{-}_{i+1/2}$ ($\upsilon^{+}_{i+1/2}$). Examples of reconstruction operators are: the piecewise parabolic method (PPM) \cite{Colella:1984,Colella:2008}, the piecewise hyperbolic method (PHM) \cite{Marquina:1994}, the essentially nonoscillatory (ENO) \cite{Harten:1987,Shu:1988,Shu:1989}, weighted essentially non-oscillatory (WENO) \cite{Liu:1994,Jiang:1996} and monotonicity-preserving (MP5) \cite{Suresh:1997} algorithms. \\
The PPM reconstruction is based on the piece-wise parabolic interpolation, that extends the slope-limiter approach. Series of limiters used in PPM have been extensively investigated for the presence of spurious oscillations, and even though this method has not been shown to be TVD, it is widely used in many FV schemes and in numerical relativistic hydrodynamics \cite{Baiotti:2004wn,Mignone:2005ns}\\
The ENO reconstruction scheme employs standard Lagrange interpolation. It can, in principle  be extended to any order of as it utilizes the recursive procedure. By selecting a stencil that yields the smoothest solution it allows to avoid Gibbs oscillations due to interpolation across discontinuities. And while the ENO scheme is not TVD, it was shown that 

\begin{equation}
    \text{TV}[\mathcal{R}(\{\widetilde{\upsilon}_i\}); \text{I\!R}] \leq \text{TV}[\{\widetilde{\upsilon}; \text{I\!R}\}] + \mathcal{O}\big((\Delta^1)^r\big)
\end{equation}

where $r$ is thge order of reconstruction \cite{Harten:1987}. \\

In the WENO scheme a weighted average of the reconstructed polynomial on each stencil is taken instead of selecting the one with which yields smoothest solution. The order of accuracy is maximized in smooth regions, while non-smooth stencils are suppressed through small weights. Thus, by combining results from multiple reconstructions, it achieves the $2r-1$ order of accuracy (where $r$ is an order of accuracy of ENO scheme). This is a modified ENO approach that considerably reduces the computational resources needed, as the conditional statements are removed. Generally, WENO schemes of order below 7 ($r\leq 4$) are used. Higher order schemes have shown to be unstable without special order-reducing techniques \cite{Gerolymos:2009,Tchekhovskoy:2007zn} or additional limiters \cite{Balsara:2000}.\\
Examples of the WENO schemes,with respect to how the weights are constructed are the following. In mapped-WENO scheme reduced dissipation is achieved via mapping procedure \cite{Henrick:2005}. In WENOZ scheme, improved non-linear weights are prescribed, that yields a results comparable with the fifth order mapped-WENO scheme, while being less computationally expensive. 

In a extensive study, Gerolymos et al. \cite{Gerolymos:2009} have compared various WENO schemes, providing tabulated coefficients and implementation details.\\

The basic WENO reconstruction yilelds the smoothosts soluton, utililizing the smoothness indicator, that, in case of the smooth solution maximizes the order of accuracy, while minimizing it when the discontinuities are detected. The final solution is then an weighted average of a set of lower order reconstructions of $\widetilde{\upsilon}_i '$ on numerous overlapping stencils. A different approach in employed in a bandwidth-optimized WENO schemes, where wieghts are adjusted to minimize the attenuation of high-frequency modes, instead of maximising the smopoothness of the solution. \\
In the basic WENO scheme, the smooth function is constructed in a ways as to much as many terms as possible in a Teylor decomposition of a target function. In a bandwidth-optimized WENO scheme, the function is constracted in a way as to provide the best approximation to the Fourier coefficients of the targeted function. In addition, "over-adaptation" is prevented by using the modified non-linear smoothness indicators. This allows to reduce the numerical dissipation. We refer the reader to \cite{Martin:2006} and \cite{Taylor:2007} for more detailed discussion. \\

The MP5 scheme utilizes the fifth order reconstraction alongside with flattening prcedure, that prevents the artificial extrema in the targeted function from arising. Esseincially, it is a monotonicity-preserving PPM scheme, extended to fifth order. By design, the reconstraction sheme, does not introduce spurious oscillations. This is hiwever, not certain in case of WENO schemes. Meanwhile, the MP5 scheme contains multiple conditional stataemtens in limiting procedure, that are absent in WENO.

\paragraph{Very-High-Order Finite-Volume Schemes}

A high order version of FV method in 1D can be constracted following the procedure we outlined in desiging the second-order FV scheme. Making use of high order, non-oscillatory reconstruction operators $\mathcal{R}$, that we split into $\mathcal{R}^+$ and $\mathcal{R}^-$, that when acting on a suluition $U$ yield $U^+$ and $U^-$, we write 

\begin{equation}
    \frac{\text{d}U_i}{\text{d}_t} = \frac{1}{\Delta^1}[F(U^{-}_{i-1/2},U^{+}_{i-1/2}) - F(U^{-}_{i+1/2},U^{+}_{i+1/2})],
\end{equation}

in semi-discrete form. \\
An such a scheme would have the order of accuracy equal to the one of the reconstruction algorithm. However, as the algorithms always fall to the first order near in the vicinity of discontinuities, the actual accuracy order would depend on the solution. \\

A seemingly simple approach of extending high order FV to multi-dimensional case, however, faces a serious challenge. In the formula \ref{eq:theory:fv:1storder3dscheme} we have use simple fluxes, which for a high order schemes have to be computed via suitable quadrature formulas. This makes the sheme complex. \\

In addition, with respect to the system of equations, to avoid spurious oscillations in higher order schemes, the reconstruction needs to be performed on local characteristic variables, instead of previously mentioned, component-vise approach. \\

Moreover, as it is generally not possible to preserve higher order accuracy in conversion from volume-averaged conserved variables to volume-averaged primitive ones. Thus, the reconstruction have to be done in terms of the former. \\

The high-order FV schemes coupled with general relativity become numerically very expensive. The reason for that is that they require high-order quadrature of the metric source terms as well as high-order
schemes to interpolate the metric at the quadrature points for the calculation of the fluxes. \\

Overall, even though considerable complexities involved, high order FV schemes, due to their unmached accuracy in compariosn with other second-order schemes, make them partular usefull in multiple applications in Newtonian and relativistic hydrodynamics, (see \textit{e.g.} \cite{Tchekhovskoy:2007zn}) and in unstractured grid applications, using generalized WENO scheme (see \textit{e.g.,} \cite{Dumbser:2007})

\subsection{Central Methods}

A central scheme is a scheme the monotone scheme that does not requrie aa Reimann solver. First such scmee was developed by Lax and Friedrichs (LxF) \cite{Lax:1954,Friedrichs:1954}. It has however a larger numerical dissipation in comparison to Godunov scheme, but it is simpler to implement and less expensive. Its lack of accuracy due to numerical dissipation prevents this scheme from being a popular choice. \\
A second order central scheme was developed by Nessyahu and Tadmor (NT) \cite{Nessyahu:1990}. Kurganov and Tadmor (KT) \cite{Kurganov:2000} have further advanced the scheme, which populirized high-order central schemes. \\
The Lax-Friedrichs scheme can be understood when a \textit{dual grid} is introduced into the Godunov scheme as follows. Consider a time $t_n$, and the numerical solution $U^n$, its local averages are then given by $\{U_{i}^{n}\}_{i\in \mathbb{Z}}$. To obtain a solution at the time $t_{n+1}$, we compute the local averages of the solution on a dual grid $\{x_{i+1/2}\}_{i\in\mathbb{Z}}$, \textit{i.e.,} $\{U_{i+1/2}^{n+1}\}_{i\in\mathbb{Z}}$ in the center. Hence, the name of the scheme. The following steps go through alternating between the \textit{primal} and \textit{dual} grids. \\
In more detains, consider a solution $\{U_{i}^{n}\}_{i\in \mathbb{Z}}$ as a starting point. To obtain $\{U_{i+1/2}^{n+1}\}_{i\in \mathbb{Z}}$, we employ the Godunov scheme for the advection equation \ref{eq:theory:fv:adveq} 

\begin{equation}
    \frac{U_{i+1/2}^{n+1} - U_{i+1/2}^{n}}{\Delta^0} = \frac{1}{\Delta^1}\int_{t_n}^{t_{n+1}}\big\{ f[u(t,x_i)] -f[u(t,x_{i+1})]  \big\}\text{d}t.
    \label{eq:theory:fv:central:intadveq}
\end{equation}

Note,  solution at cell centers remain free of discontinuities for duration of a timestep if the CFL $\leq 1/2 a$, $a$ is the maximum local-characteristic speed. Thus the r.h.s of \ref{eq:theory:fv:central:intadveq} can be computed via a simple quadrature in time, without Reimann solvers. \\

Let us consider a solution, $U^n(x)$, that line in Godunovscheme, is a piecewise constant 

\begin{equation}
    U^{n}(x) = \sum_i U_{i}^{n}\chi_i(x),
\end{equation}

then $u(t,x_i) = U_{i}^{n}$ for $t\in[t_n. t_{n+1}]$ and 

\begin{equation}
    U_{i+1/2}^{n} = \frac{U_i ^n + U_{i+1}^n}{2}
\end{equation}

and the \ref{eq:theory:fv:central:intadveq} reads as

\begin{equation}
    U_{i+1/2}^{n+1} = \frac{U_i ^n + U_{i+1}^n}{2} + \frac{\Delta^0}{\Delta^1}[f(U_i ^n) - f(U_{i+1} ^n)]
\end{equation}

\textcolor{red}{graphical representation -- fig 3.2 -- is it needed?}

Nessyahu and Tadmor \cite{Nessyahu:1990} have introduced the second order central scheme. Instead of piecewise constant reconstruction, they employed a minmod to obtain a piecewise linear approximation of $u^n$, and for time flux quadrature, they used a predictor-corrector approach. \\

The dissipation of of the LxF and NT schemes is time-step depended. For a small $\Delta^0$ it makes schemes very dissipative. To improve the accuracy of the scheme Kurganov and Tadmor \cite{Kurganov:2000} proposed to limit the averaging on the dual grid to the region of spacetime spanned by the largest characteristics of the Riemann problem. Thus, while in the LxF and NT schemes the averging of the solution was supported in the whole grid, in the KT scheme, $U^{n+1}_{i+1/2}$ is only allowed in the region where affected by the results of the local Riemann problem. This reduces the dissipation and also allows the semi-descrete formulation 

\begin{equation}
    \frac{\text{d} U_i}{\text{d} t} = \frac{1}{\Delta^{1}}\big[F(U_{i-1/2}^{-},U_{i-1/2}^{+}) - F(U_{i+1/2}^{-},U_{i+1/2}^{+})\big],
\end{equation}

where $F$ are numerical fluxes \textit{i.e.,}

\begin{equation}
    F(U_L, U_R) = \frac{f(U_L) + f(U_R)}{2} - \frac{a}{2}[U_R - U_L].
    \label{eq:theory:fv:central:fluxes}
\end{equation}

Essentially, the KT scheme is very similar to the Godunov scheme with fluxes evaluated through equation \ref{eq:theory:fv:central:fluxes}, Rusanov fluxes \cite{Kurganov:2000}. This also assures the stability of the system when $1/2 < a \cdot \text{CFL} \leq 1$. However, in that case the interpenetration of the scheme is no longer applicable. \\

Lastly, we revisit the difference between the finite-volume (upwind) and central shemes. The main one lies in the constraction of these schemes, as in their form the latter can alwasy be regarded as a FV scheme with added Rusanov "Reimann solver". In particular, only for KT scheme, the maximum principle without additioanl "maximum-principle enforcing limiters" was proven in multi-dimensional case. \\


\subsection{Finite-Difference Methods}

In the high order upwind finite difference (FD) schemes the approximation is done point-wise instead of averaging over volumes as it is done in FV schemes. Interestingly, these schemes were proposed as better performing alternatives to ENO and WENO schemes of very high order. \cite{Shu:1988,Shu:1989,Jiang:1996}. Especially in the multi-dimensional case, FD schemes are much more superior to the high order FV schemes in turms of efficiency. \cite{Shu:1999,Shu:2003}. \\

Here we aim to discuss finite difference high resolution shock capturing schemes in very brief manner. We refer the reader to specialized literature for a in-depth discussion. In particular, for the discussion of FD ENO/WENO HRSC schemes see \cite{Shu:1999}, and for FD MP5 scheme -- see \cite{Mignone:2010}. \\

Let us start by introducing a system of hyperbolic balance-laws as

\begin{equation}
    \partial_t\boldsymbol{F}^0(\boldsymbol{u}) + \partial_i\boldsymbol{F}^i(\boldsymbol{u}) = \boldsymbol{S}(\boldsymbol{u}).
    \label{eq:theory:fd:hypsys}
\end{equation}

For the grid, we employ a uniform Cartesian for the ease of discussion 

\begin{equation}
    \boldsymbol{x}_{i,j,k} = (i\Delta^1, j\Delta^2, k\Delta^3), \hspace{5mm} i,j,k\in \mathbb{Z}.
\end{equation}

In the following discussion, we will not elaborate on the comparison between different representations of a solution \textit{i.e.,} exact, volume averaged, their approximations, reconstractions. We thus only need, for a quantity $u$, to define the numerical approxiamtion at a given point $x_{i,j,k}$, as $u_{i,j,k}$. 

For the \ref{eq:theory:fd:hypsys} the FD scheme reads

\begin{align}
    \frac{d\boldsymbol{F}^{0}_{i,j,k}}{dt} = \boldsymbol{S}_{i,j,k} &+ \frac{\boldsymbol{F}^{1}_{i-1/2,j,k} - \boldsymbol{F}^{1}_{i+1/2,j,k}}{\Delta^1} \\
    & + \frac{\boldsymbol{F}^{2}_{i,j-1/2,k} - \boldsymbol{F}^{2}_{i,j+1/2,k}}{\Delta^2} + \frac{\boldsymbol{F}^{3}_{i,j,k-1/2} + \boldsymbol{F}^{3}_{i,j,k+1/2}}{\Delta^3},
\end{align}

which is identical to the semi-descrete form of the finite volume scheme introduced before \ref{eq:theory:fv:1storder3dscheme}. However, there terms $\boldsymbol{F}^{1}_{i-1/2,j,k} - \boldsymbol{F}^{1}_{i+1/2,j,k}$ represented integrals of the control volumes along the boundary. If FD scheme, these are direct (high-order, non-oscillatory) approximations of the point-wise value of $-\partial_1 F^1$ at a point $x_{i,j,k}$. \\

Note, that as at the second order the volume averages and point-wise values are the same, the FD and FV schemes read identically. The difference becomes important at higher orders and in many dimensions, especially for the performance of a scheme. Consider the FD high order multi-dimensional scheme, At region boundaries, it does not require any quadrature, Reimann solvers or extra primitive recovery calls \textcolor{gray}{while still requiring reconstruction operators}. This makes a schemem much less computationally expensive. In addition, In general relativistic hydrodynamics, the source term treatment is simpler and more direct, as onlu the point-wise values are requried. This helped popularize the FD for GRHD applications. \\

For the following discussion on the computation of the descrete derivatives on the r.h.s onf the \ref{eq:theory:fd:hypsys}, let us first approach this task in case of a simple equation, the one-deminesiona advection eqiation \ref{eq:theory:fv:adveq}, which is also hyperbolic scalar equation. 

In FV scheme, the reconstraction operators are used to evaluate the left $U_L$ and right $U_R$ from which, via approximate Reimann solvers, the fluxes are computed after. In FD schemes the reconstruction operators are also used, but to evaulate the (non-oscillatory approximation) of $\partial_x f$, referenced above. It is convenient to express $f$ as follows

\begin{equation}
    f\big[u(x_i)\big] = \frac{1}{\Delta}\int_{x-1/2}^{x+1/2}h(\xi)d\xi,
    \label{eq:theory:fd:introd_h}
\end{equation}

where we, following \cite{Shu:1988}, employed function $h(x)$ in a manner that its average between $x_{i+1/2}$ and $x_{i-1/2}$ stands for the value of $f$ at $x_i$. Then, 

\begin{equation}
    \frac{\partial f}{\partial x}\Big|_{x_i} = \frac{h(x_{i+1/2}) - h(x_{i-1/2})}{\Delta}.
    \label{eq:theory:fd:diff_via_h}
\end{equation}

That that there were no approximations done in writing \ref{eq:theory:fd:introd_h} and \ref{eq:theory:fd:diff_via_h}. This allows to obtain an approximation to the derivative $\partial f/\partial x$ at $x_i$ of accuracy $r$, -- the same order as the reconstraction operator $\mathcal{R}$, that was used to recover $h_{i+1/2}$. In addition, as only the values at $x_i$ of $f$ are needed for computation, $h$ is never computed at any time. \\

The stability of the scheme is assured by correctly upwinding the reconstraction. Consider the case of $f'(u)>0$. Then, if we allow

\begin{equation}
    \widetilde{\upsilon}_i = f\big[u(x_i)\big] = \frac{1}{\Delta}\int_{x_{i-1/2}}^{x^{i+1/2}}h(\xi)d \xi
\end{equation}

and 

\begin{equation}
    f_{i+1/2} := \upsilon_{i+1/2} ^{-}, \hspace{10mm} f_{i-1/2} := \upsilon_{i-1/2} ^{-},
\end{equation}

then

\begin{equation}
    \frac{\partial f(u)}{\partial x} = \frac{f_{i+1/2} - f_{i-1/2}}{\Delta} + \mathcal{O}(\Delta^r)
\end{equation}

yields the required high order approximation to $\partial_x$ at $x_i$. \\

In a more general case, where the beahviour $f'(x)>0$ is not assured, the flux $f$ is split in a left-goping $f^{-}$ and right-going $f^{+}$ as $f = f^{+} + f^{-}$, for which separate upwind reconstructions are used to assure the stability. Note that this procedure is rather similar application of a Reimann solver in finite volume schemes. In some cases the direct correspondance between the flux-splitting methods and particualr Reimann solvers can be established. \\

We consider here tow ways, how the flux splitting can be done. The ones that are of relevents to this theiss are: \textit{Roe flux-split}, \textit{i.e.,}

\begin{equation}
    f = f^{\pm}, \text{  if  } [f'(\bar{u})]_{x_{i+1/2}} \lessgtr 0
    \label{eq:theory:fd:roefluxsplit}
\end{equation}

where $\bar{u}_{x+1/2} := (1/2) (u_i + u_{i+1})$, 

and the Rusanov flux-split \cite{Shu:1997} \textit{i.e.,}

\begin{equation}
    f^{\pm} = f(u) \pm \alpha u, \hspace{5mm} a \max[f'(u)],
    \label{eq:theory:fd:laxfluxsplit}
\end{equation}

where the maximum is taken over the reconstruction operator stencil. \\ 

With respect to the efficiency, the Roe flux splittes appears superiour, as it requires only one reconstraction. However, it was shown \cite{LeVeque:1992} that, if the transonic refraction waves are pesnet, this flux splitter can lead to the formation of entropy-violating shocks. In addition, the flux splitter is a odd-even decoupling phenomenon \cite{Quirk:1994}. One of the solutions was suggested in \cite{Radice:2012cu} to replace Roe flux split with Lax-Friedrichs one when $u$ or $f$ are not monotonic within the reconstruction stencil. 

It is important to note that in our discussion an implicit assumption is made that the function $f$ is convex. In case of relativistic hydrodynamics this is indeed so, however, -- not in the case of relativistic-magneto-hydrodynamics. \\

In addition, in \cite{LeVeque:1992}, a more strict condition imposed on the where Roe flux splitter has to be used instead of Lax-Friedrichs. \textcolor{red}{Our implementation is based on the experience, that a more frequent usage of Roe splitter, decreases comutational costs, as $u$ and $f$ are already computed on the grid, while $f'(u)$ is not. This appears to be sufficient to avoid odd-even decoupling in the tests performed. All the results shown in this thesis, obtain using this Roe-split with this "entropy fix" [This is David's work. Not theory. Not sure how to incorporate it.]} \\

Now, let us consider the general system of hyperbolic balance-laws \ref{eq:theory:fd:hypsys}. The spatial derivatives of the fluxes $\partial_{\alpha} F_{i,j,k} ^{\alpha}$ can be evaluated via a component-by-component approach using the algorithm described above. And while, this is sufficient for lower (up to the second) order schemes, in higher order ones it excites spurious numerical oscillations.
This problem can be alleviated if reconstraction is done on local characteristic variables of the ssystem. For simplicity, let us consider a one-dimensional case $\alpha={0,1}$. Then, the we employ Jacobian matrices

\begin{equation}
    \boldsymbol{A}^{\alpha} = \frac{\partial \boldsymbol{F}^{\alpha}}{\partial u}\Big|_{\bar{\boldsymbol{u}}}, \hspace{5mm} \alpha = 0,1,
    \label{eq:theory:fd:jacobreconstr}
\end{equation}

where 

\begin{equation}
    \bar{u} := \frac{1}{2}(u_{i,j,k} + u_{i+1,j,k}),
    \label{eq:theory:fd:aver_ubar}
\end{equation}

to reconstract the fluxes $F^1 _{i+1/2, j, k}$. The $\bar{u}$ is the average state at the point of reconstruction. \\

Notably, the average \ref{eq:theory:fd:aver_ubar} and present in \ref{eq:theory:fd:roefluxsplit} and \ref{eq:theory:fd:jacobreconstr} is considerably less complicated then the ones proposed in \cite{Roe:1981}. It was shown that the use of $\bar{u}$ \ref{eq:theory:fd:aver_ubar} instead of averaging proposed in \cite{Roe:1981} has no significant impact on the quality of the solution in FD schemes, even when relativistic case is concerned. \\

As the \ref{eq:theory:fd:hypsys} is strongly hyprebolic, the matrix $\boldsymbol{A}^0$ can be inverted. Then the generalized eigenvalue problem 

\begin{equation}
    [\boldsymbol{A}^1 - \lambda_{(1)}\boldsymbol{A}^0]r_{(I)} = 0,
\end{equation}

has only real eigenvalues $\lambda_{(I)}$ and $N$ real, independent, right-eigenvectors, $r_{(I)}$ [see, \textit{e.g.,} \cite{Anile:1990}]

Let the matrix of eigenvectors be $R$ as 

\begin{equation}
    R_{J}^{I} = r^{I}_{(J)},
\end{equation}

and $L$ its inverse. Then, the local characteristic variables are 

\begin{equation}
    \omega = Lu, \hspace{10mm} Q = LF^1
\end{equation}

and we perform component-wse reconstraction to obtain $Q_{1+1/2,j,k}$, where $\omega$ is used in palce of $u$ and $Q$ in place of $f$ in the \ref{eq:theory:fd:laxfluxsplit}. 

Then, we set

\begin{equation}
    F^1_{i+1/2, j, k} = RQ_{i+1/2, j, k}.
\end{equation}

The approximate of $\partial_a F^a$ in terms of $x_{i,j,k}$ then is obtained, repeating the procedure for other dimensions. \textcolor{red}{Results shown in this thesis are obtained, via reconstraction of local charactersitic variables.} \\

The major disadvantage of finite differencing schemes, however, is they they are primarely adopted for Cartesian grids (uiform or with Berger-Oliger-style AMR \cite{Berger:1984}). In case of cell-centered AMR with refluxing, \cite{Berger:1989}, the FD scheme reduce to second order at the boundary of refinment levels. \textcolor{red}{These limitations however are of second importance for the results presented in this thesis [Are they really?..]}

\subsection{Discontinuous Galerkin Methods}

For hyperbolic equations, with particular emphasis on neutron-transport, Discontinuous Galerkin (DG) Methods have been prposed by Reed and Hill \cite{Reed:1973}. Cockburn and Shu in a series of works extensively expanded on the topic \cite{Cockburn:1991,Cockburn:1989ii,Cockburn:1989iii,Cockburn:1990iv,Cockburn:1998v}. For the elliptic and parabolic equations, the method was also adopted, (see \textit{e.g.,} \cite{Arnold:2002} and references therein). The popularicy of methods have increases in recent years, as well as number of applications of GC methods to classical hyperbolic, parabolic and elliptic problems \cite{Cockburn:2000,Canuto:2008,Hesthaven:2007}. In addition, Zumbush \cite{Zumbusch:2009fe} and Field et al. \cite{Field:2010} have successfully applied the DG methods to the Einstein system of equations in vacuum. Finally, Radice et al. \cite{Radice:2011qr} proposed the first DG general-relativistic hydrodynamics code. \\

The rapid growth of DG methods popularity is largely attributed to their numerical properties which we are going to briefly outline here. \\

In addition, while DG methods are realtively young with respect to FV and FD, they have majority of mathematically proven properies. In particular, the intrinsic non-linear stability have been shown for DG methods for any order of accuracy. However, this required imposing limiters and/ro filtering, to treat the under-reslved parts inf the solution \textit{i.e.,} shocks. If the solution, however, is not well represented by the truncated expansion, the aliasing instability occures. For example, modes that are not present in the actual solution can be "aliased" into the evolved ones. Thus the high order modes can have thir content transfered to lower-order mdoes imporperly. This leads to a non-linear instabilities (see \textit{e.g.,} \cite{Boyd:2001}). In addiiton, it was shown that the solution obtained via DG methods is always entropic, as DG methods satisfy the cell-entropy inequality (see \textit{e.g.,} \cite{Cockburn:2003}). Recently, a maximum-principle-satisfying DG schemes were obtained by Zhang and Shu \cite{Zhang:2011}, via a special limiting technique. \\

Another important property of DG methods in the regions, where the solution is smooth, a high, spectral accuracy can be achieved. With respect to the accuracy of DG methods, it was shown that the numerical dissipation depends only on the truncation error \cite{Cockburn:2003}. This in turn implies that in regions where the solution is smooth and resolved, the dissipation is effectively turned off. This is of prime importance for problems where numerical diffusivity routinely orders of magnitude higher then the physical diffusivity, \textit{e.g.,} in transport problems, where it can render results completely wrong. \\

With respect to their practical use, the DG methods can be easily adopted to general unstructured grids. They are also belived to be very efficient in massively parallel computing owing to their compact stencils that grand them high stability \cite{Biswas:1994}. \\

A particular property that makes DG methods very compelling for GR applications, that they are covariant. DG (and their derivative finite-element method, FEM) do not depend on the a choice of the cooridnate system. Instead they can be described in terms of push-forward and pull-backs from a given reference element \cite{Meier:1999}. \\

\textcolor{gray}{In figure 3.3, the superiour accurady of DG methods is shown. There, for advection equation, the comparsion is made between 5th order DG scheme, 5th Order WENO5 scheme and 7th order WENO7 scheme. The former reins supreme even though the latter has a higher formal order of accuracy. For the comparison equal number of DF-points/DG-elements was taken, to assure the similar computational cost between schemes. However, it is important to note that formaly, DG method have more degrees of freedom (d.o.f) by 5 times with respect to FD methods. A commonly adopted method of comparions between these methods relies of setting equal number of d.o.f. However, this is David's opinion that it is misleading as FD method is much more expensive numerically then. The approach adopted by David allows to set the computational cost equal between the scheme. By setting equal number of FD points to the number of DG elements motivated by the fact that the computational costs of DG scales with number of elements similarly, as the cost of FV/FD methods scales woth the number of ceslls/points. Thus David's comparisons is govern by the scenario in which the computational time is similar. However, an equal number of d.o.f. for the comparison is useful to set, when the memory requirements are a limiting factor.}

Despite the large number of advantages, DG methods also have certain limitaitons. In particular, in comparison with FV/FD methods, they have larger memory requirements. In addition, with respect to shocks, all the standard flattening techniques ano not sufficintly reliable in redicing oscillations, or/and decrease the accuracy of the scheme in the smooth regions. However, arguably the most important limitation of DG methods, is that the linear stability requires a more strict CFL condition. For example if the strongly-stability preserving (SSP) time-discretization is adopted \textit{e.g.,} Runge-Kutta (RK) schemes \cite{Gottlieb:2009}, and the spatial discritisation of the same order, the stability condition reads

\begin{equation}
    \text{CFL} \leq \frac{1}{c}\frac{1}{2k + 1},
\end{equation}

where the $k+1$ is the order of accuracy of the scheme \cite{Cockburn:2001}. In recent works [259]\cite{Qiu:2005,Qiu:2004} a novel hybrid DG-FV scheme, DG-WENO was developed to combat this limitation. Similarly, a hybrid scheme $P_N P_M$ was introduced in \cite{Dumbser:2009,Dumbser:2008}. Also, advancments in local-spacetime schemes have been made \cite{Gassner:2011} (see also \cite{Hesthaven:2007} for alternative approaches)

\subsubsection{Runge-Kutta Discontinuous-Galerkin Methods}

In this subsection we are going to briefly touch on the fundamentals behind the so-called spectral discontinuous Galerkin methid with numerical integration (SDGM-NI) of the nodal-DG scheme, which is the widely used DR variant. For a more extensive discussion we direct the reader to \cite{Hesthaven:2007}. \\

Once again for simplicity, we shall focus on a one-dimensional hyperbolic equations, the advection equation with no sources \textit{i.e.,}

\begin{equation}
    \partial_t = \nabla\cdot\boldsymbol{f}(u) =0, \hspace{10mm} (t,x)\in \text{I\!R}_{+} \times\Omega,
    \label{eq:theory:dg:adveq}
\end{equation}

where $\Omega\subset \text{I\!R}^{d}$ is a bounded, regular domain. \\

Now, let us introduce a family of diffeomorphisms $\phi_{j}: T\rightarrow\Omega,\:\Omega_{j}=\phi(T)$ which performs the triangulation of $\Omega$. In other words, we introduce a number $N$ of \textit{elements}, that represent a union of images of a base element $T$. In 2D the base element is usually a triangle (or a square), while in 3D it is then a tetrahedron (cube). Then, the union of images satisfies

\begin{equation}
    \cup_{j=1}^{N}\Omega_{j} = \Omega, \hspace{10mm} \Omega_{i}\cap\Omega_{j} = \emptyset, \hspace{5mm} \text{if} i\neq k.
\end{equation}

\textcolor{red}{see example in figure 3.4}. 

The main idea behind the mapping is the following. This mapping allows to "pull-back" the equations from a given element, to a reference one, where all the descrete differential operators have been pre-computed. Thus, even through the spape of elements in the physical space can be arbitrary involved, the operators \textit{e.g.,} derivative,s interpolation and integration, need to be prescribed just one time for a simple geometry. This, for isntance, allows an iimplementation of elements with smooth boundaries. \\

In relativistic case, however, the scheme can be made effectively coordinate-free. This is achieved by utilizing covariance of equations, effectively casting them in coordinate system generated by diffeomorphisms (taking the one, in which the base element is defined and pushing if forward). \\


Next, we proceed with obtaining a condition that resembles a weak formualtion of \ref{eq:theory:dg:adveq}. The classical way of deriving a semi-descrete scheme is to first obtain a form of weak formualtion in which $u$ is supposedly a bounded function in space, to unsure the existance of a normal trace of $\boldsymbol{f}$ and a smooth function in time. \textcolor{gray}{Note, however, that in chapter 6, a somewhat different direction is chosen, when considering a case of general relativistic problems via a space-time approach, which is more native (adequate) for the relativistic equation. In addition, the condition on the solution to be BV is relaxed, as for a system of eqatuins it might appear too restrictive.} Here we limit ourselves to a classical approach, focusing on a simplifed case of a scalar equations. \\

Consider $\upsilon \in C_0 ^1(\Omega)$. Next, we multiply \ref{eq:theory:dg:adveq} by $\upsilon$ and integrate over $\Omega$, 

\begin{equation}
    \sum_{j=1}^{N}\Bigg[\int_{\Omega_j}\partial_{t}u\upsilon\text{d}x - \int_{\Omega_j}\boldsymbol{f}(u)\cdot\nabla\upsilon\text{d}x\Bigg] = -\sum_{j=1}^{N}\langle\boldsymbol{\mathcal{F}}\cdot\boldsymbol{\nu},\upsilon\rangle_{\partial\Omega_j}
    \label{eq:theory:dg:intformadveq}
\end{equation}

where $\boldsymbol{\mathcal{F}}\cdot\boldsymbol{\nu}$ is the normal trace of $\boldsymbol{f}(u)$ on the boundary, \textit{i.e.,} it represents the distribution, that value on any test function $\upsilon$, of which is 

\begin{equation}
    \langle\boldsymbol{\mathcal{F}}\cdot\boldsymbol{\nu},\upsilon\rangle_{\partial\Omega_j} := \langle\text{div}\boldsymbol{f},\upsilon\rangle_{\Omega_j} + \int_{\Omega_j}\boldsymbol{f}(u)\cdot\nabla\upsilon\text{d}x,
\end{equation} 

where $\div\boldsymbol{f}$ is the distributional divergence of $f$. Assuming that $\boldsymbol{f}$ is smooth 

\begin{equation}
    \langle\boldsymbol{\mathcal{F}}\cdot\boldsymbol{\nu},\upsilon\rangle_{\partial\Omega_j} = \int_{\partial\Omega_j}\boldsymbol{f}\cdot\boldsymbol{\nu}\upsilon\text{d}x,
\end{equation}

where $\boldsymbol{\nu}$ is an out-going norm to $\Omega_j$. \\
To obtain a weak formulation of \ref{eq:theory:dg:adveq}, then reduces to obtaning the 

\begin{equation}
    u\in\text{BV}(\Omega), \hspace{5mm} s.t., \ref{eq:theory:dg:intformadveq} \text{holds for any} \upsilon \in C_0 ^1(\Omega).
    \label{eq:theory:dg:weakformrquire}
\end{equation}

The mechanism of DG method, essencially, is to project the \ref{eq:theory:dg:weakformrquire} on a finite-dimensional subspace of BV$(\Omega)$. For isntance, consider a piecewise polynomial function of $\mathcal{T}_{N}$:

\begin{equation}
    V_N = \big\{ \upsilon\in\text{BV}(\Omega):\upsilon\circ\phi\in\text{I\!P}_{D}(T), \: j=1,...,N \big\}
\end{equation}

where $\text{I\!P}_{D}$ is the space of polynomials of degree $D$. Note, we do not actually require the continuity of functions in $V_N$ between elements. Hence the themse of this family of schemes \textit{discontinuous} Galerkin. Then, in order to constract a DG scheme we need to obtain

\begin{equation}
    u(t) = C^1(\text{I\!R}_{+};v_N), \hspace{10mm} s.t., \ref{eq:theory:dg:intformadveq} \text{ holds for any } \upsilon\in V_N.
    \label{eq:theory:dg:weakform}
\end{equation}

Up to now we were considering test functions that belong to the same functional space as the numerical solution, \textit{i.e.,} to the $V_N$. Such schemes, where the test function and numerical the numerical solution $u$ belong to the same functional space are called \textit{Galerkin methods}. Next, computation of the degrees of freedom of $u$ is now simplified since both $u$ and $\upsilon$ are from finite-dimensional space. This is done by assessing the condition \ref{eq:theory:dg:intformadveq} for a large but finite number of test functions $\upsilon$, linearly independent, of course. This finite number of conditions of the form \ref{eq:theory:dg:intformadveq} allows to determined the degrees of freeodom, as it generates a set of ODEs for d.o.f. of $u$. \\

Next, it is important to mention certain aspects of the weak formulation \ref{eq:theory:dg:weakform}. \\

The first point is related to the smoothness of the test function. The formulation \ref{eq:theory:dg:intformadveq} is not well defined for a non-smooth $\upsilon$. Thus, the DG formulations requires a following addition. The test function $\upsilon$ has to appear as smooth $C_0 ^1(\Omega)$ extension $\upsilon$ in $V_N$ for \ref{eq:theory:dg:intformadveq} to be well defined. Doing this, it has to be ensured that the one-sided limit of $\upsilon$ at $\partial\Omega_j$ from the interior of $\Omega_j$. \textcolor{red}{no clue what this means} This can we achieved by setting

\begin{equation}
    \langle\boldsymbol{\mathcal{F}}\cdot\boldsymbol{\nu},\upsilon\rangle_{\partial\Omega_j} := \langle\boldsymbol{\mathcal{F}}\cdot\boldsymbol{\nu},\upsilon_j\rangle_{\partial\Omega_j},
\end{equation}

where $\upsilon_j \in C_0 ^1 (\Omega)$ and $\upsilon|_{\Omega_j}=\upsilon$. \\

Secondly, let us discuss the normal trace. We simplify \ref{eq:theory:dg:intformadveq} by setting the test function $\upsilon = \chi_i$ and obtain

\begin{equation}
    \partial_t\int_{\Omega_j}u\text{d}x = - \langle\boldsymbol{\mathcal{F}}\cdot\boldsymbol{\nu},\upsilon\rangle_{\partial\Omega_j}
\end{equation}

which strikingly resembles the finite volume method. Thus, the normal trace cab be viewed as a flux computed using an approxmiated Riemann solver. \\

Now, let us consider the contraction of the DG scheme. For simplicity and brievity we limit ourselves to the one-dimensional case, reducing \ref{eq:theory:dg:intformadveq} to the 

\begin{equation}
    \sum_{j=1}^{N}\Bigg[\int_{x_j - 1/2}^{x_j +1/2}\partial_t u \upsilon \text{d}x - \int_{x_j - 1/2}^{x_j +1/2}f(u)\partial_x\upsilon\text{d}x\Bigg] = \sum_{j=1}^{N}\big[F^{j-1/2}\upsilon(x_{j-1/2}) - F^{j+1/2}\upsilon(x_{j+1/2})\big],
\end{equation}

where $F$ is now the numerical flux. Next, we peform an expansion on a polynomial basis on $u(t,\cdot)$ and $f[u(t,\cdot)]$ as

\begin{equation}
    u(t,x) = \sum_{i=1}^{D}u_{i}^{j}(t)l_{i}^{j}(x), \hspace{5mm} f(t,x) = \sum_{i=1}^{D}f_{i}^{j}(t)l_{i}^{j}(x), \hspace{5mm} x\in[x_{j-1/2}, x_{j+1/2}],
\end{equation}

where $l_{i}^{j}$ is some polynomial basis over $[x_{j-1/2}, x_{j+1/2}]$. Usually this basis is constracted from orthonormal polynomials, but this is not required. \\
Now, let us chose $\upsilon = l_{k}^{j}\chi_j$, $k=0,...,D$. This would yield a set of evolution equations for the expansion coefficients $u_{i}^{j}(x)$ \textit{i.e.,}

\begin{equation}
    \sum_{i=1}^{D}\Bigg[\int_{x_{j-1/2}}^{x+1/2}l_{i}^{j}(x)l_{k}^{j}(x)\text{d}x\Bigg]\frac{\text{d}u_{i}^{j}(t)}{\text{d}t} - \sum_{i=0}^{D}\Bigg[ \int_{x_{j-1/2}}^{x+1/2}l_{i}^{j}(x)\partial_{x}l_{k}^{j}(x)\text{d}x \Bigg]f_{i}^{j} = F^{j-1/2}l_{k}^{j}(x_{j-1/2}) - F^{j+1/2}l_{k}^{j}(x_{j-1/2}),
\end{equation}

which in more compact form read

\begin{equation}
    \boldsymbol{M}^{j} - \boldsymbol{D}^{j}\boldsymbol{f} = \boldsymbol{F}^{j-1/2} - \boldsymbol{F}^{j+1/2}, \hspace{5mm} \text{for any } j=1,...,N
\end{equation}

where vectors $u^{j}$ contain all the expansion coefficients of $u$ and introduced the following matrixes

\begin{equation}
    \big(\boldsymbol{M}^j\big)_{ki} := \int_{x_{j-1/2}}^{x+1/2}l_{i}^{j}(x)l_{k}^{j}(x)\text{d}x
\end{equation}

which is the mass matrix, 

\begin{equation}
    \big(\boldsymbol{D}^{j}\big)_{ki} := \int_{x_{j-1/2}}^{x+1/2}l_{i}^{j}(x)\partial_{x}l_{k}^{j}(x)\text{d}x
\end{equation}

which is the co-differential matrix, and finally 

\begin{equation}
    \big(F^{j-1/2}\big)_i := \sum_{k} \delta_{ik} F^{j-1/2}l_{k}^{j}(x_{j-1/2})
\end{equation}

which are the flux vectors.\\

It is important to note several things. The mass-matrix $\boldsymbol{M}$ is defined on a single element, \textit{i.e.,} it is local. It can be made diagonal, if the accuracy of integration is sufficient and the orthonormal basis is chosen. This simplifies the time evolution as otherwise, the $\boldsymbol{M}$ has to be inverted. This however, is not expensive doe to locality of $\boldsymbol{M}$. There are also alternative methods on diagonalizing the $\boldsymbol{M}$, \textit{e.g.,} mass-lumping \cite{Canuto:2008}.  \\

next, Owing to the fact that $f(u)$ is a general, non-linear function, expanding the flux requires sufficiently large number of coefficients and an adequate quadrature formula to evaluate $\boldsymbol{D}^j$. Otherwise an aliasing error is being introduced. In most practical application it indeed arises and somwhat metigates the non-linear stability of the scheme. If the solution is smooth however, it can be suppressed via filtering techniques \cite{Hesthaven:2007}. 
Other source of the aliasing error is a shock, \textit{i.e.,} if $u$ has a jump discontinuity. Then, even in a overal linear case, the aliasing error arises, requiring a special techniques to reduce it. One of the commonly adopted methods to do so is to employ a minmod limiter as a non-linear filter to flatten the profile of the solution within the element that contains discontinuities \cite{Cockburn:2001}. \textcolor{gray}{see more in chapter 6}

\chapter{Finite-Differencing Methods: Flat Spacetimes}

\section{Introduction}

\begin{sidenote}
    \textbf{David:}  \\
    
    I've been reading that for high-resolution shock-capturing, the finite differencing techniques are more efficient and simpler in implementation. However, most codes for MHD and radiation MHD that I find are using finite-volume methods. I am very curious why?..
    
    THC actually has both FD and FV schemes implemented
    FV is exactly conservative and there is a better way to do AMR with it
    FD is better because it is much simpler at higher order
    with THC when we want to do high order precision things we use FD
    when we do messy simulations with microphysics, for which robustness and conservation are more important than formal order of convergence, we use FV
    to be more precise we actually use the Kurganov-Tadmor central scheme, not a Godunov-type FV scheme
    but people always mixes the two (see e.g., the discussion in my PhD thesis)
    
    So, our simulations with microphysical eos andneutrinos are performed using the KT FV scheme?
    
    yes KT FV
\end{sidenote}
\textcolor{red}{combine this with 2018 dyn.ejecta paper method section to outline the modern version of THC. This should suffice.}

To increase a formal order of accuracty in a current generation numerical codes,  flux-conservative finite-difference HRSC schemes is the simplest approach. Its direct competitor, high-order finite volume schemes are more computationally expensive, as they require solution of multiple Riemann problems at the interface between regions \cite{Reisswig:2009us,Shu:2001rep}, as well as complex averaging and de-averaging procedures \cite{Tchekhovskoy:2007zn} \\

Here David presents a new code, the Templated-Hydrodynamics Code (THC), developed using Cactus framework \cite{Goodale:2003}. In \texttt{THC}, the state-of-the-art flux-vector splitting scheme are employed. The reconstruction in characteristic fields is avaliable for up to 7th order, as well as, the Roe flux split with a entropy-fix prescription. \\

The "templated" in the code name stands for a modern paradigm in C++ programing, the tempalted progaming, which means, that part of the code can be generated from the prescribed templates at compiling time. This paradigm allows for a creation of complex modular codes avoiding computational costs, that plague classical polymorphism. The "templated" programming allows to inline all the needed functions and classes at compiling time, \cite{Yang:2001}. \\

The following reconstruction schemes are implemented: MP5, classical monotonicity preserving \cite{Suresh:1997,Mignone:2010} the weighted essentially non oscillatory (WENO) schemes WENO5 and WENO7 \cite{Liu:1994,Jiang:1996,Shu:1997} and two bandwidth-optimized WENO schemes WENO3B and WENO4B \cite{Martin:2006,Taylor:2007}, constracted for modelling the conpressible turbulence. Note, that the number in acheme name stands for a forma order of accuracy. \\ 

In this chapter we briefly state the details of the \texttt{THC} algorithm and highlight the results of the comparioson between different reconstraction schemes for modelling relativistic turbulence. \\

The chapter is structured as following. First we overview several detain of \texttt{THC} code, discussing the numerical algorithms, in particular with respect to the equations of Newtonian and special relativistic hydrodynamics. Then we state several results. Then we view the linear and non-linear development of the relativistc Kelvin-Helmholtz instability (KHI) in 3D. 

\subsection{The \texttt{THC} code }

Here the infrastructure of \texttt{THC} is presented in addition to the formulation of Newtonian and special-relativistc HD. 

\subsubsection{Newtonian Hydrodynamics}
\textcolor{red}{this is not needed}

Let us consider the equations of the classical, Newtonian hydrodynamics. These are the coservation of mass, momentum and energy for a perfect fluid. 

They can be written in a from of a stringly hyperbolic system of balance-laws in afrom \ref{eq:theory:fd:hypsys} (copy)

\begin{equation}
\partial_t\boldsymbol{F}^0(\boldsymbol{u}) + \partial_i\boldsymbol{F}^i(\boldsymbol{u}) = \boldsymbol{S}(\boldsymbol{u}).
\end{equation}

Setting source terms $\boldsymbol{S}$ to zero, we have left the primitive variables 

\begin{equation}
    u = [\rho,\: \vec{\upsilon},\: \epsilon],
\end{equation}

where $\rho$ is the density, $\upsilon^{i}$ is the velocity, $\epsilon$ is the specific internal energy. The conserved variables are 

\begin{equation}
    \boldsymbol{F}^{0} = [\rho,\: \rho\vec{\upsilon},\: E] = \big[\rho, \: \rho\vec{\upsilon}, \: \rho\big(\frac{1}{2}\upsilon^2 + \epsilon\big)\big)\big],
\end{equation}

while the fluxes are 

\begin{equation}
    \boldsymbol{F}^i(u) = \big[ \rho\upsilon^i, \: \rho\upsilon^i\vec{\upsilon}+p\boldsymbol{\delta}^i, \: \upsilon^{i}(E+p) \big]
\end{equation}

where $p$ is the pressure, $[\boldsymbol{\delta}^i]^j = \delta^{ij}$ is the Kronecker symbol. To close the system of equations we set the equation of state $p = p(\rho, \epsilon)$. For the ideal fluid we set ideal fluid 

\begin{equation}
    p = (\Gamma -1)\rho\epsilon
\end{equation}

where $\Gamma$ is the adiabatic index of the fluid. \\

More detained description regarding Jacobians and their spectral decomposition for the equations of Newtonian hydrodynamics and for a generic equation of state see in \cite{Kulikovskii:2002}.

\subsubsection{Special-relativistic hydrodynamics}

\textcolor{gray}{[Here david provides the description of the special relativitisc formulation of hydrodynamics and describes many tests here performed with his code. Tests like shock tube, blast waves, studying convergence and resolution effects. This is not very related to my thesis so I read it and I skip it from rewriting here.]}

In relativity it is common to adopt the unit system in which $c=1$. Adopting also the Einstein summation coefficient convention, we aim here to provide a discription of a perfect fluid. 

The $4-$velocity of the fluid is a vector $\vec{u} = (W, W, \vec{\upsilon})$, with $W = (1 - \upsilon^i , \upsilon_i)^{-1/2}$ being the Lorentz Factor. Then, 

\begin{equation}
    \vec{j} = \rho\vec{\upsilon}, \hspace{5mm} T = \rho h \vec{u} \otimes \underline{u} + p\boldsymbol{g},
\end{equation}

are the rest-mass current 4-vector and the stress energy tensor respectively, where $\rho$ is the rest-mass density, $h=1+\epsilon+p/\rho$ is the specific enthalpy and $g$ is the spacetime metric. For a flat spacetime that we consider, it is 4x4 matrix with only non-zero components being diagonals, \textit{i.e.,} $g_{\mu\nu}=(-1,1,1,1)$. \textcolor{red}{David's goal is to study statistical properties of special-relativistic turbulence and of unveiling novel and non-classical features we will consider the fluid not to affect the spacetime geometry.}

Further, recalling the covariant derivative associated with the metric, $\nabla$, the laws of conservation read as a divergence of equals to zero, \textit{i.e.,}

\begin{equation}
    \nabla\cdot\vec{j}=0,\hspace{5mm}\nabla\cdot T = 0,
    \label{eq:theory:specrel:conserv}
\end{equation}

for the rest mass and energy respectively. 

Recalling the general form of the system of hyperbolic balance-laws in the form, (\ref{eq:theory:fd:hypsys}), the equations \ref{eq:theory:specrel:conserv} can written in terms of primitive variables 

\begin{equation}
    u = [\rho, \: \vec{\upsilon}, \: \epsilon],
\end{equation}

conservative variables 

\begin{equation}
    F^0(u) = [D, \: \underline{s}, \: \tau],
\end{equation}

where 

\begin{equation}
    D = \rho W, \hspace{3mm}, \vec{\vec{s}} = \rho h W^2 \vec{\upsilon} \hspace{3mm} \tau = \rho h W^2 - p - \rho W
\end{equation}

with the fluxes given by 

\begin{equation}
    \boldsymbol{F}^i(u) = [D\upsilon^i, \: \vec{s}\upsilon^i, + p\boldsymbol{\delta}^i, \: s^i-D\upsilon^i]
\end{equation}

We consider sources to be zero and hence the r.h.s of eq.(\ref{eq:theory:fd:hypsys}), and the systeb being closed by the equation of state. For simplicity chosen to the that of an ideal fluid.

Note that while in the Newtonian hydrodynamics there exists an inverse transformation $F^0\rightarrow u$, allowing to express primitive variables from conservative ones, this is not achievable in special relativity. A numerical techniques are required to revocer primitive varaibles, \textit{e.g.,} \cite{Kastaun:2006}. \textcolor{gray}{details on how to extract this via rootfinding and physical entropy}. 

\subsection{Numerical Tests}

\textcolor{gray}{Here I will outline some results for my own understanding. This is not to be put in the thesis, as I am not working with the code development.}
\textcolor{red}{NOT REFPHRASED}

\begin{itemize}
    \item \textbf{Strong shock}. Classical one-dimensional shock tube.Even at this fairly low resolution, all the schemes are able to capture well both the shock wave and the rarefaction wave, showing the good behaviour of the entropy fix. The contact discontinuity is resolved, but not without oscillations (due to the high Mach number of the shock wave, i.e., $\mathcal{M}=360$.
    \item \textbf{Blust wave}. larger density contrast at the contact discontinuity. The MP5 scheme is able to properly capture the constant state between the shock wave and the contact discontinuity, while the WENO schemes result in more â€œroundedâ€ solutions.
    \item \textbf{Rotated Sod test}. Three-dimensional shock-tube test in Newtonian hydrodynamics. All the schemes are able to properly capture the main features of the solution: the discontinuities are captured within 1 or 2 gridpoints and both WENO5 and MP5 are able to capture the plateau in the velocity. Overall, these tests demonstrate the accuracy of the dimensionally unsplit approach that we use to treat the multi-dimensional case.
    \item \textbf{Double Mach reflection test} Our algorithm is able to introduce enough numerical dissipation to avoid the odd-even decoupling. All things considered, we find that the best performance is given by the MP5 scheme.
\end{itemize}

and in special relativity 

\begin{itemize}
    \item \textbf{Adiabatic smooth flow} Test code with the smooth solutions. One-dimensional, large-amplitude, smooth, wave propagating in an isentropic fluid. A good-enough approximation of the exact solution was obtained by computing it on a very fine Lagrangian grid (1e6 points) and interpolated on the Eulerian grid. Instead of the third-order SSP-RK scheme, we adopt here a fourth-order RK time integrator. Our schemes approach the expected convergence order only asymptotically, at very high resolution. The reason for this
    behaviour is in the â€œkinksâ€ ahead and behind the pulse, where the numerical error is largest. These regions are â€œmisinterpretedâ€ as discontinuities by the shock-detection part of our schemes, unless they are resolved with enough gridpoints. The best performing scheme in this test is the MP5 one. Formation of the shock gradually degrades the overall convergence order to the 1st.
    \item \textbf{Blast wave}. Relativistic fluids can exhibit much stronger shock waves. MP5 scheme requires twice as small CFL as other schemes to prevent large oscillations and yields non-physical values. \textcolor{gray}{there is a finite-volume code \texttt{Whisky}, \cite{Baiotti:2010zf,Baiotti:2004wn} with the HLLE approximate Riemann solver \cite{Toro:1999} and PPM reconstruction \cite{Colella:1984}. } If the timestep is suffciently small, on the other hand, the MP5 algorithm results in very accurate solutions, as in the Newtonian case. \texttt{THC} here performes better then \texttt{Whisky}.
    \item \textbf{Shock-heating} relativistic effects can enhance the density contrasts in shock waves. shocks whose collision compresses the fluid. Kinetic energy into thermal energy, that is, through â€œshock heatingâ€. For a Lorentz factor of a 1000, $\Gamma=4/3$, for a Newtonian fluid the compression ratio $\approx7$, while for spec. relativ. it is $\approx 4000$. The WENO5 and WENO7 solutions are affected by some small wall-heating effect, slight underdensity. The MP5 scheme, on the other hand, yields a solution which is essentially free
    from oscillations.
    \item \textbf{Transverse shock}. the equations for the momentum in the different directions are coupled together by the Lorentz factor: even in one-dimensional problems the application of a transverse velocity can change completely the solution. This feature was first pointed out by \cite{Pons:2000} and \cite{Rezzolla:2002ra}, and then used by \cite{Rezzolla:2002cc} and \cite{Aloy:2006rd} to discover a new physical effect, see also [\cite{Mignone:2005ns}, \cite{Zhang:2005qy}] for a description of the numerical consequences of this property]. The MP5 scheme overestimates slightly the density contrast, but all of the algorithms are able to capture the correct location of the shock wave.
    \item \textbf{Spherical explosion}. No analytic solution is known in this case. As in the one-dimensional case, a small timestep is necessary in order to avoid numerical oscillations with the MP5 algorithm, while the other schemes appear to be stable even with a timestep which is twice as large.
    \item \textbf{Kelvin-Helmholtz instability in 2D}. The instability is seeded by adding a small perturbation in the transverse component of the velocity. we use periodic boundary conditions in all the directions. Compare first growth rate of the transverse velocity during the linear-growth phase of the KHI. Important to including the contact wave in the approximate Riemann solver in the case of a finite-volume code. We also note the     importance of avoiding excessive dissipation in the contact discontinuity. The behaviour of the MP5 scheme, as well as that of the bandwidthoptimized WENO schemes, is more surprising: all of these schemes overestimate the growth of the RMS transverse velocity at low resolution. Some insight about the numerical viscosity can be gained by looking at the
    topology of the flow during the linear-growth phase of the KHI. These secondary
    instabilities, although only numerical artifacts (see below), appear only
    in schemes able to properly treat the initial contact discontinuity. They are not to be genuine features of the solution and, rather, tend to disappear as the resolution is increased. Conclusion: secondary instabilities are triggered by the non-linear dissipation mechanism of the different schemes, emerge neatly when computed with numerical schemes that treat properly the initial contact discontinuity, but do not have a physical meaning. Solution: adding more numerical viscosity [219] or as David suggests, physical viscosity. A more quantitative way of estimating the numerical viscosity of the code: The one-dimensional power spectrum can be used to quantify the typical scale of structures, such as the secondary vortices discussed above, stretched in the direction of the bulk shear flow. Even more unexpected is the ability of the MP5 scheme to resolve small scales structures and that, on the basis of the argument about the development of the secondary instabilities, should be more dissipative than WENO4B, but which instead appears to yield more small-scale structures in the rest-mass density.
\end{itemize}

\subsubsection{The relativistic Kelvin-Helmholtz instability in 3D}
\textcolor{red}{Important for GRBs}

analysis is meant to assess how the different methods reproduce the same turbulent initial-value problem and to provide some insight on the spectral properties of the different schemes. The relativistic KHI [see, e.g., [51]] is of particular interest because of its relevance for the stability of relativistic jets [see, e.g., [251, 250]], and because of its potential role in the amplification of magnetic fields in gamma-ray bursts [see, e.g., [338]], and binary neutron-star mergers [25, 143, 240, 274].

\begin{itemize}
    \item \textbf{The linear evolution of the instability} Consider the evolution of the instability during its linear-growth phase. As expected, all the numerical schemes, with the exception of MINMOD, are in very good agreement with the 2D solution up to the end of the linear-growth phase, when 3D effects become important and turbulence starts to play an important role in the dynamics. It is interesting to note that MINMOD, which is the most dissipative of the schemes we are using, is actually overestimating the growth of the KHI.
    This suggests that \textbf{some care should be taken when interpreting the results from under-resolved simulations}. secondary vortices are produced in more least dissipative methods.
    \item \textbf{The non-linear evolution of the instability} The linear-growth phase of the KHI instability ends when the primary vortices become unstable to secondary instabilities and the flow starts the transition to turbulence. Three-dimensional effects dominate. Use the tracer scalar field to track the evolution.
    \item \textbf{The non-linear evolution of the instability}. when the primary vortices become unstable to secondary instabilities and the flow starts the transition to turbulence. three-dimensional effects dominate.
    \item \textbf{Fully-Developed turbulence} By far the most interesting quantity to study is the three-dimensional velocity power spectrum. conclusions. importance of the use of high order    schemes (avoid bottle-neck, otherwise power-spectrum shows an excess due to viscous effects.) use of WENO4B over WENO5 is well justified, since WENO4B is roughly twice as expensive as     WENO5 in 3D. Tthe main differences between the bandwidth-optimized schemes and their traditional counterparts seem to lay in the bottleneck region WENO3B and WENO4B have a much less pronounced bottleneck with respect to WENO5, WENO7 and MP5.
\end{itemize} 

\subsection{Driven Relativistic Turbulence}

consider an idealized model of an ultrarelativistic fluid. The fluid is modeled as perfect. We evolve the equations describing conservation of energy and momentum in the presence of an externally imposed Minkowskian force. To solve the equations of relativistic hydrodynamics in 3D we use the THC
code described in this chapter and published in \cite{Radice:2012cu}. In particular, here, we use the MP5 reconstruction in local characteristic variables [165].
\begin{itemize}
    \item \textbf{Basic flow properties} All in all, this is one of our main results: the velocity power spectrum in the inertial range is universal, that is, insensitive to relativistic effects, at least in the subsonic and mildly supersonic cases. Note that this does not mean that
    relativistic effects are absent or can be neglected when modelling relativistic turbulent flows.
    \item \textbf{Intermittency} local appearance of anomalous, short-lived flow features.
    \item \textbf{Conclusion} \textcolor{red}{We have presented THC, a new multi-dimensional, finite-difference, high-resolution shock-capturing code for classical and special-relativistic hydrodynamics... -- [FULL description of THC]}
\end{itemize}

\section{Finite-Differencing Methods: General Spacetimes} 

Goal is to model the inspiral of BNS to produce accurate waveforms. \textcolor{red}{here, we describe our new high order, high-resolution shockcapturing, finite-differencing code: \texttt{WhiskyTHC}, which constitutes the extension to general relativity of the \texttt{THC} code.}

\subsection{WhiskyTHC}
\textcolor{red}{marginally rephrased}
\begin{itemize}
    \item \textbf{Numerical Methods}. \textcolor{gray}{[high order, high-resolution shockcapturing, finite-differencing code]} \texttt{WhiskyTHC} is a result of combination of two \texttt{Whisky} \cite{Baiotti:2004wn} and \texttt{THC} \cite{Radice:2012cu}. High-order flux-vector splitting finite-differencing techniques has come from the former, while the module for the recovery of the primitive quantities as well as the equation of state framework from the latter \cite{Galeazzi:2013mia}. Tabulated temperature and composition dependent equation of states can be used \textcolor{gray}{however David used only polytrops}. Overall, \texttt{WhiskyTHC} solves the equations of general-relativistic hydrodynamics in conservation form \ref{eq:theory:grhdeq_thc}. using a finite difference scheme \textcolor{red}{we however are using FV? Be carefull with which methods are used exactly}. The flux reconstruction is done in
    local-characteristic variables using the MP5 scheme, see \textit{e.g.,} \cite{Rezzolla:2013}. The space-time is evolved using the CCZ4 formulation \ref{eq:theory:ccz4equations}, solved via finite difference code publicly available through \texttt{Einstein Toolkit}, \cite{McLachlan,Loffler:2011ay}. There, the central stencil is used throughout, and only terms associated with the advection along the shift vector are treated using the upwinded by one grid point stencil. The accuracy of the scheme is availalbe at 6th and 8th order, while 4th is commonly employed. In addition, the fifth order Kreiss-Oliger style artificial dissipation \cite{Kreiss:1973} is added to aid with non0linear stability. 
    The code is build on the \texttt{Carpet} AMR driver \cite{Schnetter:2003rb} from the \texttt{Cactus} computational toolkit \cite{Goodale:2003}, incorporating a provided by \texttt{Carpet} Berger-Oliger-style mesh refinement \cite{Berger:1989,Berger:1984} with subcycling in time and refluxing. \textcolor{red}{in Thesis it is said, -- no refluxing was done yet}
    
    
    \item \textbf{Atmosphere Treatment} The atmosphere is referred to an artificial density floor in the simulation domain. It is introduced in order to tackle the challenges arising when considering boundary between the fluid and vacuum in Eulerian (relativistic) hydrodynamics codes \cite{Galeazzi:mThesis:2008,Kastaun:2006,Millmore:2009dk}. The defining property of the atmosphere is that the rest mass density and coordinate velocity are reset to a floor values once the former falls below a certain threshold value during the evolution \cite{Font:2001ew,Baiotti:2004wn}. While showing a reasonable results in second order codes, in higher order ones the numerical oscillations lead to the creation of vacuum nonetheless, that in light of the aforemention atmosphere effect result in the mass and energy violation \cite{Radice:2011qr}. For codes that rely on characteristic variables, the degeneracy in low-density, low-temperature limits also plagues the computation. This problem is the main reason behind the popularity of robust shock capturing codes, even though they are of first order in the general-relativistic hydrodynamics codes. Vacuum treatment for higher order codes is of main challenges to overcome. 
    
    \begin{itemize}
        \item \textit{Standard Atmosphere Treatment} or \textit{"ordinary MP5 approach"} is based on setting density that falls below $(1+\epsilon)\rho_{\text{atmo}}$ to the atmosphere density, velocity to zero and internal energy to the one prescubed by the polytropic EoS. The $\rho_{\text{atmo}}$ is usually related to a certain characteristic density, \textit{e.g.,} maximum density at the beginning of the simulation as $\rho_{\text{atmo}} = 10^{-7,-9}\rho_{\text{max}}$. The tolerance parameter $\epsilon$ is usually set to $10^{-2}$ and accounts for excessive oscillations of the fluidâ€“vacuum interface. 
        
        \item \textit{An Improved Atmosphere Treatment} or \textit{"MP5+LF"} In this approach the component-wise Lax-Friedrichs flux split is turned on when a certain density is reached. This increases the dissipation of the scheme and allows to avoid problems arising in characteristic reconstruction, associated with the degeneracy of the characteristic variables close to vacuum. Unfortunatelly, if the ejection of low velocity and density matter is concered, this approach may yield oscillatory solutions and thus creates artifacts. 
        
        \item \textit{Positivity Preserving Limiter} a novel approach based on the use of PPL proposed in \cite{Hu:2013}. Here we provide a brief overview. 
        Consider a simple scalar conservation law in 1D
        
        \begin{equation}
            \frac{\partial u}{\partial t} + \frac{\partial f(u)}{\partial x} = 0
            \label{eq:theory:whickythc:atmo:conslaw}
        \end{equation}

        Since for a SSP time integrator a time update is convex combination of Euler steps, for which the positivity of $u$ is guaranteed for any scheme, the general discrete from of \ref{eq:theory:whickythc:atmo:conslaw} can be written as 
        
        \begin{equation}
            \frac{u_{i}^{n+1} - u_{i}^{n}}{\Delta^0} = \frac{f_{i-1/2} - f_{i+1/2}}{\Delta^1}
        \end{equation}
        
        And if $\lambda = \Delta^0/\Delta^1$, then 
        
        \begin{equation}
            u_{i}^{n+1} = \frac{1}{2}(u_{i}^{+} + u_{i}^{-}) = \frac{1}{2}\Big[ (u_{i}^{n} + 2\lambda f_{i-1/2}) + (u_{i}^{n} - 2\lambda f_{i+1/2})\Big].
        \end{equation}
        
        where then $u_{i}^{n+1} = u_{i}^{+} + u_{i}^{-}$ and $u_{i}^{n} = u_{i}^{n} - 2\lambda f_{i+1/2}$. Notably, the $u_{i}^{+}$ and $u_{i}^{-}$ as well as $u_{i}^{n+1}$ are positive. In \cite{Hu:2013} it was pointed out that if a first-order Lax-Friedrichs scheme with $\lambda\leq 1/2a$ (with $a$ being the maximum propagation speed) is used for evaluating $f_{i\pm 1/2}$, the $u_{i}^{\pm}\geq \text{min}_i u_{i}^{n}$ \cite{Zhang:2010}. \textcolor{red}{not understand that}. Then the suggested point is ti change the $f_{i+1/2}$ to be 
        
        \begin{equation}
            f_{i+1/2} = \theta f_{i+1/2}^{\text{HO}} + (1-\theta)f_{i+1/2}^{\text{LF}},
        \end{equation}
        
        where $f_{i+1/2}^{\text{HO}}$ is the high-order flux of the original scheme, and $f_{i+1/2}^{\text{LF}}$ is the flux associated with the first order Lax-Friedrichs scheme, and $\theta\in[0,\:1]$. If the spatial location is far from vacuum, then the original high accuracy scheme can be used, so the $\theta$ remains $1$. However, in the vicinity of the vacuum, the $\theta$ decreases, to assure that $u_{i}^{\pm}$ remains positive. This is always possible since the Lax-Friedrichs scheme, used for $f_{i+1/2}^{\text{LF}}$ is positivity preserving.
        
        In a multidimensional case the the component-vise extension is employed. \textcolor{red}{formula that I will not used for $u_{i,j,k}^{n+1}$}.
        
        In \cite{Hu:2013} the extension of the method to the system of conservation laws was also proposed. 
        
        The complications however are present when the source terms are treated. While for a simplified case of classical gas dynamics it might require a lower timestep, in the general relativistic case and general tabulated EOS, the positivist of pressure is difficult to assure due to complexity of the energy source terms. It can be mitigated by enforcing a floor value on the pressure.
        
        Note, that adopting a positivity preserving limiter to treat the transition between matter and vacuum, still implies replacing the vacuum with low density fluid at rest, is not a physically accurate approach. That would rely on treating the transition as a free boundary (see \textit{e.g.,} \cite{Kastaun:2006}) The advantage of positivity preserving limiter with respect to a classical atmosphere treatment, is that it allows to have a value of $\rho_{\text{atmo}}$ that does not require further tuning and can be arbitrary small, and assure that the solution is locally conserved. 
            
        \textcolor{red}{In our models} we employ this approach as follows, at the meginning of the simulations we set the floor density, relying in the subsequent evolution on a positivity preserving limiters to ensure the atmosphere well behaviour. Due to negligeble density of the atmosphere its accretion has a negligeble effect on the evolved object. 
        
        
    \end{itemize}

    \item \textbf{Single Neutron Stars: Fixed space-time} here the atmosphere test showed that using the standard atmosphere leads to the mass conservation violation on a small degree, however, it also shows an appearance of a "jet+-like structure along the axes where grid points are aligned with the star's surface. These aritifical outflowes are driven by the numerical oscillations creating an imbalance at the surface MP5+LF on the other hand shows no artificial matter streams due to its conservative nature
    \item \textbf{Single Neutron Stars: Full-GR}
    \item \textbf{Non-linear Oscillations: the Migration Test} Here the setup is the following, a neutrono star in Full GR is set with an initial oscullation, that formces a star to fiurst contract and then rebounce. This rebounce creates and ejecta. Different prescitpions show this ejecta, but the MP5-LF is inadequate in this test, introducing the structure in the ourflow (numerical osculllations/fragmentations). Origin: component-wise reconstruction in low density regions.
    \item \textbf{Gravitational Collapse to Black-Hole}
    \item \textcolor{red}{\textbf{Binary Neutron Stars} [Copied. Not rephrased]} Models having an initial small separation of 45 km. Compare it to \texttt{Whisky} code, that is a second-order finite-volume code, with high-order primitive reconstruction and implements several different approximate Riemann solvers, \textcolor{red}{David used PPM reconstruction [95] and of the HLLE Riemann solver \cite{Harten:1983}, \cite{Einfeldt:1988}].} 
    The initial data we consider describes two neutron stars in quasi-circular orbit. It is computed in the conformally-flat approximation using the Lorene pseudo-spectral code \cite{Gourgoulhon:2000nn} and has been made publicly available by the Meudon group \cite{Lorene}. The EoS assumed for the initial data is polytropic. \textcolor{gray}{In our case it is cold EOS} while the evolution is performed using the ideal-gas EoS to allow for thermal effects in the merger phase. \textcolor{gray}{In our case it is finite temperature EOS}. Discussion on baryonic masses and compactness $c=M_{\infty}/R_{\infty}$, where $R_{\infty}]$ is the areal radius.
    \begin{itemize}
        \item \textit{Small separation} Grid discussion: extend, symmetries \textit{e.g.,} we assume reflection
        symmetry across the $xy$ plane and $\pi$ symmetry across the yz plane. Number of refinement levels. Static grid or AMR. 
        Evolution via CCZ4 with damping constants $\kappa_1=?$, $\kappa_2=?$ and $\kappa_3=?$ and with beta-driver $\eta=?$. The space time evolved. Space-time is evolved via fourth order finite-differencing and with fifth order Kreiss-Oliger artificial dissipation \textcolor{red}{I need to find what is used in our runs}.
        Study the graviational radiation via looking ad the $l=2$ $m=2$ mode of the $Weyl$ scalar $\Psi_4$ extracted at a fixed coordiante radius of $r=450M_{\odot}$. Strain is not computed as it involves other uncertanties \cite{Boyle:2009vi,Reisswig:2009us,Reisswig:2009rx,Reisswig:2010di}. 
        The dynamics of the inspiral and merger of BNS has been described many times and in great detail in the literature \textit{e.g.,} \cite{Baiotti:2008ra}. We only mention that the two neutron stars
        inspiral for about 2:5 orbits, touch and quickly merge into a single black-hole. For this particular model no significant disk is left behind. The gravitationalwave signal consists.
        For GW plot 22 mode of $\Psi_4$ as extracted at $r=450M_{\odot}$ and as a function of the retarted time $t-r_*$ where $r_* = r + 2M_{\text{ADM}}\log(r/(2M_{\text{ADM}})-1)$.
        Results: 1. treatment of the neutron star surface is not a leading source of error in binary neutron star simulations, as far as the inspiral GW signal is concerned. \texttt{WhiskyTHC} shows a smaller dephasing significantly smaller de-phasing: the difference between the low and the high resolution is about 0.6 radians, which is a factor four smaller than the one shown by \texttt{Whisky}. Observation: merger happens earlier as we increase the resolution. For each run we compute the phase, $\phi$, of the 22 mode of $\Psi_4$ from its definition, $(\Psi_4)_{22} = A e^{i\phi}$. 
        We should stress that this error estimate only reflects the numerical truncation error. Other systematic errors and, in particular, finite extraction radius effects and inaccuracies in the initial data, are also present and might be relevant (especially for WhiskyTHC). On the other hand, here we are interested only in evaluating the accuracy of the two numerical methods.
        \item \textit{Large separation} [mostly skipped]
        Notice that  contact happens before the bare contact angular frequency \cite{Damour:2012yf} 
        \begin{equation}
            0.15276 = M\omega_{\text{contact}} := 2C^{3/2}, \hspace{5mm} \omega:=\dot{\phi}
        \end{equation}
        is reached. This is in any case expected because this approximation of the contact frequency does not take tidal deformations into account.
    \end{itemize}
    
    \item \textbf{Conclusion}
     
\end{itemize}

\section{Discontinuous Galerkin methods for general relativistic hydrodynamics}
\textcolor{red}{Skipped}


%% ==========================================
%%
%% Radiation
%%
%%
%% ==========================================


\part{Relativistic Radiation Transport}
\chapter{The Filtered Spherical Harmonics Method}
\section{Introduction}

Radiation-transport equations are complex and expensive to solve numerically. The main reasons for that are the following. First, is the dimensionality of the problem. Radiation carriers are described by their location in space, which generally is a 3D sapce, momenta, which requires 2 additional components, angles, and finally one component for energy of the carrier. Thus, with an addition of time there are $(6+1)$ dimensions for the problem. The second main difficulty stems from in the different regimes of the radiation transport with respect to the optical depth. If the latter is high, \textit{i.e.,} the opacity is very large, the radiation transport can be described by the diffusion of carriers, having the parabolic character. However, if the opacity is small and thus the optical depth, the radiation can stream freely, displaying a hyperbolic character of the transport \cite{Mihalas:1984}. A particular difficulty is presented by the intermediate regime, when the radiation transport mechanism transitions from diffusion to free streaming. 

Most commonly used approaches to simplify the radiation transport equation relies on reducing the sentimentality of the problem. The most approach is to reduce the number of spatial dimensions by assuming a certain symmetry, for example, an axial or spherical symmetry. And while this have shown to be a reasonable approximation for many astrophysical models, in cases where the system itself does not exhibit any spatial symmetries, such simplification cannot be done. Anther approach to reduce the dimensional of the problem, is to simplify the momentum space. An example of such approach, that allows to reduce the computational cost considerably, is the approximation of transport equations with diffusion equations \cite{Pomraning:1973,Roe:1981}. And while in the opaque regions (with high optical depth) this approximation is reasonable, it becomes much less so in the transparent regions where the anisotropy of radiation has to be taking into account \cite{Ott:2008jb}. There, the free-streaming approximation is usually adopted. The solution in the intermediate region then obtained by the interpolating between the two. This approach can be augmented by using a two-moment schemes with analytic closures (\textit{e.g.,} \cite{Brunner:2002}), however in many applications a solution in actual $(6+1)$ dimensions is a requirement.

The main source of complexity in the radiation transport stems from the scattering integral over all 4$\pi$ steradian. By dividing the solid angle into a number of discrete angular intervals, the integral can be replaced with a finite sum, converting the integrodifferential equation into a linear system of equations for a multi-index object. This method of solving transport equation along several directions in each spatial zone the is called discrete-ordinate (SN) method \cite{Castor:2004,Ott:2008jb,Sumiyoshi:2012za,Godoy:2012}. The discretization, however, comes with a a serious drawback, as it introduces regions which the radiation cannot reach between the grid directions. This is so-called "ray-effect" \cite{Morel:2003}, that causes large spatial oscillations in the transport variables.

Another way to solve the multidimensional radiation transport is to employ Monte-Carlo methods \cite{Fleck:1971,Gentile:2009,Abdikamalov:2012zi}. They can achieve very high accuracy, however, plague by the statistical noise (due to finite sampling of the phase space), they require very large number of Monte Carlo particles, and thus, they are computationally expensive. 

A more physically motivated approximation to the radiation transport can be achieved by expending the radiation intensity in angles using spherical harmonics as basis functions. This is so-called $P_N$ method. It allows to convert the integrodifferential equation into a hyperbolic system of partial differential equations for the expansion coefficients. Coefficients stand for angular moments in the basis of spherical harmonic functions. An advantage of this method with respect to the diffusion approximation is that if in the latter the radaition propagation speed is unbound, in $P_N$ method, that approximates the radiation as a set of elementary waves, the propagation speed is limited by the speed of light \cite{McClarren:2008b}. This approach is also numerically more favorably, exhibiting the formal spectral convergence to the true solution and requiring less memory, a factor of two with respect to $S_N$ method for an equivalent angular distribution and accuracy. Preserving the rotational invariance, the $P_N$ method allows to avoid the "ray effect" of $S_N$ method. However, approximation of the radiation field with smooth basis functions, while being sufficiently accurate in the optically thick regime, displays non-physical oscillations in the transparent one \footnote{This is related to the so-called Gibbs phenomenon \cite{Boyd:2001}}. If radiation is coupled to matter, these oscillations can produce regions with negative radiation intensity and thus negative temperature \cite{McClarren:2008b,Olson:2009} (see also \cite{Olson:2000,Olson:2009,Brunner:2001,McClarren:2010,Olson:2012,Hauck:2010}). On of the solutions to this problem is to filter out (using \textit{e.g.,} spherical spline expansion \cite{Boyd:2001}) these oscillations from the radiation intensity \cite{McClarren:2010}. However, the exact choice of the filtering technique, extension to full 3D and absence of the clear continuum limit\footnote{Which does not allow to study the spatial convergence of the solution} present additional challenge in implementing the filtering approach. \\
%
In this chapter we overview the method by McClarren \& Hauck \cite{McClarren:2010}, \textcolor{red}{folllowing David  who achieved the clear continuum limit by reformulating the original method, investigated the range of filter types and studied 2D and 3D radiation transfer with his trasport code \texttt{Charon}} 
\textcolor{red}{more description of Charon}
\textcolor{red}{The chapter is organized as following}


\section{The relativistic Boltzmann equation}
\textcolor{red}{If I am to use this seriously, I must augment this section. It is barely rephrased and copied.}

Here we aim to introduce the equation for radiation transport in special relativity. For the purpose of being in-line with corresponding literature we slightly change the notation from the section \textcolor{red}{sec:[Boltzmann GR]} and given an independent discussion

\subsection{The distribution function for radiation}

Let us start by introducing the specific radiation intensity $I$

\begin{equation}
    d\mathcal{E} = I \cos\theta\text{d}A\text{d}\nu\text{d}\Omega\text{d}t
    \label{eq:theory:boltz:specIntes}
\end{equation}

that describes the radiation energy in freqquency range $\nu\pm\text{d}\nu$ propagating in the direction $\Omega$, within the solid angle $\text{d}\Omega$, crossing the surface are $\text{d}A$, whose norm makes and angle $\theta$ with respect fo $\Omega$, withing time interval $\text{d}t$. (see \textit{e.g.,} \cite{Pomraning:1973}). 

Note, that in this definition, the intensity is set per unit frequency interval, while it is common in neutrino-transport literature to define it per frequency interval (\textit{e.g.,} \cite{Burrows:1999es})

In order to approach the number density and energy density of the radiation, we introduce the distribution function, $F$, describing the density of radiation carriers in phase space. This is of particular usefullness for the relativistic case as $F$ is Lorentz invariant \cite{Mihalas:1984}. For that we first focus on a single relativisitc particle phase space. Let $x^{\mu}$ and $p^{\mu}$ be particles positions and momenta, measured in \textcolor{red}{fiducual internal frame}. Assuming that the radiation carriers are massless, with their energy being related to frequency as $\epsilon = h\nu$, the momentum four-vector $p^{\mu}$ can be written in terms of angles describing the direction of the particles movement, $\theta$ and $\phi$, and the frequency $\nu$ as 

\begin{equation}
    p^{\mu} = \frac{h\nu}{c}(1, \: \cos\phi\sin\theta,\:\sin\phi\sin\theta,\:\cos\theta),
    \label{eq:theory:boltz:pmu}
\end{equation}

where we also made use of the normalization condition for timelike vectors, that imply that $p^{\mu}$ has only $3$ independent components.

Next we introduce a quantities

\begin{align}
    dN &= F p^{\mu}t_{\mu}\text{d}^3 x\text{d}\Pi = \frac{h^3\nu^2}{c^2}F\text{d}^3x\text{d}\nu\text{d}\Omega, \text{ where } \\
    \text{d}\Pi &= \frac{\text{d}p^1\text{d}p^2\text{d}p^3}{-p_0} =\frac{h^2\nu}{c^2}\text{d}\nu\text{d}\Omega
    \label{eq:theory:boltz:dN}
\end{align}

where $dN$ stands for the total number density of radiation carriers within the phase-space volume element $\text{d}\Pi$, spatial volume element $\text{d}^3 x$, that pass a $t=\text{const}$ hyperserface with normal $\vec{t} = \partial_t$. The $\text{d}\Pi$ is Loretnz-invariant by contraction volume element over the manifold of allowed $p^{\mu}$ \cite{Cercignani:2002}.

Thus we introduced a distribution function in terms of $p^i$, that can ultimatelly be expressed in terms of $\nu$, $\phi$ and $\theta$. This function thus contain the information regarding the type of the radiation carrier. However, in the neutrino-transport literature factor $g$ is usually introduced that represents the statistical weight of the particle, $1$ for neutrinos and $2$ for photons (assuming both are mass-less). 

Note, that the spatial volume element can be written as $\text{d}^3x = \text{d}\cos\theta\text{d}t$ and the energy per particle is $h\nu$. Then from definition of $\text{d}\mathcal{E}$ we can write that $\text{d}\mathcal{E} = h\nu\text{d}N$. This, combined with equations \ref{eq:theory:boltz:dN} and \ref{eq:theory:boltz:specIntes} results in 

\begin{equation}
    I = \frac{h^4} \nu^3{c^2}F,
    \label{eq:theory:boltz:IasF}
\end{equation}

which imply that both $\text{d}N$ and $F$ are scalars.

Note, that instead of momentum phase space $\text{d}^p$ we used here the Lorentz-invarient volume element $\text{d}\Pi$ from equation \ref{eq:theory:boltz:dN}. 

\subsubsection{The relativistic Boltzmann equation}

Following \cite{Mihalas:1984} we write the special-relativistc Boltzmann equation as

\begin{equation}
    p^{\mu}\frac{\partial F}{\partial x^{\mu}} = \mathbb{C}[F],
    \label{eq:theory:boltz:boltz}
\end{equation}

where $\mathbb{C}$ is the collisional term that describes the radiation-matter interaction. The l.h.s. of the \ref{eq:theory:boltz:boltz} contains the description of radiation. 

Following the commonly adopted approach in the radiation transport literature, we express $\mathbb{C}$ in terms of the absorption, emission, and scattering coefficients. Then, the evolution equation for intensity reads \cite{Pomraning:1973}

\begin{equation}
    \frac{1}{c} \frac{\partial I}{\partial t} + n^i\frac{\partial I}{\partial x^i} = \eta - \kappa I + \frac{\kappa_s}{4\pi}\int\frac{\nu}{\nu'}K(\nu',\vec{n}'\rightarrow\nu,\vec{n}) I(\nu',\vec{n}')\text{d}\Omega'\text{d}\nu'
    \label{eq:theory:boltz:def_dIdt}
\end{equation}

where $\eta$ stands for the matter radiative emissivity, $\kappa$ is the total extinction coefficient that incorporates the absorption $\kappa_a$ and scattering $\kappa_s$ as $\kappa = \kappa_a + \kappa_s$, $K$ is the scattering \textcolor{red}{kernel}, that describes the statistical probability of a scattering to occur from one specified angle and frequency into anther \cite{Pomraning:1973}.

Combining the equations \ref{eq:theory:boltz:pmu}, \ref{eq:theory:boltz:IasF}, and \ref{eq:theory:boltz:def_dIdt}, we write 

\begin{equation}
    p^{\mu}\frac{\partial F}{\partial x^{\mu}} = \frac{c^2}{h^3}\frac{\eta}{\nu^2} - h\nu\kappa F + \frac{h \nu \kappa_s}{4\pi}\int\Bigg(\frac{\nu'}{\nu}\Bigg)^2 K(\vec{p}\:'\rightarrow\vec{p})F(\vec{p}\:')h\text{d}\nu'\text{d}\Omega',
\end{equation}

where as $\mathbb{C}$ is a scalar\footnote{as $F$ was shown to be a scalar}, the $\eta/\nu^2$ and $\nu\kappa$ are invariant quantities, as also pointed out in \cite{Mihalas:1984}. 

For simplicity we shall consider only elastic scattering, in which the energy of the radiation carriers is preserved. Then the scattering kernel reads 

\begin{equation}
    K(\nu'\vec{n}\: '\rightarrow\nu,\vec{n}) = [1 + \sigma_a\vec{n}\cdot\vec{n}\: ']\delta(\nu-\nu')
\end{equation}

where the coefficient $\sigma_a$ accounts for scattering anisotropy. 

\subsection{The \texttt{Charon} Code}
\textcolor{red}{Here I summarize how the charon code was made}

The distribution fuction $F$ depends in $1+3+1+2$ variables of time, $t$, space, $x^{\mu}$, frequency, $\nu$, and angles of propagation $\theta$, $\phi$. If the matter within which the radiation is propagating is moving, there two main frames in which these variables are defined: Eulerian (inertial) frame and comoving with the fluid frame (a collection of frames for every fluid element that have an instantaneous velocity, same as the fluid, \cite{Mihalas:1984,Hubeny:2006wm}). If the fluid id stationary these frames coincide.

In charon code the distribution function is expanded in the spatial cooridnates using the linear DG basis and in the angular variables using spherical harmonics, the frequency is treated using a multi-group approach. Thus the radiation transfer takes from a large set of ordinary differential equations that can be solved via an semi-implicit time integrator. 

\subsubsection{Frequency Discretization}
Chosen a maximum frequency $\nu_{\text{max}}$ and a uniform grid in a frequency space. Associated intervales of frequency are called frequnecy or energy groups. 

End.


%[2]\cite{Cactus}
%[3]\cite{Lorene}
%[4]\cite{McLachlan} % BSSN
%[5]\cite{Abdikamalov:2012zi}
%[6]\cite{Abramowitz:1968}
%[7]\cite{Adams:2002}
%[13]\cite{Alic:2013xsa}
%[15]\cite{Aloy:2006rd}
%[16]\cite{Luigi:2002}
%[18]\cite{Anile:1990}
%[22]\cite{Arnold:2002}
%[25]\cite{Baiotti:2008ra}
%[28]\cite{Baiotti:2010zf}
%[29]\cite{Baiotti:2004wn} [same 1]
%[31]\cite{Baiotti:2009gk}
%[33]\cite{Baiotti:2004wn} [same 1]
%[34]\cite{Balsara:2012}
%[35]\cite{Balsara:2000}
%[36]\cite{Banyuls:1997}
%[40]\cite{Benartzi:2007}
%[44]\cite{Berger:1989}
%[45]\cite{Berger:1984}
%[50]\cite{Biswas:1994}
%[59]\cite{Borges:2008}
%[60]\cite{Boris:1971}
%[61]\cite{Boyd.:1996}
%[62]\cite{Boyd:2001}
%[63]\cite{Boyle:2009vi}
%[66]\cite{Borges:2008}
%[67]\cite{Bruenn:1985}
%[68]\cite{Brunner:2002}
%[69]\cite{Brunner:2001}
%[70]\cite{Brunner:2005}
%[72]\cite{Burrows:1999es}
%[74]\cite{Canuto:2006}
%[75]\cite{Canuto:2008}
%[76]\cite{Canuto:1988}
%[77]\cite{Cardall:2002bp}
%[78]\cite{Castor:2004}
%[79]\cite{Cercignani:2002}
%[81]\cite{Chen:2006}
%[82]\cite{Chen:2003}
%[83]\cite{Chen:2009}
%[84]\cite{Chernikov:1962}
%[85]\cite{Chiu:1973}
%[86]\cite{Cockburn:1998v}
%[87]\cite{Cockburn:2003}
%[88]\cite{Cockburn:1989ii}
%[89]\cite{Cockburn:1989iii}
%[90]\cite{Cockburn:1990iv}
%[91]\cite{Cockburn:2000}
%[92]\cite{Cockburn:1991}
%[93]\cite{Cockburn:2001}
%[94]\cite{Colella:2008}
%[95]\cite{Colella:1984}
%[96]\cite{Colella:1984}
%[97]\cite{Conway:1966}
%[100]\cite{Crandall:1980}
%[101]\cite{Crandall:1980proc}
%[102]\cite{Damour:2012yf}
%[108]\cite{Debbasch:2009a}
%[109]\cite{Debbasch:2009b}
%[114]\cite{DiPerna:1985}
%[115]\cite{Donat:1996}
%[116]\cite{Donat:1998}
%[121]\cite{Dumbser:2009}
%[122]\cite{Dumbser:2007}
%[123]\cite{Dumbser:2008}
%[124]\cite{Ehlers:1971}
%[125]\cite{Einfeldt:1988}
%[128]\cite{Field:2010}
%[129]\cite{Fleck:1971}
%[130]\cite{Font:2008fka}
%[131]\cite{Font:2001ew}
%[134]\cite{Friedrichs:1954}
%[137]\cite{Galeazzi:mThesis:2008}
%[136]\cite{Galeazzi:2013mia}
%[139]\cite{Gassner:2011}
%[140]\cite{Gentile:2009}
%[141]\cite{Gerolymos:2009}
%[144]\cite{Giacomazzo:2005jy}
%[146]\cite{Giacomazzo:2010bx}
%[147]\cite{Glimm:1965}
%[148]\cite{Godoy:2012}
%[149]\cite{Godunov:1959}
%[150]\cite{Goodale:2003}
%[151]\cite{Goodman:1985}
%[152]\cite{Gottlieb:1997}
%[154]\cite{Gottlieb:2009}
%[157]\cite{Gourgoulhon:2000nn}
%[161]\cite{Harten:1976}
%[162]\cite{Harten:1983}
%[163]\cite{Harten:1987}
%[164]\cite{Hauck:2010}
%[166]\cite{Henrick:2005}
%[167]\cite{Hesthaven:2008}
%[168]\cite{Hesthaven:2007}
%[169]\cite{Hotokezaka:2013mm}
%[170]\cite{Hu:2013}
%[171]\cite{Hubeny:2006wm}
%[173]\cite{Israel:1979wp}
%[174]\cite{Israel:1963}
%[176]\cite{Jiang:1996}
%[179]\cite{Kastaun:2006}
%[180]\cite{Kastaun:2007phd} % bugged
%[185]\cite{Konigl:1980}
%[186]\cite{Kreiss:1973}
%[188]\cite{Kruzkov:1970}
%[189]\cite{Kulikovskii:2002}
%[190]\cite{Kurganov:2000}
%[192]\cite{Lax:1957}
%[193]\cite{Lax:1956}
%[194]\cite{Lax:1960}
%[196]\cite{LeVeque:1992}
%[195]\cite{Lax:1954}
%[197]\cite{LeVeque:2002}
%[201]\cite{Lindquist:1966}
%[202]\cite{Liu:1994}
%[203]\cite{Loffler:2011ay}
%[204]\cite{Lowrie:2002}
%[207]\cite{Marquina:1994}
%[208]\cite{Marti:1994}
%[210]\cite{Marti:1991wi}
%[211]\cite{Martin:2006}
%[212]\cite{Maselli:2012zq}
%[215]\cite{McClarren:2010}
%[216]\cite{McClarren:2008}
%[217]\cite{McClarren:2008a}
%[218]\cite{McClarren:2008b}
%[220]\cite{Meier:1999}
%[221]\cite{Meister:2009}
%[222]\cite{Curtis:1972}
%[224]\cite{Mignone:2005ns}
%[226]\cite{Mignone:2010}
%[227]\cite{Mihalas:1984}
%[228]\cite{Millmore:2009dk}
%[230]\cite{Morel:2003}
%[235]\cite{Nessyahu:1990}
%[242]\cite{Olson:2009}
%[243]\cite{Olson:2012}
%[244]\cite{Olson:2000}
%[245]\cite{Ott:2008jb}
%[247]\cite{Pannarale:2011pk}
%[248]\cite{Papadopoulos:1999kt}
%[255]\cite{Pomraning:1973}
%[257]\cite{Pons:2000}
%[259]\cite{Qiu:2005}
%[260]\cite{Qiu:2004}
%[262]\cite{Quirk:1994}
%[263]\cite{Radice:2011qr}
%[264]\cite{Radice:2012cu}
%[267]\cite{Reed:1973}
%[268]\cite{Reisswig:2010di}
%[269]\cite{Reisswig:2009us}
%[270]\cite{Reisswig:2009rx}
%[272]\cite{Rezzolla:2002ra} 
%[273]\cite{Rezzolla:2002cc}
%[274]\cite{Rezzolla:2011da}
%[275]\cite{Rezzolla:2013}
%[277]\cite{Roe:1981}
%[283]\cite{Santamaria:2010yb}
%[284]\cite{Sasaki:1958}
%[285]\cite{Sasaki:1962}
%[289]\cite{Schnetter:2003rb}
%[295]\cite{Shu:1997}
%[296]\cite{Shu:1999}
%[297]\cite{Shu:2001rep}
%[298]\cite{Shu:1989}
%[299]\cite{Shu:1988}
%[300]\cite{Shu:2003}
%[304]\cite{Smoller:1993}
%[305]\cite{Sod:1978}
%[309]\cite{Sumiyoshi:2012za}
%[310]\cite{Suresh:1997}
%[311]\cite{Synge:1957}
%[312]\cite{Tadmor1998}
%[314]\cite{Tanner:2006}
%[315]\cite{Tauber:1961}
%[316]\cite{Taylor:2007}
%[317]\cite{Tchekhovskoy:2007zn} [copy 2]
%[318]\cite{Tchekhovskoy:2007zn} [copy 2]
%[321]\cite{Thorne:1981}
%[323]\cite{Toro:1999}
%[325]\cite{vanLeer:1973}
%[327]\cite{Vandeven:1991}
%[329]\cite{Vines:2011ud}
%[334]\cite{Woodward:1984}
%[335]\cite{Yang:2001}
%[339]\cite{Zhang:2005qy}
%[340]\cite{Zhang:2010}
%[341]\cite{Zhang:2011}
%[342]\cite{Zhang:2011a}
%[347]\cite{Zumbusch:2009fe}

%% ---------------------------------
%% ---------------------------------
%%
%%      NUCLESYNTHESIS 
%%
%% ---------------------------------
%% ---------------------------------

\chapter{Nucleosynthesis}
\textcolor{red}{Based on the Jones Lippuner PhD thesis}

%%
%%
%%

\section{Introduction}

For a long time it was believed that all elements in the universe were synthesized during the Big Bang \cite{Alpher:1948}. Later studies have, however, proven that only elements with atomic number $A<8$ were produced (see \textit{e.g.,} \cite{Alpher:1950,Shaviv:2012}). Thus, only the lightest elements, hydrogen and helium primarily, were produced during in the Big Band \cite{Burbidge:1957}. Heavier elements are synthesized in a plethora of processes outlined in that work, understanding of which has gradually grown over the years. 

In this chapter we discuss the rapid neutron capture process ($r$-process) responsible for creation of heavy elements \cite{Burbidge:1957}. We introduce conditions and cites of $r$-process, its contribution to the Universe' chemical evolution. We briefly discuss how numerous nuclear species, participating in thousands on nuclear reactions, are evolved using the \texttt{SkyNet} nuclear reaction network code. Then, we consider binary neutron star mergers as a source of $r$-process elements. We compute the nucleosynthetic yields from mergers, using the numeral relativity simulations performed with \texttt{WhiskyTHC} code (see sec. \ref{sec:code:WhiskyTHC}). 

In section... we discuss...

%%
%%
%%

\subsection{Solar system abundances}

It is of paramount importance for testing nucleosynthesis theories and models to have an accurate measurements of relative abundances in the Universe. For Humanity, confined still to just one planet, this is not a trivial task. And while automatic spacecrafts, such as Luna, Apollo and Hayabusa have delivered samples from asteroids, most of the studies are performed using the naturally falling meteorites. The composition of these guests from space is then thoroughly studied via absorption and emission spectroscopy \cite{Shaviv:2012}.

From the pioneering works is study absorption lines and evaluate relative abundances \cite{Suess:1956}, a great progress has been made in study the solar system isotope and element abundances (\textit{e.g.,} \cite{Cameron:1973,Anders:1989,Grevesse:1998,Lodders:2003}) \textcolor{red}{add last papper you used for soalr A.}

\begin{sidenote}
    \textcolor{red}{Figure with solar observed abundances, showing $r$-elements and $s$-elements}
    The observed obundacnes as a function of atomic mass number $A$ are shown in figure Fig. (XXX). (data from \cite{Lodders:2003}). The plot shows nuclei that are more bound (due to spin pairing of nucleons \cite{Moller:1993ed}), \textit{i.e,} those with an even $A$ number, are more abundant. The lowest binding energy of nuclei with odd number of neutrons and protons (but even $A$) are largely unstable or short-lived. A few exceptions are \textit{e.g.,} $^{40}$K, $^{50}$V, $^{138}$La and $^{176}$Lu, that have a half-life of at least $10^{9}$ years.
\end{sidenote}

In different mass ranges the dominant nuclearsynthesis process varies. For instance, light elements $A<8$ were synthesized right after the Big Bang. Nuclides before the iron peak, $12\leq A\leq 56$ come from stellar hydrostatic nuclear burning, elements at the iron peak $50\leq A \leq 62$ produces mostly during the type Ia supernova or explosive silicon burning in core-collapse supernova (CCSN). The conditions at these sights are such that the dense material at the nuclear statistical equilibrium (NSE), expands and cools down. Most of the material beyond iron peak are produced via neutron capture processes \cite{Burbidge:1957}.

%%
%%
%%

\subsection{Nucleosynthesis up to the iron peak}

\subsubsection{Big Bang nucleosynthesis}

Light elements in the Universe, like hydrogen ($\sim 75\%$ by mass) and helium ($\sim 25\%$ by mass) alongside trace amounts of $^{3}$He and $^{7}$Li were created during the Big Bang nucleosynthesis (see \textit{e.g.,} \cite{Tytler:2000qf} and references therein). And while only a small number of nuclides were involved in BBN, there are large discrepancies between BBN models and observations. For instance, the "lithium problem" \cite{Coc:2013eha}, which origin is not well understood \cite{Fields:2011zzb}.

%%
%%
%%

\subsubsection{Low-mass stellar burning}

In order to fuse massive nuclides and overcome the strong Coulomb barrier, high temperatures, ($\geq 10^6$ K) are required. Thus production of heavy elements from hydrogen and helium is possible only in special environments, in particular, in the interior of stars \cite{Bethe:1939}. For the most of their lives stars burn hydrogen into helium. The process releases the binding energy that maintains the hydrostatic stability of a star. After the hydrogen is exhaused in the core, a core (atmosphere) contracts (expand), heats up (cool), and the shell hydrogen burning starts, slowly depositing ashes, \textit{e.g.,} helium, into the inert core. The star subsequent evolution depends on its mass primarily. If $M>0.5M_{\odot}$, at some point the helium in the core starts to fuse into $^{12}$C and $^{16}$O and small amounts of $^{24}$Mg, $^{28}$Si. These elements are called \textit{alpha elements}. \cite{Rolfs:1988,Hasen:2004}. The end of core helium burning phase leads to another core contraction phase. A star of a mass $\sim 8M_{\odot}$ would be able to ignite carbon and oxygen producing heavier elements. A less massive star looses it outer layers and remains as slowly cooling degenerate core, a white dwarf.

%%
%%
%%

\subsubsection{nuclear burning is massive stars}

For a star that has $M\geq 8M_{\odot}$, a sequence of burning stages follows, each of which leads to the exhaustion of a respective fuel, contraction of the core and rise of its temperature \cite{Woosley:2002}. Carbon burning leads to the production of $^{20}Ne$, $^{23}$Na and free protons that contribute to the synthesis of non-alpha elements. As temperature increases, the photodisintegration of $^{20}$Ne becomes possible and a small amount of $^{24}$Mg is formed. Next, the oxygen burning occures that produces $^{28}$Si $^{31}$P, and $^{28}$Si and $^{32}$S, that become dominant nuclides in the core by the end of oxygen burning \cite{Rolfs:1988}.

The subsequent silicon burning proceeds at $T\sim3.5\times10^9$K through photodissociation of some of the $^{28}$Si and a sequence of alpha particle captures, "alpha ladder", on the remaining $^{28}$Si to form $^{32}$S, $^{36}$Ar, $^{40}$Ca, $^{44}$Ti, $^{48}$Cr, $^{52}$Fe and $^{56}$Ni. This process lasts around a day. \cite{Rolfs:1988,Hasen:2004}. Due to high temperatures preset at silicon burning, nuclides with $A\in[28, 62]$ fall into quasi-equilibrium, meaning that these nuclides (with exception of $^{12}$C, $^{16}$O $^{20}$Ne and $^{24}$Mg), alpha particles and protons participating in reactions, are in equilibrium with each other. 

As the maximum binding energy per nucleon appears at $A=56$, the silicon burning cannot produce heavier nuclides with the release of energy. As the fraction of $^{56}$Ni in the core of a star increases, the support that nuclear burning has provided against gravitational contraction falls. Meanwhile the mass of the degenerate core still increases as burning proceed in shells. However, when the electron degeneracy pressure can no longer counteract gravity, \textit{i.e.,} when mass of the core exceeds the effective Chandrasekhar mass \footnote{The collapse however occur before the core reaches Chandrasekhar mass, and the pressure support that rests on the avaialbility of free eletrons drops when electrons capture on the nuclides becomes possible. To account for this, the effective Chandrasekhar mass was introduced.}, the core collapses leading to a supernova (CCSN) \cite{Woosley:2002}.

Thus, the origin of more abundant alpha elements in the Universe is stellar fusion.

%%
%%
%%

\subsubsection{Iron Peak}

At temperatures higher then $T\sim 5\times10^{9}$K nuclear statistical equilibrium (NSE) establishes. This is a balance between the fusion reactions froming a ($N,Z$) nuclide from $N$ neutrons and $Z$ protons and photodissociation reactions, splitting it back. At NSE three parameters describe the composition: density, temperature and electron fraction $Y_e = n_p/(n_p + n_e)$, where $n_e$ and $n_p$ are the (total) number density of electrons and protons respectively \cite{Seitenzahl:2009}. 

The composition at NSE favors more tightly bound nuclides, as they are more difficult to photodissociate. Thus, if the conditions allow, \textit{i.e.,} temperature, density and electron fraction of the mater, $Y_e \sim 0.46$ (an electron fraction of iron), nuclides at $A\sim56$, \textit{i.e.,} iron peak elements, dominate \cite{Seitenzahl:2009}. 

For example, NSE establishes during the type Ia supernova, when a thermonuclear explosion of a white dwarf allows for sufficiently high temperatures and densities. After the explosion, newly synthesized elements of the iron peak cools, and being stable, remain in the expanding medium \cite{Iwamoto:2000as}. 

%%
%%
%%

\subsubsection{Nucleosynthesis beyond the iron peak}

Nuclides with $A\geq 56$ cannot be synthesized via standard cycles due to their very Coulomb barriers and processes that does not involve charged particles becomes dominant. These are the neutron capture processes. As nuclides absorb neutrons and grow larger, their binding energy $Q_n$ decreases. This process is haultend when $Q_n\sim1$MeV and penergetic photons starts to knock out neutrons from the nucleus. This process is called photodisintegration and a location in parameter space where it occurs, dependent on temperature and density, is called the neutron drip line \cite{Rolfs:1988}.

Nuclides produces via neutron capture are generally unstable to a $\beta$-decay, with a timescale $\tau_{\beta}$, that can be larger or smaller the a netron capture timescale $\tau_n$. In case when $\tau_{\beta}\ll\tau_n$, \textit{i.e.,} when a $\beta$-decay occures much faster then the next neutron capture, the process is called \textit{slow} or $s$-process. Thus, by definition, the $s$-process moves along the valley of stability\footnote{a region of stable nuclides in a nuclides chart, a chart in terms of number of neutrons $n_n$ and number of protons $n_p$.}, departing no further than by a one nuclide away.
On the other hand, if $\tau_{\beta}\gg\tau_n$, \textit{i.e,} when a neutron capture occures much faster then a $\beta$-decay, the process is called \textit{rapid} or $r$-process. This nucleosynthesis generates nuclides near (but not crossing) the neutron drip line \textcolor{red}{Here a plot, Fig.1.6 from Source would have been usefull.} \cite{Rolfs:1988}. 

Notably, the trajectory of $r$-process is interrupted when the neutrons within nuclide can arrange themselves in a closed shell. Such configuration is energetically very favorable and thus the cross section for a subsequent neutron capture reduces. Only after several $\beta$-decays does the $r$-process continue. Thus, nuclides located at points where neutron drip line and closed neutron shell overlap is more abundant. These unstable nuclides will decay back to the valley of stability and some of the neutrons within them turn to protons, reducing the total mass of the nuclide. The indication of this "overproduction" are the peaks in the abundance patterns at a mass, $A$, slightly lower then the one corresponding to a closed shell nuclide. \textcolor{red}{here a ref to a fig with Abundances is needed.}. 
A similar "overproduction" of nuclides with a closed neutron shell occurs when an $s$-process is considered. However, in that case it is caused by the cross section of these nuclides being 1-2 order of magnitude smaller then of neighboring ones \cite{Rolfs:1988}. Thus, in the case of $s$-process, the peaks in abundance pattern will be at $A$, corresponding to the closed shell  exactly, and thus higher than $A$ of $r$-process. 
Closed shell nuclides is located at $N=50,\: 82, \: 126$ and thus corresponding abundance peaks for $s$-process are at $A=88, \: 138, \: 208$ and at $A=80,\:130,\:194$ for $r$-process (see \textit{e.g.,} \cite{Arnould:2007gh}) \textcolor{red}{abundance peaks with 'r' and 's' elements is needed.}

It was found, that the solar $r$-process abundance pattern of $r$-process is consistent, and can be found anywhere in the Universe. Im particular, in stars that are formed very early on a galactic evolution timescale, the metal poor halo stars, one would expect to observe less $s$- and $r$-process elements as there might have been not enough time for the enrichment to take place. However recent studies showed that the solar $r$-process abundances are present in these stars as well \cite{Sneden:2008,Roederer:2010}, see also Figure 8 in \cite{Sneden:2009} \textcolor{red}{and section 1.9}. Thus, modelling the $r$-process nucleosynthesis it is expected to reproduce the solar abundances. \textcolor{red}{once again, a figure can be good}

It is important to note that in addition to $s$- and $r$-process, a possible $i$-process, (intermidate) is widely discussed. The process operates further from the valley of stability than $s$-process, but not reaching neutron drip line \cite{Cowan:1977,Bertolli:2013gka}. Slow and intermediate neutron capture processes operate within the low-mass asymptotic giant branch (AGB) with mass $M\in[1.5,3]M_{\odot}$ and more massive stars, that enrich the interstellar medium with heavy elements via strong winds (\textit{e.g.,} \cite{Peters:1968,Couch:1974,Kaeppeler:1994K,Woosley:2002,Straniero:2005hc,Herwig:2011}). The possible cites for the $r$-process we discuss in the following subsections.

%%
%%
%%

\subsubsection{Possible $r$-process sites}
\cite{Thielemann:2011}


% Alpher et al. (1948) \cite{Alpher:1948}
% Alpher and Herman, 1950 \cite{Alpher:1950}
% Arnould et al., 2007 \cite{Arnould:2007gh}
% Arnould and Goriely (2003) \cite{Arnould:2003}
% Anders and Grevesse, 1989 \cite{Anders:1989}
% Arcones et al., 2012 \cite{Arcones:2012}
% Akiyama et al., 2003 \cite{Akiyama:2003}

% Burbidge et al. (1957) \cite{Burbidge:1957}
% Bertolli et al., 2013 \ctie{Bertolli:2013gka}
% Burrows et al., 2007 \cite{Burrows:2007yx}

% Coc et al. (2013). \cite{Coc:2013eha}
% Cameron, 1973 \cite{Cameron:1973}
% Cowan and Rose, 1977 \cite{Cowan:1977}
% Couch et al.,1974 \cite{Couch:1974}

% Fischer et al., 2010 \cite{Fischer:2010}
% FrÃ¶hlich et al., 2006 \cite{Frohlich:2006}

% Grevesse and Sauval, 1998 \cite{Grevesse:1998}

% Hansen et al., 2004 \cite{Hasen:2004}
% Herwig et al., 2011 \cite{Herwig:2011}

% Iwamoto et al., 1999 \cite{Iwamoto:2000as}

% Kaeppeler et al., 1994 \cite{Kaeppeler:1994K}

% Lodders, 2003 \cite{Lodders:2003}

% MÃ¶ller et al., 1995 \cite{Moller:1993ed}
% Mathews and Cowan, 1990\cite{Mathews:1990}
% MartÃ­nez-Pinedo et al., 2012 \cite{MartinezPinedo:2012rb}
% MÃ¶sta et al., 2014 \cite{Mosta:2014jaa}
% MÃ¶sta et al., 2015 \cite{Mosta:2015}

% Nishimura et al. (2015) \cite{Nishimura:2015nca}

% Peters, 1968 \ctie{Peters:1968}
% Pruet et al., 2006 \cite{Pruet:2005qd}

% Qian and Woosley, 1996 \cite{Qian:1996xt}

% Rolfs and Rodney, 1988 \cite{Rolfs:1988}
% Roederer et al.,2010 \cite{Roederer:2010}
% Roberts et al., 2010 \cite{Roberts:2010}

% Shaviv, 2012 \cite{Shaviv:2012}
% Suess and Urey (1956) \cite{Suess:1956}
% Seitenzahl et al., 2009 \cite{Seitenzahl:2009}
% Sneden et al., 2008 \cite{Sneden:2008}
% Sneden et al. (2009) \cite{Sneden:2009}
% Straniero et al., 2006 \ctie{Straniero:2005hc}

% Tytler et al., 2000 \cite{Tytler:2000qf}
% Thielemann et al., 2011 \cite{Thielemann:2011}
% Thompson et al., 2001 \cite{Thompson:2001ys}

% Woosley et al., 2002 \cite{Woosley:2002}
% Wanajo, 2006 \cite{Wanajo:2006mq}
% Wanajo et al., 2011 \cite{Wanajo:2010mc}
% Wanajo, 2013 \cite{Wanajo:2013} 
% Wheeler et al., 2000 \cite{Wheeler:2000}
% Winteler et al., 2012\cite{Winteler:2012}

%% --------------- 
%%
%% References
%%
%% ---------------

\newpage

\bibliography{references}

\end{document}